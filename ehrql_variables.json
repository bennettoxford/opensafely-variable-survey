{
  "ADHD-Pre-and-Post-Covid": {
    "analysis/Patient_table_3_rolling_6month_incident.py": [
      [
        "age",
        "patients.age_on(dataset.last_mph_med_date)",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L53",
        "IntPatientSeries",
        53
      ],
      [
        "age_band",
        "case(when((dataset.age >= 0) & (dataset.age <= 9)).then('0 to 9'), when((dataset.age >= 10) & (dataset.age <= 17)).then('10 to 17'), when((dataset.age >= 18) & (dataset.age <= 24)).then('18 to 24'), when((dataset.age >= 25) & (dataset.age <= 34)).then('25 to 34'), when(dataset.age >= 35).then('35 and over'), when(dataset.age.is_null()).then('Missing'))",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L55",
        "StrPatientSeries",
        55
      ],
      [
        "date_of_birth",
        "patients.date_of_birth",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L33",
        "DatePatientSeries",
        33
      ],
      [
        "first_adhd_diagnosis_date",
        "first_matching_event(clinical_events, adhd_codelist).date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L36",
        "DatePatientSeries",
        36
      ],
      [
        "has_registration",
        "has_registration",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L29",
        "BoolPatientSeries",
        29
      ],
      [
        "last_mph_med_date",
        "medications.where(True).where(medications.dmd_code.is_in(adhd_medication_codelist)).where(medications.date.is_on_or_after(dataset.first_adhd_diagnosis_date)).sort_by(medications.date).last_for_patient().date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L40",
        "DatePatientSeries",
        40
      ],
      [
        "month_of_medication",
        "dataset.last_mph_med_date.month",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L50",
        "IntPatientSeries",
        50
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L31",
        "StrPatientSeries",
        31
      ],
      [
        "year_of_medication",
        "dataset.last_mph_med_date.year",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_3_rolling_6month_incident.py#L49",
        "IntPatientSeries",
        49
      ]
    ],
    "analysis/Patient_table_5_dia_to_med.py": [
      [
        "age",
        "patients.age_on(dataset.first_mph_med_date)",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L52",
        "IntPatientSeries",
        52
      ],
      [
        "age_band",
        "case(when((dataset.age >= 0) & (dataset.age <= 9)).then('0 to 9'), when((dataset.age >= 10) & (dataset.age <= 17)).then('10 to 17'), when((dataset.age >= 18) & (dataset.age <= 24)).then('18 to 24'), when((dataset.age >= 25) & (dataset.age <= 34)).then('25 to 34'), when(dataset.age >= 35).then('35 and over'), when(dataset.age.is_null()).then('Missing'))",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L54",
        "StrPatientSeries",
        54
      ],
      [
        "date_of_birth",
        "patients.date_of_birth",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L28",
        "DatePatientSeries",
        28
      ],
      [
        "first_adhd_diagnosis_date",
        "first_matching_event(clinical_events, adhd_codelist).date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L31",
        "DatePatientSeries",
        31
      ],
      [
        "first_mph_med_date",
        "medications.where(True).where(medications.dmd_code.is_in(adhd_medication_codelist)).where(medications.date.is_on_or_after(dataset.first_adhd_diagnosis_date)).sort_by(medications.date).first_for_patient().date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L35",
        "DatePatientSeries",
        35
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L27",
        "StrPatientSeries",
        27
      ],
      [
        "times_between_dia_med_weeks",
        "(dataset.first_mph_med_date - dataset.first_adhd_diagnosis_date).weeks",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L45",
        "IntPatientSeries",
        45
      ],
      [
        "year_of_medication",
        "dataset.first_mph_med_date.year",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/Patient_table_5_dia_to_med.py#L49",
        "IntPatientSeries",
        49
      ]
    ],
    "analysis/dataset_definition_dx_to_med_time.py": [
      [
        "age",
        "patients.age_on(end_date)",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L28",
        "IntPatientSeries",
        28
      ],
      [
        "count_adhd_diagnoses",
        "clinical_events.where(clinical_events.snomedct_code.is_in(adhd_codelist)).count_for_patient()",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L41",
        "IntPatientSeries",
        41
      ],
      [
        "count_adhd_resolved",
        "clinical_events.where(clinical_events.snomedct_code.is_in(adhd_codelist)).count_for_patient()",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L45",
        "IntPatientSeries",
        45
      ],
      [
        "first_adhd_diagnosis_date",
        "first_matching_event(clinical_events, adhd_codelist).date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L36",
        "DatePatientSeries",
        36
      ],
      [
        "first_mph_med_date",
        "medications.where(True).where(medications.dmd_code.is_in(adhd_medication_codelist)).where(medications.date.is_on_or_after(dataset.first_adhd_diagnosis_date)).sort_by(medications.date).first_for_patient().date",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L49",
        "DatePatientSeries",
        49
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L27",
        "StrPatientSeries",
        27
      ],
      [
        "times_between_dia_med_weeks",
        "(dataset.first_mph_med_date - dataset.first_adhd_diagnosis_date).weeks",
        "https://github.com/opensafely/ADHD-Pre-and-Post-Covid/blob/84727811e464fe2e24b39db1bdc4aeb5549a9996/analysis/dataset_definition_dx_to_med_time.py#L59",
        "IntPatientSeries",
        59
      ]
    ]
  },
  "IMID-Zoster": {
    "analysis/dataset_definition_2.py": [
      [
        "age_2017_group",
        "case(when(age_at_start < 40).then('18-39'), when(age_at_start < 50).then('40-49'), when(age_at_start < 60).then('50-59'), when(age_at_start < 70).then('60-69'), when(age_at_start < 80).then('70-79'), when(age_at_start >= 80).then('80+'), otherwise='missing')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L130",
        "StrPatientSeries",
        130
      ],
      [
        "age_at_analysis",
        "age_at_analysis",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L109",
        "IntPatientSeries",
        109
      ],
      [
        "age_at_diagnosis",
        "patients.age_on(first_imid_diagnosis_date)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L119",
        "IntPatientSeries",
        119
      ],
      [
        "age_at_index",
        "age_at_index",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L115",
        "IntPatientSeries",
        115
      ],
      [
        "age_at_start",
        "age_at_start",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L112",
        "IntPatientSeries",
        112
      ],
      [
        "age_date",
        "patients.date_of_birth",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "age_dia_group",
        "case(when(age_at_diagnosis < 40).then('18-39'), when(age_at_diagnosis < 50).then('40-49'), when(age_at_diagnosis < 60).then('50-59'), when(age_at_diagnosis < 70).then('60-69'), when(age_at_diagnosis < 80).then('70-79'), when(age_at_diagnosis >= 80).then('80+'), otherwise='missing')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L139",
        "StrPatientSeries",
        139
      ],
      [
        "age_index_group",
        "case(when(age_at_index < 40).then('18-39'), when(age_at_index < 50).then('40-49'), when(age_at_index < 60).then('50-59'), when(age_at_index < 70).then('60-69'), when(age_at_index < 80).then('70-79'), when(age_at_index >= 80).then('80+'), otherwise='missing')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L121",
        "StrPatientSeries",
        121
      ],
      [
        "cohort_end_date",
        "cohort_end_date",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L97",
        "DatePatientSeries",
        97
      ],
      [
        "cohort_start_date",
        "cohort_start_date",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L96",
        "DatePatientSeries",
        96
      ],
      [
        "death_date",
        "death_date",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L91",
        "DatePatientSeries",
        91
      ],
      [
        "drinking",
        "has_diagnosis(codelist.drinking_codelist)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L264",
        "BoolPatientSeries",
        264
      ],
      [
        "ethnicity16",
        "case(when(ethnicity16 == '1').then('White - British'), when(ethnicity16 == '2').then('White - Irish'), when(ethnicity16 == '3').then('White - Other'), when(ethnicity16 == '4').then('Mixed - White/Black Caribbean'), when(ethnicity16 == '5').then('Mixed - White/Black African'), when(ethnicity16 == '6').then('Mixed - White/Asian'), when(ethnicity16 == '7').then('Mixed - Other'), when(ethnicity16 == '8').then('Asian or Asian British - Indian'), when(ethnicity16 == '9').then('Asian or Asian British - Pakistani'), when(ethnicity16 == '10').then('Asian or Asian British - Bangladeshi'), when(ethnicity16 == '11').then('Asian or Asian British - Other'), when(ethnicity16 == '12').then('Black - Caribbean'), when(ethnicity16 == '13').then('Black - African'), when(ethnicity16 == '14').then('Black - Other'), when(ethnicity16 == '15').then('Other - Chinese'), when(ethnicity16 == '16').then('Other - Other'), otherwise='Unknown')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L195",
        "StrPatientSeries",
        195
      ],
      [
        "ethnicity6",
        "case(when(ethnicity6 == '1').then('White'), when(ethnicity6 == '2').then('Mixed'), when(ethnicity6 == '3').then('South Asian'), when(ethnicity6 == '4').then('Black'), when(ethnicity6 == '5').then('Other'), when(ethnicity6 == '6').then('Not stated'), otherwise='Unknown')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L224",
        "StrPatientSeries",
        224
      ],
      [
        "first_AD_diagnosis",
        "has_diagnosis(codelist.codelist_ad_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L62",
        "BoolPatientSeries",
        62
      ],
      [
        "first_AD_diagnosis_date",
        "first_event_date(codelist.codelist_ad_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L63",
        "DatePatientSeries",
        63
      ],
      [
        "first_As_diagnosis",
        "has_diagnosis(codelist.axial_code_snomed)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L46",
        "BoolPatientSeries",
        46
      ],
      [
        "first_As_diagnosis_date",
        "first_event_date(codelist.axial_code_snomed)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L47",
        "DatePatientSeries",
        47
      ],
      [
        "first_HS_diagnosis",
        "has_diagnosis(codelist.codelist_hs_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L54",
        "BoolPatientSeries",
        54
      ],
      [
        "first_HS_diagnosis_date",
        "first_event_date(codelist.codelist_hs_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L55",
        "DatePatientSeries",
        55
      ],
      [
        "first_IBD_diagnosis",
        "has_diagnosis(codelist.codelist_ibd_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L50",
        "BoolPatientSeries",
        50
      ],
      [
        "first_IBD_diagnosis_date",
        "first_event_date(codelist.codelist_ibd_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L51",
        "DatePatientSeries",
        51
      ],
      [
        "first_IMID_diagnosis_date",
        "first_event_date(codelist.codelist_imid_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L33",
        "DatePatientSeries",
        33
      ],
      [
        "first_PS_diagnosis",
        "has_diagnosis(codelist.codelist_ps_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L58",
        "BoolPatientSeries",
        58
      ],
      [
        "first_PS_diagnosis_date",
        "first_event_date(codelist.codelist_ps_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "first_PsA_diagnosis",
        "has_diagnosis(codelist.psoa_code_snomed)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L42",
        "BoolPatientSeries",
        42
      ],
      [
        "first_PsA_diagnosis_date",
        "first_event_date(codelist.psoa_code_snomed)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L43",
        "DatePatientSeries",
        43
      ],
      [
        "first_RA_diagnosis",
        "has_diagnosis(codelist.codelist_ra_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L38",
        "BoolPatientSeries",
        38
      ],
      [
        "first_RA_diagnosis_date",
        "first_event_date(codelist.codelist_ra_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L39",
        "DatePatientSeries",
        39
      ],
      [
        "first_zoster_after_diagnosis_date",
        "first_zoster_after_diagnosis_date",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L85",
        "DatePatientSeries",
        85
      ],
      [
        "has_IMIDs_diagnosis",
        "has_diagnosis(codelist.codelist_imid_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L32",
        "BoolPatientSeries",
        32
      ],
      [
        "has_cancer_history",
        "has_pripor_history(codelist.codelist_cancer_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L274",
        "BoolPatientSeries",
        274
      ],
      [
        "has_ckd_history",
        "has_pripor_history(codelist.codelist_ckd_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L283",
        "BoolPatientSeries",
        283
      ],
      [
        "has_cvd_history",
        "has_pripor_history(codelist.codelist_cvd_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L271",
        "BoolPatientSeries",
        271
      ],
      [
        "has_diabetes_history",
        "has_pripor_history(codelist.codelist_diabetes_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L277",
        "BoolPatientSeries",
        277
      ],
      [
        "has_hypertension_history",
        "has_pripor_history(codelist.hypertension_codes)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L289",
        "BoolPatientSeries",
        289
      ],
      [
        "has_liverdisease_history",
        "has_pripor_history(codelist.codelist_liver_disease_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L286",
        "BoolPatientSeries",
        286
      ],
      [
        "has_lungdisease_history",
        "has_pripor_history(codelist.codelist_lungdisease_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L280",
        "BoolPatientSeries",
        280
      ],
      [
        "has_vacc_event_before_IMID",
        "has_pripor_history(codelist.codelist_vaccine)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L298",
        "BoolPatientSeries",
        298
      ],
      [
        "has_vacc_event_before_end",
        "has_diagnosis(codelist.codelist_vaccine)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L295",
        "BoolPatientSeries",
        295
      ],
      [
        "has_vacc_event_date",
        "first_event_date(codelist.codelist_vaccine)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L296",
        "DatePatientSeries",
        296
      ],
      [
        "has_vacc_invitation",
        "has_diagnosis(codelist.codelist_shingle_vaccination_invitation_code)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L315",
        "BoolPatientSeries",
        315
      ],
      [
        "has_vacc_invitation_date",
        "first_event_date(codelist.codelist_shingle_vaccination_invitation_code)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L316",
        "DatePatientSeries",
        316
      ],
      [
        "has_vacc_med_before_IMID",
        "has_pripor_medication(codelist.codelist_vaccine_med)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L305",
        "BoolPatientSeries",
        305
      ],
      [
        "has_vacc_med_before_end",
        "has_medication(codelist.codelist_vaccine_med)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L302",
        "BoolPatientSeries",
        302
      ],
      [
        "has_vacc_med_date",
        "has_medication_date(codelist.codelist_vaccine_med)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L303",
        "DatePatientSeries",
        303
      ],
      [
        "has_zoster_after_diagnosis",
        "has_zoster_after_diagnosis",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L84",
        "BoolPatientSeries",
        84
      ],
      [
        "has_zoster_history",
        "has_pripor_history(codelist.codelist_zoster_md)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L268",
        "BoolPatientSeries",
        268
      ],
      [
        "has_zoster_primary_admission_date",
        "apcs.where(apcs.primary_diagnosis.is_in(codelist.codelist_zoster_icd10)).where(apcs.admission_date.is_on_or_between(first_imid_diagnosis_date, study_end_date)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L69",
        "DatePatientSeries",
        69
      ],
      [
        "imd10",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 10))).then('1 (most deprived)'), when(imd < int(32844 * 2 / 10)).then('2'), when(imd < int(32844 * 3 / 10)).then('3'), when(imd < int(32844 * 4 / 10)).then('4'), when(imd < int(32844 * 5 / 10)).then('5'), when(imd < int(32844 * 6 / 10)).then('6'), when(imd < int(32844 * 7 / 10)).then('7'), when(imd < int(32844 * 8 / 10)).then('8'), when(imd < int(32844 * 9 / 10)).then('9'), when(imd >= int(32844 * 9 / 10)).then('10 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L173",
        "StrPatientSeries",
        173
      ],
      [
        "imd5",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 5))).then('1'), when(imd < int(32844 * 2 / 5)).then('2'), when(imd < int(32844 * 3 / 5)).then('3'), when(imd < int(32844 * 4 / 5)).then('4'), when(imd < int(32844 * 5 / 5)).then('5'), otherwise='Missing')",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L165",
        "StrPatientSeries",
        165
      ],
      [
        "practice_baseline",
        "practice_registrations.for_patient_on(baseline_date).practice_pseudo_id",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L152",
        "IntPatientSeries",
        152
      ],
      [
        "practice_diagnosis",
        "practice_registrations.for_patient_on(first_imid_diagnosis_date).practice_pseudo_id",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L151",
        "IntPatientSeries",
        151
      ],
      [
        "practice_index",
        "practice_registrations.for_patient_on(cohort_start_date).practice_pseudo_id",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L153",
        "IntPatientSeries",
        153
      ],
      [
        "practice_stp_baseline",
        "practice_registrations.for_patient_on(baseline_date).practice_stp",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L160",
        "StrPatientSeries",
        160
      ],
      [
        "practice_stp_diagnosis",
        "practice_registrations.for_patient_on(first_imid_diagnosis_date).practice_stp",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L159",
        "StrPatientSeries",
        159
      ],
      [
        "practice_stp_index",
        "practice_registrations.for_patient_on(cohort_start_date).practice_stp",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L161",
        "StrPatientSeries",
        161
      ],
      [
        "region_baseline",
        "practice_registrations.for_patient_on(baseline_date).practice_nuts1_region_name",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L156",
        "StrPatientSeries",
        156
      ],
      [
        "region_diagnosis",
        "practice_registrations.for_patient_on(first_imid_diagnosis_date).practice_nuts1_region_name",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L155",
        "StrPatientSeries",
        155
      ],
      [
        "region_index",
        "practice_registrations.for_patient_on(cohort_start_date).practice_nuts1_region_name",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L157",
        "StrPatientSeries",
        157
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L100",
        "StrPatientSeries",
        100
      ],
      [
        "smoking_status",
        "case(when(most_recent_smoking_code == 'S').then('Current'), when((most_recent_smoking_code == 'E') | (most_recent_smoking_code == 'N') & (ever_smoked == True)).then('Former'), when((most_recent_smoking_code == 'N') & (ever_smoked == False)).then('Never'), otherwise=None)",
        "https://github.com/opensafely/IMID-Zoster/blob/9e8f646b1f33e1dd30ccd2618c0ab1f997db2ab9/analysis/dataset_definition_2.py#L253",
        "StrPatientSeries",
        253
      ]
    ]
  },
  "JAKi-hosp": {
    "analysis/dataset_definition.py": [
      [
        "cov_bin_carehome_status",
        "case(when(tmp_care_home_code).then(True), when(tmp_care_home_tpp1).then(True), when(tmp_care_home_tpp2).then(True), when(tmp_care_home_tpp3).then(True), otherwise=False)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L145",
        "BoolPatientSeries",
        145
      ],
      [
        "cov_cat_deprivation_5",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L114",
        "StrPatientSeries",
        114
      ],
      [
        "cov_cat_region",
        "registered.practice_nuts1_region_name",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L123",
        "StrPatientSeries",
        123
      ],
      [
        "cov_cat_rural_urban",
        "addresses.for_patient_on(index_date).rural_urban_classification",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L125",
        "IntPatientSeries",
        125
      ],
      [
        "cov_cat_sex",
        "patients.sex",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L103",
        "StrPatientSeries",
        103
      ],
      [
        "cov_cat_smoking_status",
        "case(when(tmp_most_recent_smoking_cat == 'S').then('S'), when(tmp_most_recent_smoking_cat == 'E').then('E'), when((tmp_most_recent_smoking_cat == 'N') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'N').then('N'), when((tmp_most_recent_smoking_cat == 'M') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'M').then('M'), otherwise='M')",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L129",
        "StrPatientSeries",
        129
      ],
      [
        "cov_cat_stp",
        "registered.practice_stp",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L124",
        "StrPatientSeries",
        124
      ],
      [
        "cov_num_age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L105",
        "IntPatientSeries",
        105
      ],
      [
        "cov_solid_cancer_ever",
        "last_matching_event_clinical_snomed_before(non_haematological_cancer_opensafely_snomed_codes_new + lung_cancer_opensafely_snomed_codes + chemotherapy_radiotherapy_opensafely_snomed_codes, index_date).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L157",
        "BoolPatientSeries",
        157
      ],
      [
        "cov_solid_cancer_new",
        "last_matching_event_clinical_snomed_between(non_haematological_cancer_opensafely_snomed_codes_new + lung_cancer_opensafely_snomed_codes + chemotherapy_radiotherapy_opensafely_snomed_codes, index_date - days(180), index_date).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L156",
        "BoolPatientSeries",
        156
      ],
      [
        "cov_status_bari_hosp_first",
        "first_matching_event_bari_between('hospitalised_with', studystart_date, studyend_date).current_status",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L152",
        "StrPatientSeries",
        152
      ],
      [
        "ethnicity_cat",
        "clinical_events.where(clinical_events.ctv3_code.is_in(ethnicity_codes)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(ethnicity_codes)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L107",
        "StrPatientSeries",
        107
      ],
      [
        "exp_date_bari_hosp_first",
        "first_matching_event_bari_between('hospitalised_with', studystart_date, studyend_date).treatment_start_date",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L54",
        "DatePatientSeries",
        54
      ],
      [
        "exp_date_bari_hosp_onset_first",
        "first_matching_event_bari_between('hospital_onset', studystart_date, studyend_date).treatment_start_date",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L57",
        "DatePatientSeries",
        57
      ],
      [
        "exp_date_bari_hosp_second",
        "first_matching_event_bari_between('hospitalised_with', index_date, studyend_date).treatment_start_date",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L62",
        "DatePatientSeries",
        62
      ],
      [
        "exp_date_bari_hosp_third",
        "first_matching_event_bari_between('hospitalised_with', second_date, studyend_date).treatment_start_date",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L64",
        "DatePatientSeries",
        64
      ],
      [
        "qa_bin_cocp",
        "medications.where(medications.dmd_code.is_in(cocp_dmd)).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L81",
        "BoolPatientSeries",
        81
      ],
      [
        "qa_bin_hrt",
        "medications.where(medications.dmd_code.is_in(hrt_dmd)).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L83",
        "BoolPatientSeries",
        83
      ],
      [
        "qa_bin_is_female_or_male",
        "patients.sex.is_in(['female', 'male'])",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L70",
        "BoolPatientSeries",
        70
      ],
      [
        "qa_bin_known_imd",
        "addresses.for_patient_on(index_date).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L73",
        "BoolPatientSeries",
        73
      ],
      [
        "qa_bin_pregnancy",
        "clinical_events.where(clinical_events.snomedct_code.is_in(pregnancy_snomed_clinical)).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L79",
        "BoolPatientSeries",
        79
      ],
      [
        "qa_bin_prostate_cancer",
        "case(when(prostate_cancer_snomed).then(True), when(prostate_cancer_hes).then(True), when(prostate_cancer_death).then(True), otherwise=False)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L92",
        "BoolPatientSeries",
        92
      ],
      [
        "qa_bin_was_adult",
        "(patients.age_on(index_date) >= 18) & (patients.age_on(index_date) <= 110)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L71",
        "BoolPatientSeries",
        71
      ],
      [
        "qa_bin_was_alive",
        "patients.is_alive_on(index_date)",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L72",
        "BoolPatientSeries",
        72
      ],
      [
        "qa_bin_was_registered",
        "practice_registrations.spanning(index_date - days(366), index_date).exists_for_patient()",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L74",
        "BoolPatientSeries",
        74
      ],
      [
        "qa_date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L76",
        "DatePatientSeries",
        76
      ],
      [
        "qa_num_birth_year",
        "patients.date_of_birth",
        "https://github.com/opensafely/JAKi-hosp/blob/c99cabb85bf38b102902339f44d0534f1c40535d/analysis/dataset_definition.py#L75",
        "DatePatientSeries",
        75
      ]
    ]
  },
  "OpenPregnosis": {
    "analysis/01_diagnostic_event_counts.py": [
      [
        "age_at_first_pregnancy",
        "patients.age_on(clinical_events.where(clinical_events.snomedct_code.is_in(pregnancy_outcome_codes) & (clinical_events.date >= study_start) & (clinical_events.date <= study_end)).sort_by(clinical_events.date).first_for_patient().date)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/01_diagnostic_event_counts.py#L131",
        "IntPatientSeries",
        131
      ],
      [
        "age_eligible_25_35",
        "(dataset.age_at_first_pregnancy >= 25) & (dataset.age_at_first_pregnancy < 36)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/01_diagnostic_event_counts.py#L142",
        "BoolPatientSeries",
        142
      ],
      [
        "has_any_pregnancy_episodes",
        "dataset.total_pregnancy_episodes > 0",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/01_diagnostic_event_counts.py#L127",
        "BoolPatientSeries",
        127
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/01_diagnostic_event_counts.py#L26",
        "StrPatientSeries",
        26
      ],
      [
        "total_pregnancy_episodes",
        "sum([getattr(dataset, f'{event_type}_episode_count') for event_type in pregnancy_event_codelists.keys()])",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/01_diagnostic_event_counts.py#L122",
        "IntPatientSeries",
        122
      ]
    ],
    "analysis/03a_livebirth_dataset_definition.py": [
      [
        "age_at_first_livebirth",
        "patients.age_on(clinical_events.where(clinical_events.snomedct_code.is_in(livebirth_outcome_codes) & (clinical_events.date >= study_start) & (clinical_events.date <= study_end)).sort_by(clinical_events.date).first_for_patient().date)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03a_livebirth_dataset_definition.py#L156",
        "IntPatientSeries",
        156
      ],
      [
        "age_eligible_25_35",
        "(dataset.age_at_first_livebirth >= 25) & (dataset.age_at_first_livebirth < 36)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03a_livebirth_dataset_definition.py#L165",
        "BoolPatientSeries",
        165
      ],
      [
        "has_any_livebirth_events",
        "dataset.total_livebirth_events > 0",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03a_livebirth_dataset_definition.py#L152",
        "BoolPatientSeries",
        152
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03a_livebirth_dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ],
      [
        "total_livebirth_events",
        "sum(livebirth_event_counts)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03a_livebirth_dataset_definition.py#L151",
        "IntPatientSeries",
        151
      ]
    ],
    "analysis/03b_stillbirth_dataset_definition.py": [
      [
        "age_at_first_stillbirth",
        "patients.age_on(clinical_events.where(clinical_events.snomedct_code.is_in(stillbirth_outcome_codes) & (clinical_events.date >= study_start) & (clinical_events.date <= study_end)).sort_by(clinical_events.date).first_for_patient().date)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03b_stillbirth_dataset_definition.py#L147",
        "IntPatientSeries",
        147
      ],
      [
        "age_eligible_25_35",
        "(dataset.age_at_first_stillbirth >= 25) & (dataset.age_at_first_stillbirth < 36)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03b_stillbirth_dataset_definition.py#L156",
        "BoolPatientSeries",
        156
      ],
      [
        "has_any_stillbirth_events",
        "dataset.total_stillbirth_events > 0",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03b_stillbirth_dataset_definition.py#L143",
        "BoolPatientSeries",
        143
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03b_stillbirth_dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ],
      [
        "total_stillbirth_events",
        "sum(stillbirth_event_counts)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03b_stillbirth_dataset_definition.py#L142",
        "IntPatientSeries",
        142
      ]
    ],
    "analysis/03c_early_loss_dataset_definition.py": [
      [
        "age_at_first_early_loss",
        "patients.age_on(clinical_events.where(clinical_events.snomedct_code.is_in(early_loss_outcome_codes) & (clinical_events.date >= study_start) & (clinical_events.date <= study_end)).sort_by(clinical_events.date).first_for_patient().date)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03c_early_loss_dataset_definition.py#L156",
        "IntPatientSeries",
        156
      ],
      [
        "age_eligible_25_35",
        "(dataset.age_at_first_early_loss >= 25) & (dataset.age_at_first_early_loss < 36)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03c_early_loss_dataset_definition.py#L165",
        "BoolPatientSeries",
        165
      ],
      [
        "has_any_early_loss_events",
        "dataset.total_early_loss_events > 0",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03c_early_loss_dataset_definition.py#L152",
        "BoolPatientSeries",
        152
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03c_early_loss_dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ],
      [
        "total_early_loss_events",
        "sum(early_loss_event_counts)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03c_early_loss_dataset_definition.py#L151",
        "IntPatientSeries",
        151
      ]
    ],
    "analysis/03d_pregnancy_start_dataset_definition.py": [
      [
        "age_at_first_early_marker",
        "patients.age_on(clinical_events.where(clinical_events.snomedct_code.is_in(early_marker_codes) & (clinical_events.date >= study_start) & (clinical_events.date <= study_end)).sort_by(clinical_events.date).first_for_patient().date)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03d_pregnancy_start_dataset_definition.py#L153",
        "IntPatientSeries",
        153
      ],
      [
        "age_eligible_25_35",
        "(dataset.age_at_first_early_marker >= 25) & (dataset.age_at_first_early_marker < 36)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03d_pregnancy_start_dataset_definition.py#L162",
        "BoolPatientSeries",
        162
      ],
      [
        "has_any_early_marker_events",
        "dataset.total_early_marker_events > 0",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03d_pregnancy_start_dataset_definition.py#L149",
        "BoolPatientSeries",
        149
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03d_pregnancy_start_dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ],
      [
        "total_early_marker_events",
        "sum(early_marker_event_counts)",
        "https://github.com/opensafely/OpenPregnosis/blob/33c4fcd81c7d1f57cce269e3071d7c1f279bdd0b/analysis/03d_pregnancy_start_dataset_definition.py#L148",
        "IntPatientSeries",
        148
      ]
    ]
  },
  "covid-vaccine-history": {
    "analysis/1-extract/dataset_definition_fixed.py": [
      [
        "covid_death_date",
        "case(when(ons_deaths.cause_of_death_is_in(codelists.covid_icd10)).then(ons_deaths.date), otherwise=None)",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L96",
        "DatePatientSeries",
        96
      ],
      [
        "covid_vax_count",
        "covid_vaccinations.count_for_patient()",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L101",
        "IntPatientSeries",
        101
      ],
      [
        "death_date",
        "ons_deaths.date",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L95",
        "DatePatientSeries",
        95
      ],
      [
        "ethnicity16",
        "ethnicity.snomedct_code.to_category(codelists.ethnicity16)",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L92",
        "StrPatientSeries",
        92
      ],
      [
        "ethnicity5",
        "ethnicity.snomedct_code.to_category(codelists.ethnicity5)",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L89",
        "StrPatientSeries",
        89
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_fixed.py#L73",
        "StrPatientSeries",
        73
      ]
    ],
    "analysis/1-extract/dataset_definition_snapshot.py": [
      [
        "covid_admitted_date",
        "apcs.where(apcs.all_diagnoses.contains_any_of(codelists.covid_icd10)).where(apcs.admission_method.is_in(['21', '22', '23', '24', '25', '2A', '2B', '2C', '2D', '28'])).where(apcs.patient_classification == '1').where(apcs.admission_date.is_on_or_after(snapshot_date)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_snapshot.py#L134",
        "DatePatientSeries",
        134
      ],
      [
        "covid_critcare_date",
        "apcs.where(apcs.all_diagnoses.contains_any_of(codelists.covid_icd10)).where(apcs.admission_method.is_in(['21', '22', '23', '24', '25', '2A', '2B', '2C', '2D', '28'])).where(apcs.patient_classification == '1').where(apcs.days_in_critical_care > 0).where(apcs.admission_date.is_on_or_after(snapshot_date)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_snapshot.py#L145",
        "DatePatientSeries",
        145
      ],
      [
        "covid_vax_prior_count",
        "covid_vaccinations.where(vaccinations.date.is_before(snapshot_date)).count_for_patient()",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_snapshot.py#L122",
        "IntPatientSeries",
        122
      ],
      [
        "deregistered_date",
        "registered_patients.end_date",
        "https://github.com/opensafely/covid-vaccine-history/blob/995e17b4f369db86a1afc6d5e80abad74f608e26/analysis/1-extract/dataset_definition_snapshot.py#L129",
        "DatePatientSeries",
        129
      ]
    ]
  },
  "covid_collateral_hf2": {
    "dataset_definition.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L46",
        "IntPatientSeries",
        46
      ],
      [
        "date_first_admitted",
        "apcs.where(apcs.admission_date.is_after(index_date)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "ethnicity",
        "clinical_events.where(clinical_events.ctv3_code.is_in(ethnicity_codelist)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(ethnicity_codelist)",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L50",
        "StrPatientSeries",
        50
      ],
      [
        "imd_quintile",
        "case(when(imd_rounded < int(max_imd * 1 / 5)).then(1), when(imd_rounded < int(max_imd * 2 / 5)).then(2), when(imd_rounded < int(max_imd * 3 / 5)).then(3), when(imd_rounded < int(max_imd * 4 / 5)).then(4), when(imd_rounded <= max_imd).then(5))",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L60",
        "IntPatientSeries",
        60
      ],
      [
        "num_asthma_inhaler_medications",
        "medications.where(medications.dmd_code.is_in(asthma_inhaler_codelist)).where(medications.date.is_on_or_between(index_date - days(30), index_date)).count_for_patient()",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L70",
        "IntPatientSeries",
        70
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/covid_collateral_hf2/blob/2204addc94dc30ed62dbdc12c432dc2e3192e217/dataset_definition.py#L48",
        "StrPatientSeries",
        48
      ]
    ]
  },
  "curation-variables-library": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/curation-variables-library/blob/fddc6fb3479afa9ebcabf5badb6105d9ba4313bf/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "dataset-definition-testing-examples": {
    "example-001-cake-and-parachutes/dataset_definition.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-001-cake-and-parachutes/dataset_definition.py#L28",
        "IntPatientSeries",
        28
      ],
      [
        "cake",
        "has_history_of_cake",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-001-cake-and-parachutes/dataset_definition.py#L29",
        "BoolPatientSeries",
        29
      ],
      [
        "parachuting",
        "has_history_of_parachuting",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-001-cake-and-parachutes/dataset_definition.py#L30",
        "BoolPatientSeries",
        30
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-001-cake-and-parachutes/dataset_definition.py#L27",
        "StrPatientSeries",
        27
      ]
    ],
    "example-002-ehrql-tutorial/dataset_definition.py": [
      [
        "ace_or_arb",
        "has_arb_treatment | has_ace_treatment",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-002-ehrql-tutorial/dataset_definition.py#L73",
        "BoolPatientSeries",
        73
      ],
      [
        "prt_or_mal",
        "has_proteinuria_diagnosis | has_microalbuminuria_diagnosis",
        "https://github.com/opensafely/dataset-definition-testing-examples/blob/88cdea8ae88c08f9ce9b4f112a8603277440f635/example-002-ehrql-tutorial/dataset_definition.py#L72",
        "BoolPatientSeries",
        72
      ]
    ]
  },
  "death-report": {
    "analysis/dataset_definition.py": [
      [
        "IMD_q10",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 10))).then('1 (most deprived)'), when(imd < int(32844 * 2 / 10)).then('2'), when(imd < int(32844 * 3 / 10)).then('3'), when(imd < int(32844 * 4 / 10)).then('4'), when(imd < int(32844 * 5 / 10)).then('5'), when(imd < int(32844 * 6 / 10)).then('6'), when(imd < int(32844 * 7 / 10)).then('7'), when(imd < int(32844 * 8 / 10)).then('8'), when(imd < int(32844 * 9 / 10)).then('9'), when(imd >= int(32844 * 9 / 10)).then('10 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L130",
        "StrPatientSeries",
        130
      ],
      [
        "TPP_death_date",
        "patients.date_of_death",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L96",
        "DatePatientSeries",
        96
      ],
      [
        "age_band",
        "case(when(age < 45).then('0-44'), when((age >= 45) & (age < 65)).then('45-64'), when((age >= 65) & (age < 75)).then('65-74'), when((age >= 75) & (age < 85)).then('75-84'), when(age >= 85).then('85+'))",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L106",
        "StrPatientSeries",
        106
      ],
      [
        "date_of_birth",
        "patients.date_of_birth",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L103",
        "DatePatientSeries",
        103
      ],
      [
        "ethnicity",
        "clinical_events.where(clinical_events.snomedct_code.is_in(ethnicity5)).sort_by(clinical_events.date).last_for_patient().snomedct_code.to_category(ethnicity5)",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L152",
        "StrPatientSeries",
        152
      ],
      [
        "last_registration_end",
        "last_registration_end",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L162",
        "DatePatientSeries",
        162
      ],
      [
        "ons_death_date",
        "ons_deaths.date",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L97",
        "DatePatientSeries",
        97
      ],
      [
        "ons_death_place",
        "ons_deaths.place",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L118",
        "StrPatientSeries",
        118
      ],
      [
        "practice",
        "practice_registrations.for_patient_on(earliest_DoD).practice_pseudo_id",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L115",
        "IntPatientSeries",
        115
      ],
      [
        "region",
        "practice_registrations.for_patient_on(earliest_DoD).practice_nuts1_region_name",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L121",
        "StrPatientSeries",
        121
      ],
      [
        "rural_urban",
        "addresses.for_patient_on(earliest_DoD).rural_urban_classification",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L124",
        "IntPatientSeries",
        124
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/death-report/blob/87bb6fdf5c17ab50b20013a1d6eab0562bc2222a/analysis/dataset_definition.py#L159",
        "StrPatientSeries",
        159
      ]
    ]
  },
  "dfms-covid19-new": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/dfms-covid19-new/blob/bafd9a0b790bfa7697b3d9f2fbfebd3f39634ed5/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "diamorphine-counts": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/diamorphine-counts/blob/8591ebdb4dff724c6966c2a7ca8acbf7acaa07c2/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "digital-access-to-primary-care": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "patients.age_on(start_date)",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L105",
        "IntPatientSeries",
        105
      ],
      [
        "age_greater_equal_65",
        "dataset.age >= 65",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L106",
        "BoolPatientSeries",
        106
      ],
      [
        "count_appointment",
        "appointments_seen.count_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L95",
        "IntPatientSeries",
        95
      ],
      [
        "count_f2f_consultation",
        "selected_events.where(clinical_events.snomedct_code.is_in(f2f_consultation)).count_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L63",
        "IntPatientSeries",
        63
      ],
      [
        "count_virtual_consultation",
        "selected_events.where(clinical_events.snomedct_code.is_in(virtual_consultation)).count_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L46",
        "IntPatientSeries",
        46
      ],
      [
        "dod",
        "patients.date_of_death",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L110",
        "DatePatientSeries",
        110
      ],
      [
        "ethnicity",
        "case(when(latest_ethnicity == '1').then('White'), when(latest_ethnicity == '2').then('Mixed'), when(latest_ethnicity == '3').then('Asian or Asian British'), when(latest_ethnicity == '4').then('Black or Black British'), when(latest_ethnicity == '5').then('Chinese or Other Ethnic Groups'), otherwise='missing')",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L136",
        "StrPatientSeries",
        136
      ],
      [
        "has_appointment",
        "appointments_seen.exists_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L97",
        "BoolPatientSeries",
        97
      ],
      [
        "has_f2f_consultation",
        "selected_events.where(clinical_events.snomedct_code.is_in(f2f_consultation)).exists_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L58",
        "BoolPatientSeries",
        58
      ],
      [
        "has_virtual_consultation",
        "selected_events.where(clinical_events.snomedct_code.is_in(virtual_consultation)).exists_for_patient()",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L40",
        "BoolPatientSeries",
        40
      ],
      [
        "imd_quintile",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5'), otherwise='Missing')",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L115",
        "StrPatientSeries",
        115
      ],
      [
        "last_appointment_status",
        "appointments_seen.sort_by(appointments_seen.seen_date).last_for_patient().status",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L89",
        "StrPatientSeries",
        89
      ],
      [
        "last_f2f_consultation_code",
        "selected_events.where(clinical_events.snomedct_code.is_in(f2f_consultation)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L67",
        "CodePatientSeries",
        67
      ],
      [
        "last_virtual_consultation_code",
        "selected_events.where(clinical_events.snomedct_code.is_in(virtual_consultation)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L50",
        "CodePatientSeries",
        50
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/digital-access-to-primary-care/blob/891399e82ee17eb1143e808130fe669b1d2693ac/analysis/dataset_definition.py#L109",
        "StrPatientSeries",
        109
      ]
    ]
  },
  "disease_incidence": {
    "analysis/dataset_definition.py": [
      [
        "age_reg",
        "patients.age_on(dataset.registration_start)",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L89",
        "IntPatientSeries",
        89
      ],
      [
        "date_of_death",
        "patients.date_of_death",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L70",
        "DatePatientSeries",
        70
      ],
      [
        "ethnicity",
        "case(when((latest_ethnicity_code == '1') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['A', 'B', 'C'])).then('White'), when((latest_ethnicity_code == '2') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['D', 'E', 'F', 'G'])).then('Mixed'), when((latest_ethnicity_code == '3') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['H', 'J', 'K', 'L'])).then('Asian or Asian British'), when((latest_ethnicity_code == '4') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['M', 'N', 'P'])).then('Black or Black British'), when((latest_ethnicity_code == '5') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['R', 'S'])).then('Chinese or Other Ethnic Groups'), otherwise='Unknown')",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L102",
        "StrPatientSeries",
        102
      ],
      [
        "imd_quintile",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='Unknown')",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L114",
        "StrPatientSeries",
        114
      ],
      [
        "registration_start",
        "practice_registrations.where(practice_registrations.start_date <= end_date).except_where(practice_registrations.end_date < index_date).sort_by(practice_registrations.start_date).last_for_patient().start_date",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L80",
        "DatePatientSeries",
        80
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition.py#L69",
        "StrPatientSeries",
        69
      ]
    ],
    "analysis/dataset_definition_demographics_disease.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition_demographics_disease.py#L62",
        "IntPatientSeries",
        62
      ],
      [
        "date_of_death",
        "patients.date_of_death",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition_demographics_disease.py#L52",
        "DatePatientSeries",
        52
      ],
      [
        "ethnicity",
        "case(when((latest_ethnicity_code == '1') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['A', 'B', 'C'])).then('White'), when((latest_ethnicity_code == '2') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['D', 'E', 'F', 'G'])).then('Mixed'), when((latest_ethnicity_code == '3') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['H', 'J', 'K', 'L'])).then('Asian or Asian British'), when((latest_ethnicity_code == '4') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['M', 'N', 'P'])).then('Black or Black British'), when((latest_ethnicity_code == '5') | latest_ethnicity_code.is_null() & ethnicity_sus.is_in(['R', 'S'])).then('Chinese or Other Ethnic Groups'), otherwise='Unknown')",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition_demographics_disease.py#L87",
        "StrPatientSeries",
        87
      ],
      [
        "imd_quintile",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd < int(32844 * 2 / 5)).then('2'), when(imd < int(32844 * 3 / 5)).then('3'), when(imd < int(32844 * 4 / 5)).then('4'), when(imd < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='Unknown')",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition_demographics_disease.py#L99",
        "StrPatientSeries",
        99
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/disease_incidence/blob/fc298800a6f934bf33474f9fc00156dc84b4cbd7/analysis/dataset_definition_demographics_disease.py#L49",
        "StrPatientSeries",
        49
      ]
    ]
  },
  "disparities-comparison": {
    "analysis/dataset_definition_flow_chart.py": [
      [
        "birth_date",
        "patients.date_of_birth",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L189",
        "DatePatientSeries",
        189
      ],
      [
        "care_home",
        "care_home_tpp | care_home_code",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L183",
        "BoolPatientSeries",
        183
      ],
      [
        "has_imd",
        "has_imd",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L153",
        "BoolPatientSeries",
        153
      ],
      [
        "is_female_or_male",
        "is_female_or_male",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L150",
        "BoolPatientSeries",
        150
      ],
      [
        "mother_id",
        "parents.mother_id",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L188",
        "IntPatientSeries",
        188
      ],
      [
        "patient_end_date",
        "followup_end_date",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L86",
        "DatePatientSeries",
        86
      ],
      [
        "patient_index_date",
        "index_date",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L85",
        "DatePatientSeries",
        85
      ],
      [
        "registered",
        "registered_patients",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L149",
        "BoolPatientSeries",
        149
      ],
      [
        "risk_group_infants",
        "case(when(age_months < 12).then(hospitalisation_diagnosis_matches(codelists.ventilation_codes).exists_for_patient()), when((age_months >= 12) & (age_months <= 23) & (clinical_events.where(clinical_events.ctv3_code.is_in(codelists.cardiac_disease_codelist)).exists_for_patient() | clinical_events.where(clinical_events.snomedct_code.is_in(codelists.pulmonary_hypertension_codelist)).exists_for_patient())).then(hospitalisation_diagnosis_matches(codelists.ventilation_codes).exists_for_patient()), otherwise=False)",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L165",
        "BoolPatientSeries",
        165
      ],
      [
        "severe_immunodeficiency",
        "has_prior_event(codelists.severe_immunodeficiency_code)",
        "https://github.com/opensafely/disparities-comparison/blob/1ed86982c3595abc55f74f93bdaa6cd502b039d6/analysis/dataset_definition_flow_chart.py#L159",
        "BoolPatientSeries",
        159
      ]
    ]
  },
  "doacs-covid19-new": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/doacs-covid19-new/blob/37de7381c20e0e496ec5781aa473d708eb9b9b2d/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "ehrql-test-study": {
    "analysis/dataset_definition.py": [
      [
        "ace_or_arb",
        "has_arb_treatment | has_ace_treatment",
        "https://github.com/opensafely/ehrql-test-study/blob/07d5f283bb66f52a49933b016cf8dc144cfc7180/analysis/dataset_definition.py#L79",
        "BoolPatientSeries",
        79
      ],
      [
        "prt_or_mal",
        "has_proteinuria_diagnosis | has_microalbuminuria_diagnosis",
        "https://github.com/opensafely/ehrql-test-study/blob/07d5f283bb66f52a49933b016cf8dc144cfc7180/analysis/dataset_definition.py#L78",
        "BoolPatientSeries",
        78
      ]
    ],
    "analysis/dataset_definition_minimal.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/ehrql-test-study/blob/07d5f283bb66f52a49933b016cf8dc144cfc7180/analysis/dataset_definition_minimal.py#L8",
        "IntPatientSeries",
        8
      ]
    ]
  },
  "exercise_pegasus_comorbidities": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L44",
        "IntPatientSeries",
        44
      ],
      [
        "ethnicity16",
        "when(latest_ethnicity_code_16.is_null()).then('unknown').otherwise(latest_ethnicity_code_16)",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L74",
        "StrPatientSeries",
        74
      ],
      [
        "ethnicity6",
        "case(when(latest_ethnicity_code_6 == '1').then('W'), when(latest_ethnicity_code_6 == '2').then('M'), when(latest_ethnicity_code_6 == '3').then('A'), when(latest_ethnicity_code_6 == '4').then('B'), when(latest_ethnicity_code_6 == '5').then('CO'), otherwise='unknown')",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L65",
        "StrPatientSeries",
        65
      ],
      [
        "ethnicity_from_sus",
        "when(dataset_ethnicity_from_sus.is_null()).then('unknown').otherwise(dataset_ethnicity_from_sus)",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L48",
        "StrPatientSeries",
        48
      ],
      [
        "has_had_cancer_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(cancer_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L115",
        "BoolPatientSeries",
        115
      ],
      [
        "has_had_ckd_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(ckd_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L99",
        "BoolPatientSeries",
        99
      ],
      [
        "has_had_cld_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(cld_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L105",
        "BoolPatientSeries",
        105
      ],
      [
        "has_had_crd_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(crd_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L93",
        "BoolPatientSeries",
        93
      ],
      [
        "has_had_cvd_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(cvd_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L87",
        "BoolPatientSeries",
        87
      ],
      [
        "has_had_immunosuppression_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(immuno_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L121",
        "BoolPatientSeries",
        121
      ],
      [
        "has_had_neuro_diagnosis",
        "clinical_events.where(clinical_events.snomedct_code.is_in(neuro_codelist)).exists_for_patient()",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L127",
        "BoolPatientSeries",
        127
      ],
      [
        "msoa_code",
        "case(when(has_address == True).then(address.msoa_code), otherwise='unknown')",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L78",
        "StrPatientSeries",
        78
      ],
      [
        "region",
        "practice_registrations.for_patient_on(index_date).practice_nuts1_region_name",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L83",
        "StrPatientSeries",
        83
      ],
      [
        "severe_obesity",
        "has_severe_obesity(index_date)",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L111",
        "BoolPatientSeries",
        111
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/exercise_pegasus_comorbidities/blob/214e6579fac56ac924c84d76efad5d613cfa7b58/analysis/dataset_definition.py#L43",
        "StrPatientSeries",
        43
      ]
    ]
  },
  "gbd-estimates": {
    "analysis/generate-dummy-tables.py": [
      [
        "birth_date",
        "patients.date_of_birth",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L32",
        "DatePatientSeries",
        32
      ],
      [
        "gp_death_date",
        "patients.date_of_death",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L33",
        "DatePatientSeries",
        33
      ],
      [
        "imd_rounded",
        "address.imd_rounded",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L46",
        "IntPatientSeries",
        46
      ],
      [
        "ons_death_date",
        "ons_deaths.date",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L34",
        "DatePatientSeries",
        34
      ],
      [
        "region",
        "registration.practice_nuts1_region_name",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L44",
        "StrPatientSeries",
        44
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L39",
        "StrPatientSeries",
        39
      ],
      [
        "stp",
        "registration.practice_stp",
        "https://github.com/opensafely/gbd-estimates/blob/f65d3193ef893e60e62592cd7e2200fe1d0595e8/analysis/generate-dummy-tables.py#L45",
        "StrPatientSeries",
        45
      ]
    ]
  },
  "gh-testing-research": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L30",
        "IntPatientSeries",
        30
      ],
      [
        "bp_dias",
        "bp_dias_clinical_events.where(clinical_events.date == date_of_most_recent_bp_dias_clinical_event).numeric_value.mean_for_patient()",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L77",
        "FloatPatientSeries",
        77
      ],
      [
        "bp_sys",
        "bp_sys_clinical_events.where(clinical_events.date == date_of_most_recent_bp_sys_clinical_event).numeric_value.mean_for_patient()",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L63",
        "FloatPatientSeries",
        63
      ],
      [
        "chronic_cardiac_disease",
        "clinical_events.where(clinical_events.snomedct_code.is_in(chronic_cardiac_disease_codes)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L35",
        "DatePatientSeries",
        35
      ],
      [
        "chronic_liver_disease",
        "clinical_events.where(clinical_events.snomedct_code.is_in(chronic_liver_disease_codes)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L44",
        "DatePatientSeries",
        44
      ],
      [
        "imd",
        "addresses.for_patient_on(index_date).imd_rounded",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L88",
        "IntPatientSeries",
        88
      ],
      [
        "msoa",
        "addresses.for_patient_on(index_date).msoa_code",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L85",
        "StrPatientSeries",
        85
      ],
      [
        "recent_salbutamol_count",
        "medications.where(medications.dmd_code.is_in(salbutamol_codes)).where(medications.date.is_on_or_between(index_date - years(2), index_date)).count_for_patient()",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L93",
        "IntPatientSeries",
        93
      ],
      [
        "rural_urban",
        "addresses.for_patient_on(index_date).rural_urban_classification",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L91",
        "IntPatientSeries",
        91
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L33",
        "StrPatientSeries",
        33
      ],
      [
        "stp",
        "practice_registrations.for_patient_on(index_date).practice_stp",
        "https://github.com/opensafely/gh-testing-research/blob/f5b9233ff1327fb12aa08bffe6d14bbe893b3f4c/analysis/dataset_definition.py#L82",
        "StrPatientSeries",
        82
      ]
    ]
  },
  "metfin_covid": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/metfin_covid/blob/44effa6dd060b8d300c520fc91d7d095ffb3bd30/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "metformin_covid": {
    "analysis/dataset_definition_dm_algo.py": [
      [
        "cov_cat_ethnicity",
        "case(when((ethnicity_snomed == '1') | (ethnicity_snomed == 'Missing') & ethnicity_sus.is_in(['A', 'B', 'C'])).then('White'), when((ethnicity_snomed == '2') | (ethnicity_snomed == 'Missing') & ethnicity_sus.is_in(['D', 'E', 'F', 'G'])).then('Mixed'), when((ethnicity_snomed == '3') | (ethnicity_snomed == 'Missing') & ethnicity_sus.is_in(['H', 'J', 'K', 'L'])).then('Asian'), when((ethnicity_snomed == '4') | (ethnicity_snomed == 'Missing') & ethnicity_sus.is_in(['M', 'N', 'P'])).then('Black'), when((ethnicity_snomed == '5') | (ethnicity_snomed == 'Missing') & ethnicity_sus.is_in(['R', 'S'])).then('Other'), otherwise='Unknown')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L66",
        "StrPatientSeries",
        66
      ],
      [
        "elig_date_gestationaldm",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_gestational_ctv3_clinical, pandemicstart_date).date, first_matching_event_apc_before(diabetes_gestational_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L110",
        "DatePatientSeries",
        110
      ],
      [
        "elig_date_otherdm",
        "first_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L104",
        "DatePatientSeries",
        104
      ],
      [
        "elig_date_t1dm",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, pandemicstart_date).date, first_matching_event_apc_before(diabetes_type1_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L80",
        "DatePatientSeries",
        80
      ],
      [
        "elig_date_t2dm",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, pandemicstart_date).date, first_matching_event_apc_before(diabetes_type2_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L92",
        "DatePatientSeries",
        92
      ],
      [
        "qa_num_birth_year",
        "patients.date_of_birth",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L54",
        "DatePatientSeries",
        54
      ],
      [
        "tmp_elig_count_otherdm",
        "count_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, pandemicstart_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L106",
        "IntPatientSeries",
        106
      ],
      [
        "tmp_elig_count_poccdm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, pandemicstart_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L119",
        "IntPatientSeries",
        119
      ],
      [
        "tmp_elig_count_t1dm",
        "tmp_elig_count_t1dm_ctv3 + tmp_elig_count_t1dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L87",
        "IntPatientSeries",
        87
      ],
      [
        "tmp_elig_count_t2dm",
        "tmp_elig_count_t2dm_ctv3 + tmp_elig_count_t2dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L100",
        "IntPatientSeries",
        100
      ],
      [
        "tmp_elig_date_antidiabetic_drugs_snomed",
        "first_matching_med_dmd_before(antidiabetic_drugs_snomed_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L144",
        "DatePatientSeries",
        144
      ],
      [
        "tmp_elig_date_diabetes_medication",
        "minimum_of(dataset.tmp_elig_date_insulin_snomed, dataset.tmp_elig_date_antidiabetic_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L148",
        "DatePatientSeries",
        148
      ],
      [
        "tmp_elig_date_first_diabetes_diag",
        "minimum_of(dataset.elig_date_t2dm, dataset.elig_date_t1dm, dataset.elig_date_otherdm, dataset.elig_date_gestationaldm, dataset.tmp_elig_date_poccdm, dataset.tmp_elig_date_diabetes_medication, dataset.tmp_elig_date_nonmetform_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L151",
        "DatePatientSeries",
        151
      ],
      [
        "tmp_elig_date_insulin_snomed",
        "first_matching_med_dmd_before(insulin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L143",
        "DatePatientSeries",
        143
      ],
      [
        "tmp_elig_date_max_hba1c",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(pandemicstart_date)).where(clinical_events.numeric_value == dataset.tmp_elig_num_max_hba1c_mmol_mol).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L131",
        "DatePatientSeries",
        131
      ],
      [
        "tmp_elig_date_nonmetform_drugs_snomed",
        "first_matching_med_dmd_before(non_metformin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L145",
        "DatePatientSeries",
        145
      ],
      [
        "tmp_elig_date_poccdm",
        "first_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L117",
        "DatePatientSeries",
        117
      ],
      [
        "tmp_elig_date_t1dm_ctv3",
        "first_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L79",
        "DatePatientSeries",
        79
      ],
      [
        "tmp_elig_date_t2dm_ctv3",
        "first_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L91",
        "DatePatientSeries",
        91
      ],
      [
        "tmp_elig_num_max_hba1c_mmol_mol",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(pandemicstart_date)).numeric_value.maximum_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_dm_algo.py#L124",
        "FloatPatientSeries",
        124
      ]
    ],
    "analysis/dataset_definition_ppa.py": [
      [
        "cov_date_all_stroke",
        "minimum_of(first_matching_event_clinical_snomed_before(stroke_isch_snomed_clinical + stroke_sah_hs_snomed_clinical, studyend_date).date, first_matching_event_apc_before(stroke_isch_icd10 + stroke_sah_hs_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L100",
        "DatePatientSeries",
        100
      ],
      [
        "cov_date_ami",
        "minimum_of(first_matching_event_clinical_snomed_before(ami_snomed_clinical, studyend_date).date, first_matching_event_apc_before(ami_prior_icd10 + ami_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L95",
        "DatePatientSeries",
        95
      ],
      [
        "cov_date_angina",
        "minimum_of(first_matching_event_clinical_snomed_before(angina_snomed_clinical, studyend_date).date, first_matching_event_apc_before(angina_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L124",
        "DatePatientSeries",
        124
      ],
      [
        "cov_date_bmi_1",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.landmark_date, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L192",
        "DatePatientSeries",
        192
      ],
      [
        "cov_date_bmi_2",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_1, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L200",
        "DatePatientSeries",
        200
      ],
      [
        "cov_date_bmi_3",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_2, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L208",
        "DatePatientSeries",
        208
      ],
      [
        "cov_date_bmi_4",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_3, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L216",
        "DatePatientSeries",
        216
      ],
      [
        "cov_date_bmi_5",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_4, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L224",
        "DatePatientSeries",
        224
      ],
      [
        "cov_date_bmi_6",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_5, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L232",
        "DatePatientSeries",
        232
      ],
      [
        "cov_date_bmi_7",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_6, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L240",
        "DatePatientSeries",
        240
      ],
      [
        "cov_date_bmi_8",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_7, studyend_date), minimum_age_at_measurement=16).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L248",
        "DatePatientSeries",
        248
      ],
      [
        "cov_date_cancer",
        "minimum_of(first_matching_event_clinical_snomed_before(cancer_snomed_clinical, studyend_date).date, first_matching_event_apc_before(cancer_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L136",
        "DatePatientSeries",
        136
      ],
      [
        "cov_date_chol_1",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.landmark_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L276",
        "DatePatientSeries",
        276
      ],
      [
        "cov_date_chol_2",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_1, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L278",
        "DatePatientSeries",
        278
      ],
      [
        "cov_date_chol_3",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_2, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L280",
        "DatePatientSeries",
        280
      ],
      [
        "cov_date_chol_4",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_3, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L282",
        "DatePatientSeries",
        282
      ],
      [
        "cov_date_chol_5",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_4, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L284",
        "DatePatientSeries",
        284
      ],
      [
        "cov_date_chol_6",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_5, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L286",
        "DatePatientSeries",
        286
      ],
      [
        "cov_date_chol_7",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_6, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L288",
        "DatePatientSeries",
        288
      ],
      [
        "cov_date_chol_8",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_7, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L290",
        "DatePatientSeries",
        290
      ],
      [
        "cov_date_chronic_kidney_disease",
        "minimum_of(first_matching_event_clinical_snomed_before(ckd_snomed_clinical, studyend_date).date, first_matching_event_apc_before(ckd_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L166",
        "DatePatientSeries",
        166
      ],
      [
        "cov_date_copd",
        "minimum_of(first_matching_event_clinical_snomed_before(copd_snomed_clinical, studyend_date).date, first_matching_event_apc_before(copd_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L154",
        "DatePatientSeries",
        154
      ],
      [
        "cov_date_dementia",
        "minimum_of(first_matching_event_clinical_snomed_before(dementia_snomed_clinical + dementia_vascular_snomed_clinical, studyend_date).date, first_matching_event_apc_before(dementia_icd10 + dementia_vascular_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L130",
        "DatePatientSeries",
        130
      ],
      [
        "cov_date_depression",
        "minimum_of(first_matching_event_clinical_snomed_before(depression_snomed_clinical, studyend_date).date, first_matching_event_apc_before(depression_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L148",
        "DatePatientSeries",
        148
      ],
      [
        "cov_date_diabetescomp",
        "minimum_of(first_matching_event_clinical_snomed_before(diabetescomp_snomed_clinical, studyend_date).date, first_matching_event_apc_before(diabetescomp_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L183",
        "DatePatientSeries",
        183
      ],
      [
        "cov_date_hba1c_1",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.landmark_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L258",
        "DatePatientSeries",
        258
      ],
      [
        "cov_date_hba1c_2",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_1, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L260",
        "DatePatientSeries",
        260
      ],
      [
        "cov_date_hba1c_3",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_2, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L262",
        "DatePatientSeries",
        262
      ],
      [
        "cov_date_hba1c_4",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_3, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L264",
        "DatePatientSeries",
        264
      ],
      [
        "cov_date_hba1c_5",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_4, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L266",
        "DatePatientSeries",
        266
      ],
      [
        "cov_date_hba1c_6",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_5, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L268",
        "DatePatientSeries",
        268
      ],
      [
        "cov_date_hba1c_7",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_6, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L270",
        "DatePatientSeries",
        270
      ],
      [
        "cov_date_hba1c_8",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_7, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L272",
        "DatePatientSeries",
        272
      ],
      [
        "cov_date_hdl_chol_1",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.landmark_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L294",
        "DatePatientSeries",
        294
      ],
      [
        "cov_date_hdl_chol_2",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_1, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L296",
        "DatePatientSeries",
        296
      ],
      [
        "cov_date_hdl_chol_3",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_2, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L298",
        "DatePatientSeries",
        298
      ],
      [
        "cov_date_hdl_chol_4",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_3, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L300",
        "DatePatientSeries",
        300
      ],
      [
        "cov_date_hdl_chol_5",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_4, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L302",
        "DatePatientSeries",
        302
      ],
      [
        "cov_date_hdl_chol_6",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_5, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L304",
        "DatePatientSeries",
        304
      ],
      [
        "cov_date_hdl_chol_7",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_6, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L306",
        "DatePatientSeries",
        306
      ],
      [
        "cov_date_hdl_chol_8",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_7, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L308",
        "DatePatientSeries",
        308
      ],
      [
        "cov_date_hf",
        "minimum_of(first_matching_event_clinical_snomed_before(hf_snomed_clinical, studyend_date).date, first_matching_event_apc_before(hf_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L118",
        "DatePatientSeries",
        118
      ],
      [
        "cov_date_hypertension",
        "minimum_of(first_matching_event_clinical_snomed_before(hypertension_snomed_clinical, studyend_date).date, first_matching_event_apc_before(hypertension_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L142",
        "DatePatientSeries",
        142
      ],
      [
        "cov_date_liver_disease",
        "minimum_of(first_matching_event_clinical_snomed_before(liver_disease_snomed_clinical, studyend_date).date, first_matching_event_apc_before(liver_disease_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L160",
        "DatePatientSeries",
        160
      ],
      [
        "cov_date_other_arterial_embolism",
        "minimum_of(first_matching_event_clinical_snomed_before(other_arterial_embolism_snomed_clinical, studyend_date).date, first_matching_event_apc_before(other_arterial_embolism_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "cov_date_pcos",
        "minimum_of(first_matching_event_clinical_snomed_before(pcos_snomed_clinical, studyend_date).date, first_matching_event_apc_before(pcos_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L172",
        "DatePatientSeries",
        172
      ],
      [
        "cov_date_prediabetes",
        "first_matching_event_clinical_snomed_before(prediabetes_snomed, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L179",
        "DatePatientSeries",
        179
      ],
      [
        "cov_date_vte",
        "minimum_of(first_matching_event_clinical_snomed_before(portal_vein_thrombosis_snomed_clinical + dvt_dvt_snomed_clinical + dvt_icvt_snomed_clinical + dvt_pregnancy_snomed_clinical + other_dvt_snomed_clinical + pe_snomed_clinical, studyend_date).date, first_matching_event_apc_before(portal_vein_thrombosis_icd10 + dvt_dvt_icd10 + dvt_icvt_icd10 + dvt_pregnancy_icd10 + other_dvt_icd10 + icvt_pregnancy_icd10 + pe_icd10, studyend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L112",
        "DatePatientSeries",
        112
      ],
      [
        "cov_num_bmi_1",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.landmark_date, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L196",
        "FloatPatientSeries",
        196
      ],
      [
        "cov_num_bmi_2",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_1, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L204",
        "FloatPatientSeries",
        204
      ],
      [
        "cov_num_bmi_3",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_2, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L212",
        "FloatPatientSeries",
        212
      ],
      [
        "cov_num_bmi_4",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_3, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L220",
        "FloatPatientSeries",
        220
      ],
      [
        "cov_num_bmi_5",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_4, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L228",
        "FloatPatientSeries",
        228
      ],
      [
        "cov_num_bmi_6",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_5, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L236",
        "FloatPatientSeries",
        236
      ],
      [
        "cov_num_bmi_7",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_6, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L244",
        "FloatPatientSeries",
        244
      ],
      [
        "cov_num_bmi_8",
        "first_bmi(where=clinical_events.date.is_on_or_between(dataset.cov_date_bmi_7, studyend_date), minimum_age_at_measurement=16).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L252",
        "FloatPatientSeries",
        252
      ],
      [
        "cov_num_chol_1",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.landmark_date, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L277",
        "FloatPatientSeries",
        277
      ],
      [
        "cov_num_chol_2",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_1, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L279",
        "FloatPatientSeries",
        279
      ],
      [
        "cov_num_chol_3",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_2, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L281",
        "FloatPatientSeries",
        281
      ],
      [
        "cov_num_chol_4",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_3, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L283",
        "FloatPatientSeries",
        283
      ],
      [
        "cov_num_chol_5",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_4, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L285",
        "FloatPatientSeries",
        285
      ],
      [
        "cov_num_chol_6",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_5, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L287",
        "FloatPatientSeries",
        287
      ],
      [
        "cov_num_chol_7",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_6, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L289",
        "FloatPatientSeries",
        289
      ],
      [
        "cov_num_chol_8",
        "first_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.cov_date_chol_7, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L291",
        "FloatPatientSeries",
        291
      ],
      [
        "cov_num_hba1c_1",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.landmark_date, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L259",
        "FloatPatientSeries",
        259
      ],
      [
        "cov_num_hba1c_2",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_1, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L261",
        "FloatPatientSeries",
        261
      ],
      [
        "cov_num_hba1c_3",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_2, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L263",
        "FloatPatientSeries",
        263
      ],
      [
        "cov_num_hba1c_4",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_3, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L265",
        "FloatPatientSeries",
        265
      ],
      [
        "cov_num_hba1c_5",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_4, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L267",
        "FloatPatientSeries",
        267
      ],
      [
        "cov_num_hba1c_6",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_5, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L269",
        "FloatPatientSeries",
        269
      ],
      [
        "cov_num_hba1c_7",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_6, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L271",
        "FloatPatientSeries",
        271
      ],
      [
        "cov_num_hba1c_8",
        "first_matching_event_clinical_snomed_between(hba1c_snomed, dataset.cov_date_hba1c_7, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L273",
        "FloatPatientSeries",
        273
      ],
      [
        "cov_num_hdl_chol_1",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.landmark_date, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L295",
        "FloatPatientSeries",
        295
      ],
      [
        "cov_num_hdl_chol_2",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_1, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L297",
        "FloatPatientSeries",
        297
      ],
      [
        "cov_num_hdl_chol_3",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_2, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L299",
        "FloatPatientSeries",
        299
      ],
      [
        "cov_num_hdl_chol_4",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_3, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L301",
        "FloatPatientSeries",
        301
      ],
      [
        "cov_num_hdl_chol_5",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_4, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L303",
        "FloatPatientSeries",
        303
      ],
      [
        "cov_num_hdl_chol_6",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_5, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L305",
        "FloatPatientSeries",
        305
      ],
      [
        "cov_num_hdl_chol_7",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_6, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L307",
        "FloatPatientSeries",
        307
      ],
      [
        "cov_num_hdl_chol_8",
        "first_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.cov_date_hdl_chol_7, studyend_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L309",
        "FloatPatientSeries",
        309
      ],
      [
        "elig_date_t2dm",
        "elig_patients.elig_date_t2dm",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L64",
        "DatePatientSeries",
        64
      ],
      [
        "landmark_date",
        "elig_patients.landmark_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_ppa.py#L63",
        "DatePatientSeries",
        63
      ]
    ],
    "analysis/dataset_definition_t2dm.py": [
      [
        "cens_date_dereg",
        "deregistered.end_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L533",
        "DatePatientSeries",
        533
      ],
      [
        "cov_bin_all_stroke",
        "last_matching_event_clinical_snomed_before(stroke_isch_snomed_clinical + stroke_sah_hs_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(stroke_isch_icd10 + stroke_sah_hs_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L324",
        "BoolPatientSeries",
        324
      ],
      [
        "cov_bin_ami",
        "last_matching_event_clinical_snomed_before(ami_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(ami_prior_icd10 + ami_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L318",
        "BoolPatientSeries",
        318
      ],
      [
        "cov_bin_angina",
        "last_matching_event_clinical_snomed_before(angina_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(angina_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L348",
        "BoolPatientSeries",
        348
      ],
      [
        "cov_bin_cancer",
        "last_matching_event_clinical_snomed_before(cancer_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(cancer_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L360",
        "BoolPatientSeries",
        360
      ],
      [
        "cov_bin_chronic_kidney_disease",
        "last_matching_event_clinical_snomed_before(ckd_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(ckd_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L390",
        "BoolPatientSeries",
        390
      ],
      [
        "cov_bin_copd",
        "last_matching_event_clinical_snomed_before(copd_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(copd_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L378",
        "BoolPatientSeries",
        378
      ],
      [
        "cov_bin_dementia",
        "last_matching_event_clinical_snomed_before(dementia_snomed_clinical + dementia_vascular_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(dementia_icd10 + dementia_vascular_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L354",
        "BoolPatientSeries",
        354
      ],
      [
        "cov_bin_depression",
        "last_matching_event_clinical_snomed_before(depression_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(depression_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L372",
        "BoolPatientSeries",
        372
      ],
      [
        "cov_bin_diabetescomp",
        "last_matching_event_clinical_snomed_before(diabetescomp_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(diabetescomp_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L416",
        "BoolPatientSeries",
        416
      ],
      [
        "cov_bin_healthcare_worker",
        "occupation_on_covid_vaccine_record.where(occupation_on_covid_vaccine_record.is_healthcare_worker == True).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L287",
        "BoolPatientSeries",
        287
      ],
      [
        "cov_bin_hf",
        "last_matching_event_clinical_snomed_before(hf_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(hf_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L342",
        "BoolPatientSeries",
        342
      ],
      [
        "cov_bin_hypertension",
        "last_matching_event_clinical_snomed_before(hypertension_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(hypertension_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L366",
        "BoolPatientSeries",
        366
      ],
      [
        "cov_bin_liver_disease",
        "last_matching_event_clinical_snomed_before(liver_disease_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(liver_disease_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L384",
        "BoolPatientSeries",
        384
      ],
      [
        "cov_bin_obesity",
        "last_matching_event_clinical_snomed_before(bmi_obesity_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(bmi_obesity_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L312",
        "BoolPatientSeries",
        312
      ],
      [
        "cov_bin_other_arterial_embolism",
        "last_matching_event_clinical_snomed_before(other_arterial_embolism_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(other_arterial_embolism_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L330",
        "BoolPatientSeries",
        330
      ],
      [
        "cov_bin_pcos",
        "last_matching_event_clinical_snomed_before(pcos_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(pcos_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L396",
        "BoolPatientSeries",
        396
      ],
      [
        "cov_bin_prediabetes",
        "tmp_cov_bin_prediabetes | tmp_cov_bin_predm_hba1c_mmol_mol",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L413",
        "BoolPatientSeries",
        413
      ],
      [
        "cov_bin_vte",
        "last_matching_event_clinical_snomed_before(portal_vein_thrombosis_snomed_clinical + dvt_dvt_snomed_clinical + dvt_icvt_snomed_clinical + dvt_pregnancy_snomed_clinical + other_dvt_snomed_clinical + pe_snomed_clinical, dataset.elig_date_t2dm).exists_for_patient() | last_matching_event_apc_before(portal_vein_thrombosis_icd10 + dvt_dvt_icd10 + dvt_icvt_icd10 + dvt_pregnancy_icd10 + other_dvt_icd10 + icvt_pregnancy_icd10 + pe_icd10, dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L336",
        "BoolPatientSeries",
        336
      ],
      [
        "cov_cat_bmi_groups",
        "case(when((dataset.cov_num_bmi_b < 18.5) & (dataset.cov_num_bmi_b >= 12.0)).then('Underweight'), when((dataset.cov_num_bmi_b >= 18.5) & (dataset.cov_num_bmi_b < 25.0)).then('Healthy weight (18.5-24.9)'), when((dataset.cov_num_bmi_b >= 25.0) & (dataset.cov_num_bmi_b < 30.0)).then('Overweight (25-29.9)'), when((dataset.cov_num_bmi_b >= 30.0) & (dataset.cov_num_bmi_b <= 70.0)).then('Obese (>30)'), otherwise='missing')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L427",
        "StrPatientSeries",
        427
      ],
      [
        "cov_cat_deprivation_5",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='Unknown')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L240",
        "StrPatientSeries",
        240
      ],
      [
        "cov_cat_ethnicity",
        "data_processed.ethnicity_cat",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L236",
        "StrPatientSeries",
        236
      ],
      [
        "cov_cat_rural_urban",
        "addresses.for_patient_on(dataset.elig_date_t2dm).rural_urban_classification",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L271",
        "IntPatientSeries",
        271
      ],
      [
        "cov_cat_sex",
        "patients.sex",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L230",
        "StrPatientSeries",
        230
      ],
      [
        "cov_cat_smoking_status",
        "case(when(tmp_most_recent_smoking_cat == 'S').then('S'), when(tmp_most_recent_smoking_cat == 'E').then('E'), when((tmp_most_recent_smoking_cat == 'N') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'N').then('N'), when((tmp_most_recent_smoking_cat == 'M') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'M').then('M'), otherwise='M')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L276",
        "StrPatientSeries",
        276
      ],
      [
        "cov_num_age",
        "patients.age_on(dataset.elig_date_t2dm)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L233",
        "IntPatientSeries",
        233
      ],
      [
        "cov_num_bmi_b",
        "bmi_measurement.numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L426",
        "FloatPatientSeries",
        426
      ],
      [
        "cov_num_chol_b",
        "last_matching_event_clinical_snomed_between(cholesterol_snomed, dataset.elig_date_t2dm - days(2 * 366), dataset.elig_date_t2dm).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L439",
        "FloatPatientSeries",
        439
      ],
      [
        "cov_num_consrate",
        "case(when(tmp_cov_num_consrate <= 365).then(tmp_cov_num_consrate), otherwise=365)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L306",
        "IntPatientSeries",
        306
      ],
      [
        "cov_num_counthba1c",
        "count_matching_event_clinical_snomed_between(hba1c_measurement_snomed, dataset.elig_date_t2dm - days(2 * 366), dataset.elig_date_t2dm)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L445",
        "IntPatientSeries",
        445
      ],
      [
        "cov_num_countlifestyle",
        "count_matching_event_clinical_snomed_between(lifestyle_advice_snomed, dataset.elig_date_t2dm - days(2 * 366), dataset.elig_date_t2dm)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L448",
        "IntPatientSeries",
        448
      ],
      [
        "cov_num_hba1c_b",
        "last_matching_event_clinical_snomed_between(hba1c_snomed, dataset.elig_date_t2dm - days(2 * 366), dataset.elig_date_t2dm).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L436",
        "FloatPatientSeries",
        436
      ],
      [
        "cov_num_hdl_chol_b",
        "last_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, dataset.elig_date_t2dm - days(2 * 366), dataset.elig_date_t2dm).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L442",
        "FloatPatientSeries",
        442
      ],
      [
        "elig_bin_carehome_status",
        "case(when(tmp_care_home_code).then(True), when(tmp_care_home_tpp1).then(True), when(tmp_care_home_tpp2).then(True), when(tmp_care_home_tpp3).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L158",
        "BoolPatientSeries",
        158
      ],
      [
        "elig_bin_hosp",
        "apcs.where(apcs.admission_date.is_on_or_before(dataset.elig_date_t2dm) & apcs.discharge_date.is_after(dataset.elig_date_t2dm)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L142",
        "BoolPatientSeries",
        142
      ],
      [
        "elig_date_agi",
        "first_matching_med_dmd_before(agi_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L178",
        "DatePatientSeries",
        178
      ],
      [
        "elig_date_ckd_45_first",
        "minimum_of(first_matching_event_clinical_snomed_before(ckd_snomed_clinical_45, dataset.elig_date_t2dm).date, first_matching_event_apc_before(ckd_stage4_icd10 + ckd_stage5_icd10, dataset.elig_date_t2dm).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L185",
        "DatePatientSeries",
        185
      ],
      [
        "elig_date_dpp4",
        "first_matching_med_dmd_before(dpp4_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L173",
        "DatePatientSeries",
        173
      ],
      [
        "elig_date_glp1",
        "first_matching_med_dmd_before(glp1_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L176",
        "DatePatientSeries",
        176
      ],
      [
        "elig_date_insulin",
        "first_matching_med_dmd_before(insulin_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L179",
        "DatePatientSeries",
        179
      ],
      [
        "elig_date_liver_cirrhosis_first",
        "minimum_of(first_matching_event_clinical_snomed_before(advanced_decompensated_cirrhosis_snomed_clinical + ascitic_drainage_snomed_clinical, dataset.elig_date_t2dm).date, first_matching_event_apc_before(advanced_decompensated_cirrhosis_icd10, dataset.elig_date_t2dm).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L191",
        "DatePatientSeries",
        191
      ],
      [
        "elig_date_megli",
        "first_matching_med_dmd_before(meglitinides_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L177",
        "DatePatientSeries",
        177
      ],
      [
        "elig_date_metfin",
        "first_matching_med_dmd_before(metformin_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L170",
        "DatePatientSeries",
        170
      ],
      [
        "elig_date_metfin_allergy_first",
        "first_matching_event_clinical_snomed_before(metformin_allergy_snomed_clinical, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L182",
        "DatePatientSeries",
        182
      ],
      [
        "elig_date_metfin_interaction_landmark_last",
        "last_matching_med_dmd_before(metformin_interaction_dmd, dataset.elig_date_t2dm + days(183)).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L198",
        "DatePatientSeries",
        198
      ],
      [
        "elig_date_metfin_interaction_last",
        "last_matching_med_dmd_before(metformin_interaction_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L197",
        "DatePatientSeries",
        197
      ],
      [
        "elig_date_palliative",
        "last_matching_event_clinical_snomed_between(palliative_snomed, dataset.elig_date_t2dm - days(183), dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L167",
        "DatePatientSeries",
        167
      ],
      [
        "elig_date_sglt2",
        "first_matching_med_dmd_before(sglt2_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L175",
        "DatePatientSeries",
        175
      ],
      [
        "elig_date_sulfo",
        "first_matching_med_dmd_before(sulfonylurea_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L172",
        "DatePatientSeries",
        172
      ],
      [
        "elig_date_t2dm",
        "data_processed.t2dm_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L75",
        "DatePatientSeries",
        75
      ],
      [
        "elig_date_tzd",
        "first_matching_med_dmd_before(tzd_dmd, dataset.elig_date_t2dm).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L174",
        "DatePatientSeries",
        174
      ],
      [
        "elig_num_hba1c_landmark_mmol_mol",
        "last_matching_event_clinical_snomed_between(hba1c_snomed, dataset.elig_date_t2dm + days(183) - days(2 * 366), dataset.elig_date_t2dm + days(183)).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L202",
        "FloatPatientSeries",
        202
      ],
      [
        "exp_date_agi_first",
        "first_matching_med_dmd_between(agi_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L218",
        "DatePatientSeries",
        218
      ],
      [
        "exp_date_dpp4_first",
        "first_matching_med_dmd_between(dpp4_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L213",
        "DatePatientSeries",
        213
      ],
      [
        "exp_date_glp1_first",
        "first_matching_med_dmd_between(glp1_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L216",
        "DatePatientSeries",
        216
      ],
      [
        "exp_date_insulin_first",
        "first_matching_med_dmd_between(insulin_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L219",
        "DatePatientSeries",
        219
      ],
      [
        "exp_date_megli_first",
        "first_matching_med_dmd_between(meglitinides_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L217",
        "DatePatientSeries",
        217
      ],
      [
        "exp_date_metfin_first",
        "first_matching_med_dmd_between(metformin_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L208",
        "DatePatientSeries",
        208
      ],
      [
        "exp_date_metfin_last",
        "last_matching_med_dmd_before(metformin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L222",
        "DatePatientSeries",
        222
      ],
      [
        "exp_date_metfin_mono_first",
        "first_matching_med_dmd_between(metformin_mono_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L209",
        "DatePatientSeries",
        209
      ],
      [
        "exp_date_metfin_mono_last",
        "last_matching_med_dmd_before(metformin_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L223",
        "DatePatientSeries",
        223
      ],
      [
        "exp_date_sglt2_first",
        "first_matching_med_dmd_between(sglt2_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L215",
        "DatePatientSeries",
        215
      ],
      [
        "exp_date_sulfo_first",
        "first_matching_med_dmd_between(sulfonylurea_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L212",
        "DatePatientSeries",
        212
      ],
      [
        "exp_date_tzd_first",
        "first_matching_med_dmd_between(tzd_dmd, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L214",
        "DatePatientSeries",
        214
      ],
      [
        "out_date_covid",
        "minimum_of(tmp_covid19_primary_care_date, tmp_covid19_sgss_date, dataset.out_date_covid_hosp, dataset.out_date_covid_death)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L482",
        "DatePatientSeries",
        482
      ],
      [
        "out_date_covid_death",
        "case(when(tmp_out_bin_death_covid).then(ons_deaths.date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L465",
        "DatePatientSeries",
        465
      ],
      [
        "out_date_covid_emergency",
        "first_matching_event_ec_snomed_between(covid_emergency, dataset.elig_date_t2dm, studyend_date).arrival_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L458",
        "DatePatientSeries",
        458
      ],
      [
        "out_date_covid_hes",
        "first_matching_event_apc_between(covid_codes_incl_clin_diag, dataset.elig_date_t2dm, studyend_date, only_prim_diagnoses=True).admission_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L456",
        "DatePatientSeries",
        456
      ],
      [
        "out_date_covid_hosp",
        "minimum_of(dataset.out_date_covid_hes, dataset.out_date_covid_emergency)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L460",
        "DatePatientSeries",
        460
      ],
      [
        "out_date_dm_death",
        "case(when(dataset.tmp_out_bin_dm_death).then(ons_deaths.date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L562",
        "DatePatientSeries",
        562
      ],
      [
        "out_date_fracture",
        "first_matching_event_apc_between(fracture_icd10, dataset.elig_date_t2dm, studyend_date).admission_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L564",
        "DatePatientSeries",
        564
      ],
      [
        "out_date_longcovid",
        "first_matching_event_clinical_snomed_between(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L487",
        "DatePatientSeries",
        487
      ],
      [
        "out_date_longcovid_virfat",
        "minimum_of(dataset.out_date_longcovid, dataset.out_date_virfat)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L491",
        "DatePatientSeries",
        491
      ],
      [
        "out_date_severecovid",
        "minimum_of(dataset.out_date_covid_death, dataset.out_date_covid_hosp)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L468",
        "DatePatientSeries",
        468
      ],
      [
        "out_date_virfat",
        "first_matching_event_clinical_snomed_between(post_viral_fatigue_snomed_clinical, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L489",
        "DatePatientSeries",
        489
      ],
      [
        "practice_date_systmone",
        "registered.practice_systmone_go_live_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L270",
        "DatePatientSeries",
        270
      ],
      [
        "qa_bin_cocp",
        "medications.where(medications.dmd_code.is_in(cocp_dmd)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L110",
        "BoolPatientSeries",
        110
      ],
      [
        "qa_bin_hrt",
        "medications.where(medications.dmd_code.is_in(hrt_dmd)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L113",
        "BoolPatientSeries",
        113
      ],
      [
        "qa_bin_is_female_or_male",
        "patients.sex.is_in(['female', 'male'])",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L97",
        "BoolPatientSeries",
        97
      ],
      [
        "qa_bin_known_imd",
        "addresses.for_patient_on(dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L100",
        "BoolPatientSeries",
        100
      ],
      [
        "qa_bin_pregnancy",
        "clinical_events.where(clinical_events.snomedct_code.is_in(pregnancy_snomed_clinical)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L107",
        "BoolPatientSeries",
        107
      ],
      [
        "qa_bin_prostate_cancer",
        "case(when(prostate_cancer_snomed).then(True), when(prostate_cancer_hes).then(True), when(prostate_cancer_death).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L125",
        "BoolPatientSeries",
        125
      ],
      [
        "qa_bin_was_adult",
        "(patients.age_on(dataset.elig_date_t2dm) >= 18) & (patients.age_on(dataset.elig_date_t2dm) <= 85)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L98",
        "BoolPatientSeries",
        98
      ],
      [
        "qa_bin_was_alive",
        "patients.is_alive_on(dataset.elig_date_t2dm)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L99",
        "BoolPatientSeries",
        99
      ],
      [
        "qa_bin_was_registered",
        "practice_registrations.spanning_with_systmone(dataset.elig_date_t2dm - days(366), dataset.elig_date_t2dm).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L101",
        "BoolPatientSeries",
        101
      ],
      [
        "qa_date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L104",
        "DatePatientSeries",
        104
      ],
      [
        "qa_num_birth_year",
        "patients.date_of_birth",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L95",
        "DatePatientSeries",
        95
      ],
      [
        "step_1",
        "data_processed.step_1",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L85",
        "StrPatientSeries",
        85
      ],
      [
        "step_1a",
        "data_processed.step_1a",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L86",
        "StrPatientSeries",
        86
      ],
      [
        "step_2",
        "data_processed.step_2",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L87",
        "StrPatientSeries",
        87
      ],
      [
        "step_3",
        "data_processed.step_3",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L88",
        "StrPatientSeries",
        88
      ],
      [
        "step_4",
        "data_processed.step_4",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L89",
        "StrPatientSeries",
        89
      ],
      [
        "strat_cat_region",
        "registered.practice_nuts1_region_name",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L269",
        "StrPatientSeries",
        269
      ],
      [
        "tmp_date_diet_only",
        "first_matching_event_clinical_snomed_between(diet_only_snomed, dataset.elig_date_t2dm, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L567",
        "DatePatientSeries",
        567
      ],
      [
        "tmp_out_bin_dm_death",
        "matching_death_between(diabetes_type2_icd10, dataset.elig_date_t2dm, studyend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/dataset_definition_t2dm.py#L561",
        "BoolPatientSeries",
        561
      ]
    ],
    "analysis/superseded/dataset_definition.py": [
      [
        "baseline_date",
        "baseline_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L86",
        "DatePatientSeries",
        86
      ],
      [
        "cov_bin_all_stroke",
        "last_matching_event_clinical_snomed_before(stroke_isch_snomed_clinical + stroke_sah_hs_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(stroke_isch_icd10 + stroke_sah_hs_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L374",
        "unknown",
        374
      ],
      [
        "cov_bin_ami",
        "last_matching_event_clinical_snomed_before(ami_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(ami_prior_icd10 + ami_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L368",
        "unknown",
        368
      ],
      [
        "cov_bin_angina",
        "last_matching_event_clinical_snomed_before(angina_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(angina_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L398",
        "unknown",
        398
      ],
      [
        "cov_bin_cancer",
        "last_matching_event_clinical_snomed_before(cancer_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(cancer_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L410",
        "unknown",
        410
      ],
      [
        "cov_bin_carehome_status",
        "case(when(tmp_care_home_code).then(True), when(tmp_care_home_tpp1).then(True), when(tmp_care_home_tpp2).then(True), when(tmp_care_home_tpp3).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L353",
        "unknown",
        353
      ],
      [
        "cov_bin_chronic_kidney_disease",
        "last_matching_event_clinical_snomed_before(ckd_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(ckd_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L441",
        "unknown",
        441
      ],
      [
        "cov_bin_ckd_45",
        "last_matching_event_clinical_snomed_before(ckd_snomed_clinical_45, baseline_date).exists_for_patient() | last_matching_event_apc_before(ckd_stage4_icd10 + ckd_stage5_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L308",
        "unknown",
        308
      ],
      [
        "cov_bin_copd",
        "last_matching_event_clinical_snomed_before(copd_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(copd_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L429",
        "unknown",
        429
      ],
      [
        "cov_bin_dementia",
        "last_matching_event_clinical_snomed_before(dementia_snomed_clinical + dementia_vascular_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(dementia_icd10 + dementia_vascular_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L404",
        "unknown",
        404
      ],
      [
        "cov_bin_depression",
        "last_matching_event_clinical_snomed_before(depression_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(depression_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L423",
        "unknown",
        423
      ],
      [
        "cov_bin_diabetescomp",
        "last_matching_event_clinical_snomed_before(diabetescomp_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(diabetescomp_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L465",
        "unknown",
        465
      ],
      [
        "cov_bin_gestationaldm",
        "last_matching_event_clinical_ctv3_before(diabetes_gestational_ctv3_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(gestationaldm_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L447",
        "unknown",
        447
      ],
      [
        "cov_bin_hba1c_measurement",
        "last_matching_event_clinical_snomed_before(hba1c_measurement_snomed, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L471",
        "boolean",
        471
      ],
      [
        "cov_bin_healthcare_worker",
        "occupation_on_covid_vaccine_record.where(occupation_on_covid_vaccine_record.is_healthcare_worker == True).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L524",
        "boolean",
        524
      ],
      [
        "cov_bin_hf",
        "last_matching_event_clinical_snomed_before(hf_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(hf_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L392",
        "unknown",
        392
      ],
      [
        "cov_bin_hosp_baseline",
        "apcs.where(apcs.admission_date.is_on_or_between(baseline_date - days(1), baseline_date)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L295",
        "boolean",
        295
      ],
      [
        "cov_bin_hypertension",
        "last_matching_event_clinical_snomed_before(hypertension_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(hypertension_icd10, baseline_date).exists_for_patient() | last_matching_med_dmd_before(hypertension_drugs_dmd, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L416",
        "unknown",
        416
      ],
      [
        "cov_bin_liver_cirrhosis",
        "last_matching_event_clinical_snomed_before(advanced_decompensated_cirrhosis_snomed_clinical + ascitic_drainage_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(advanced_decompensated_cirrhosis_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L314",
        "unknown",
        314
      ],
      [
        "cov_bin_liver_disease",
        "last_matching_event_clinical_snomed_before(liver_disease_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(liver_disease_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L435",
        "unknown",
        435
      ],
      [
        "cov_bin_long_covid",
        "last_matching_event_clinical_snomed_before(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L324",
        "boolean",
        324
      ],
      [
        "cov_bin_metfin_allergy",
        "last_matching_event_clinical_snomed_before(metformin_allergy_snomed_clinical, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L305",
        "boolean",
        305
      ],
      [
        "cov_bin_metfin_before_baseline",
        "last_matching_med_dmd_between(metformin_codes_dmd, baseline_date - days(183), baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L301",
        "boolean",
        301
      ],
      [
        "cov_bin_metfin_interaction",
        "last_matching_med_dmd_between(metformin_interaction_dmd, baseline_date - days(14), baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L320",
        "boolean",
        320
      ],
      [
        "cov_bin_obesity",
        "last_matching_event_clinical_snomed_before(bmi_obesity_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(bmi_obesity_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L362",
        "unknown",
        362
      ],
      [
        "cov_bin_ogtt_measurement",
        "last_matching_event_clinical_snomed_before(ogtt_measurement_snomed, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L474",
        "boolean",
        474
      ],
      [
        "cov_bin_other_arterial_embolism",
        "last_matching_event_clinical_snomed_before(other_arterial_embolism_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(other_arterial_embolism_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L380",
        "unknown",
        380
      ],
      [
        "cov_bin_pcos",
        "last_matching_event_clinical_snomed_before(pcos_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(pcos_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L453",
        "unknown",
        453
      ],
      [
        "cov_bin_prediabetes",
        "tmp_cov_bin_prediabetes | tmp_cov_bin_predm_hba1c_mmol_mol",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L291",
        "unknown",
        291
      ],
      [
        "cov_bin_t1dm",
        "last_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(diabetes_type1_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L459",
        "unknown",
        459
      ],
      [
        "cov_bin_vte",
        "last_matching_event_clinical_snomed_before(portal_vein_thrombosis_snomed_clinical + dvt_dvt_snomed_clinical + dvt_icvt_snomed_clinical + dvt_pregnancy_snomed_clinical + other_dvt_snomed_clinical + pe_snomed_clinical, baseline_date).exists_for_patient() | last_matching_event_apc_before(portal_vein_thrombosis_icd10 + dvt_dvt_icd10 + dvt_icvt_icd10 + dvt_pregnancy_icd10 + other_dvt_icd10 + icvt_pregnancy_icd10 + pe_icd10, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L386",
        "unknown",
        386
      ],
      [
        "cov_cat_bmi_groups",
        "case(when(dataset.cov_num_bmi < 18.5).then('Underweight'), when((dataset.cov_num_bmi >= 18.5) & (dataset.cov_num_bmi < 25.0)).then('Healthy weight (18.5-24.9)'), when((dataset.cov_num_bmi >= 25.0) & (dataset.cov_num_bmi < 30.0)).then('Overweight (25-29.9)'), when((dataset.cov_num_bmi >= 30.0) & (dataset.cov_num_bmi < 70.0)).then('Obese (>30)'), otherwise='missing')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L498",
        "unknown",
        498
      ],
      [
        "cov_cat_deprivation_5",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L153",
        "unknown",
        153
      ],
      [
        "cov_cat_ethnicity",
        "clinical_events.where(clinical_events.ctv3_code.is_in(ethnicity_codes)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(ethnicity_codes)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L144",
        "date",
        144
      ],
      [
        "cov_cat_region",
        "registered.practice_nuts1_region_name",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L166",
        "unknown",
        166
      ],
      [
        "cov_cat_rural_urban",
        "addresses.for_patient_on(baseline_date).rural_urban_classification",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L169",
        "unknown",
        169
      ],
      [
        "cov_cat_sex",
        "patients.sex",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L138",
        "unknown",
        138
      ],
      [
        "cov_cat_smoking_status",
        "case(when(tmp_most_recent_smoking_cat == 'S').then('S'), when(tmp_most_recent_smoking_cat == 'E').then('E'), when((tmp_most_recent_smoking_cat == 'N') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'N').then('N'), when((tmp_most_recent_smoking_cat == 'M') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'M').then('M'), otherwise='M')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L335",
        "unknown",
        335
      ],
      [
        "cov_cat_stp",
        "registered.practice_stp",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L172",
        "unknown",
        172
      ],
      [
        "cov_count_covid_vaccines",
        "vaccinations.where(vaccinations.target_disease.is_in(['SARS-2 CORONAVIRUS'])).where(vaccinations.date.is_on_or_before(baseline_date)).count_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L477",
        "unknown",
        477
      ],
      [
        "cov_date_gestationaldm",
        "last_matching_event_clinical_ctv3_before(diabetes_gestational_ctv3_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L213",
        "unknown",
        213
      ],
      [
        "cov_date_long_covid",
        "last_matching_event_clinical_snomed_before(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L325",
        "unknown",
        325
      ],
      [
        "cov_date_metfin_before_baseline",
        "last_matching_med_dmd_between(metformin_codes_dmd, baseline_date - days(183), baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L302",
        "unknown",
        302
      ],
      [
        "cov_date_metfin_interaction",
        "last_matching_med_dmd_between(metformin_interaction_dmd, baseline_date - days(14), baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L321",
        "unknown",
        321
      ],
      [
        "cov_date_otherdm",
        "last_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L207",
        "unknown",
        207
      ],
      [
        "cov_date_prediabetes",
        "maximum_of(tmp_cov_date_prediabetes, tmp_cov_date_predm_hba1c_mmol_mol)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L278",
        "unknown",
        278
      ],
      [
        "cov_date_recent_covid_vaccines",
        "vaccinations.where(vaccinations.target_disease.is_in(['SARS-2 CORONAVIRUS'])).where(vaccinations.date.is_on_or_before(baseline_date)).sort_by(vaccinations.date).last_for_patient().date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L483",
        "date",
        483
      ],
      [
        "cov_date_t1dm",
        "minimum_of(last_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, baseline_date).date, last_matching_event_apc_before(diabetes_type1_icd10, baseline_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L184",
        "unknown",
        184
      ],
      [
        "cov_date_t2dm",
        "minimum_of(last_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, baseline_date).date, last_matching_event_apc_before(diabetes_type2_icd10, baseline_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L196",
        "unknown",
        196
      ],
      [
        "cov_num_age",
        "patients.age_on(baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L141",
        "unknown",
        141
      ],
      [
        "cov_num_bmi",
        "bmi_measurement.numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L497",
        "unknown",
        497
      ],
      [
        "cov_num_hba1c_mmol_mol",
        "last_matching_event_clinical_snomed_between(hba1c_snomed, baseline_date - days(2 * 366), baseline_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L507",
        "unknown",
        507
      ],
      [
        "exp_bin_10d_metfin",
        "first_matching_med_dmd_between(metformin_codes_dmd, baseline_date, baseline_date + days(10)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L543",
        "boolean",
        543
      ],
      [
        "exp_count_metfin",
        "medications.where(medications.dmd_code.is_in(metformin_codes_dmd)).where(medications.date.is_on_or_after(baseline_date)).count_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L536",
        "unknown",
        536
      ],
      [
        "exp_date_first_metfin",
        "first_matching_med_dmd_between(metformin_codes_dmd, baseline_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L535",
        "unknown",
        535
      ],
      [
        "out_bin_death_cause_covid",
        "case(when(tmp_out_bin_death_cause_covid).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L592",
        "unknown",
        592
      ],
      [
        "out_bin_long_covid",
        "first_matching_event_clinical_snomed_between(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, baseline_date, studyend_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L601",
        "boolean",
        601
      ],
      [
        "out_bin_viral_fatigue",
        "first_matching_event_clinical_snomed_between(post_viral_fatigue_snomed_clinical, baseline_date, studyend_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L604",
        "boolean",
        604
      ],
      [
        "out_date_covid19",
        "minimum_of(dataset.out_date_covid19_primary_care, dataset.out_date_covid19_sgss, dataset.out_date_covid19_hes, dataset.out_date_covid19_emergency)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L585",
        "unknown",
        585
      ],
      [
        "out_date_covid19_emergency",
        "first_matching_event_ec_snomed_between(covid_emergency, baseline_date, studyend_date).arrival_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L568",
        "unknown",
        568
      ],
      [
        "out_date_covid19_hes",
        "first_matching_event_apc_between(covid_codes_incl_clin_diag, baseline_date, studyend_date).admission_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L566",
        "unknown",
        566
      ],
      [
        "out_date_covid19_primary_care",
        "first_matching_event_clinical_ctv3_between(covid_primary_care_code + covid_primary_care_positive_test + covid_primary_care_sequelae, baseline_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L573",
        "unknown",
        573
      ],
      [
        "out_date_covid19_sgss",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(baseline_date, studyend_date)).where(sgss_covid_all_tests.is_positive).sort_by(sgss_covid_all_tests.specimen_taken_date).first_for_patient().specimen_taken_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L575",
        "unknown",
        575
      ],
      [
        "out_date_covid_hosp",
        "minimum_of(dataset.out_date_covid19_hes, dataset.out_date_covid19_emergency)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L570",
        "unknown",
        570
      ],
      [
        "out_date_covid_hosp_death",
        "minimum_of(dataset.out_date_death_cause_covid, dataset.out_date_covid19_hes, dataset.out_date_covid19_emergency)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L598",
        "unknown",
        598
      ],
      [
        "out_date_death_cause_covid",
        "case(when(tmp_out_bin_death_cause_covid).then(ons_deaths.date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L596",
        "date",
        596
      ],
      [
        "out_date_dereg",
        "case(when(tmp_not_dereg == False).then(tmp_dereg_date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L562",
        "unknown",
        562
      ],
      [
        "out_date_long_covid_first",
        "first_matching_event_clinical_snomed_between(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, baseline_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L602",
        "unknown",
        602
      ],
      [
        "out_date_long_fatigue",
        "minimum_of(dataset.out_date_long_covid_first, dataset.out_date_viral_fatigue_first)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L607",
        "unknown",
        607
      ],
      [
        "out_date_viral_fatigue_first",
        "first_matching_event_clinical_snomed_between(post_viral_fatigue_snomed_clinical, baseline_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L605",
        "unknown",
        605
      ],
      [
        "qa_bin_cocp",
        "last_matching_med_dmd_before(cocp_dmd, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L112",
        "BoolPatientSeries",
        112
      ],
      [
        "qa_bin_hrt",
        "last_matching_med_dmd_before(hrt_dmd, baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L115",
        "BoolPatientSeries",
        115
      ],
      [
        "qa_bin_is_female_or_male",
        "patients.sex.is_in(['female', 'male'])",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L94",
        "BoolPatientSeries",
        94
      ],
      [
        "qa_bin_known_imd",
        "addresses.for_patient_on(baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L98",
        "BoolPatientSeries",
        98
      ],
      [
        "qa_bin_pregnancy",
        "clinical_events.where(clinical_events.snomedct_code.is_in(pregnancy_snomed_clinical)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L109",
        "BoolPatientSeries",
        109
      ],
      [
        "qa_bin_prostate_cancer",
        "case(when(prostate_cancer_snomed).then(True), when(prostate_cancer_hes).then(True), when(prostate_cancer_death).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L127",
        "unknown",
        127
      ],
      [
        "qa_bin_was_adult",
        "(patients.age_on(baseline_date) >= 18) & (patients.age_on(baseline_date) <= 110)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L95",
        "BoolPatientSeries",
        95
      ],
      [
        "qa_bin_was_alive",
        "(patients.date_of_death.is_null() | patients.date_of_death.is_after(baseline_date)) & (ons_deaths.date.is_null() | ons_deaths.date.is_after(baseline_date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L96",
        "BoolPatientSeries",
        96
      ],
      [
        "qa_bin_was_registered",
        "practice_registrations.spanning(baseline_date - days(366), baseline_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L99",
        "BoolPatientSeries",
        99
      ],
      [
        "qa_date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "qa_num_birth_year",
        "patients.date_of_birth",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L103",
        "DatePatientSeries",
        103
      ],
      [
        "tmp_cov_count_otherdm",
        "count_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L209",
        "unknown",
        209
      ],
      [
        "tmp_cov_count_poccdm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L219",
        "unknown",
        219
      ],
      [
        "tmp_cov_count_t1dm",
        "dataset.tmp_cov_count_t1dm_ctv3 + dataset.tmp_cov_count_t1dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L191",
        "numeric",
        191
      ],
      [
        "tmp_cov_count_t1dm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L189",
        "unknown",
        189
      ],
      [
        "tmp_cov_count_t1dm_hes",
        "count_matching_event_apc_before(diabetes_type1_icd10, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L190",
        "unknown",
        190
      ],
      [
        "tmp_cov_count_t2dm",
        "dataset.tmp_cov_count_t2dm_ctv3 + dataset.tmp_cov_count_t2dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L203",
        "numeric",
        203
      ],
      [
        "tmp_cov_count_t2dm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L201",
        "unknown",
        201
      ],
      [
        "tmp_cov_count_t2dm_hes",
        "count_matching_event_apc_before(diabetes_type2_icd10, baseline_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L202",
        "unknown",
        202
      ],
      [
        "tmp_cov_date_antidiabetic_drugs_snomed",
        "last_matching_med_dmd_before(antidiabetic_drugs_snomed_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L244",
        "unknown",
        244
      ],
      [
        "tmp_cov_date_diabetes_medication",
        "maximum_of(dataset.tmp_cov_date_insulin_snomed, dataset.tmp_cov_date_antidiabetic_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L248",
        "unknown",
        248
      ],
      [
        "tmp_cov_date_insulin_snomed",
        "last_matching_med_dmd_before(insulin_snomed_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L243",
        "unknown",
        243
      ],
      [
        "tmp_cov_date_latest_diabetes_diag",
        "maximum_of(dataset.cov_date_t2dm, dataset.cov_date_t1dm, dataset.cov_date_otherdm, dataset.cov_date_gestationaldm, dataset.tmp_cov_date_poccdm, dataset.tmp_cov_date_diabetes_medication, dataset.tmp_cov_date_nonmetform_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L251",
        "unknown",
        251
      ],
      [
        "tmp_cov_date_max_hba1c",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(baseline_date)).where(clinical_events.numeric_value == dataset.tmp_cov_num_max_hba1c_mmol_mol).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L231",
        "date",
        231
      ],
      [
        "tmp_cov_date_nonmetform_drugs_snomed",
        "last_matching_med_dmd_before(non_metformin_dmd, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L245",
        "unknown",
        245
      ],
      [
        "tmp_cov_date_poccdm",
        "last_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L217",
        "unknown",
        217
      ],
      [
        "tmp_cov_date_t1dm_ctv3",
        "last_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L183",
        "unknown",
        183
      ],
      [
        "tmp_cov_date_t2dm_ctv3",
        "last_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, baseline_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L195",
        "unknown",
        195
      ],
      [
        "tmp_cov_num_cholesterol",
        "last_matching_event_clinical_snomed_between(cholesterol_snomed, baseline_date - days(2 * 366), baseline_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L510",
        "unknown",
        510
      ],
      [
        "tmp_cov_num_hdl_cholesterol",
        "last_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, baseline_date - days(2 * 366), baseline_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L513",
        "unknown",
        513
      ],
      [
        "tmp_cov_num_max_hba1c_mmol_mol",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(baseline_date)).numeric_value.maximum_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition.py#L224",
        "unknown",
        224
      ]
    ],
    "analysis/superseded/dataset_definition_feasibility.py": [
      [
        "cov_cat_ethnicity",
        "clinical_events.where(clinical_events.ctv3_code.is_in(ethnicity_codes)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(ethnicity_codes)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L67",
        "date",
        67
      ],
      [
        "cov_cat_region",
        "registered.practice_nuts1_region_name",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L60",
        "StrPatientSeries",
        60
      ],
      [
        "cov_cat_sex",
        "patients.sex.is_in(['female', 'male'])",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L55",
        "BoolPatientSeries",
        55
      ],
      [
        "cov_cat_stp",
        "registered.practice_stp",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L61",
        "StrPatientSeries",
        61
      ],
      [
        "cov_date_covid19_first",
        "minimum_of(tmp_covid19_primary_care_date, tmp_covid19_sgss_date, dataset.out_date_severe_covid)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L109",
        "unknown",
        109
      ],
      [
        "cov_date_gestationaldm",
        "first_matching_event_clinical_ctv3_before(diabetes_gestational_ctv3_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L198",
        "unknown",
        198
      ],
      [
        "cov_date_otherdm",
        "first_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L192",
        "unknown",
        192
      ],
      [
        "cov_date_t1dm",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, feasibilityend_date).date, first_matching_event_apc_before(diabetes_type1_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L169",
        "unknown",
        169
      ],
      [
        "cov_date_t2dm",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, feasibilityend_date).date, first_matching_event_apc_before(diabetes_type2_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L181",
        "unknown",
        181
      ],
      [
        "cov_num_age",
        "patients.age_on(landmark_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L57",
        "IntPatientSeries",
        57
      ],
      [
        "elig_date_gestationaldm_original",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_gestational_ctv3_clinical, feasibilityend_date).date, first_matching_event_apc_before(gestationaldm_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L138",
        "unknown",
        138
      ],
      [
        "elig_date_pcos",
        "minimum_of(first_matching_event_clinical_snomed_before(pcos_snomed_clinical, feasibilityend_date).date, first_matching_event_apc_before(pcos_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L143",
        "unknown",
        143
      ],
      [
        "elig_date_t1dm_original",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, feasibilityend_date).date, first_matching_event_apc_before(diabetes_type1_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L133",
        "unknown",
        133
      ],
      [
        "elig_date_t2dm_original",
        "minimum_of(first_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, feasibilityend_date).date, first_matching_event_apc_before(diabetes_type2_icd10, feasibilityend_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L128",
        "unknown",
        128
      ],
      [
        "exp_count_metfin",
        "medications.where(medications.dmd_code.is_in(metformin_codes_dmd)).where(medications.date.is_on_or_before(feasibilityend_date)).count_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L117",
        "unknown",
        117
      ],
      [
        "exp_date_metfin_first",
        "first_matching_med_dmd_before(metformin_codes_dmd, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L116",
        "unknown",
        116
      ],
      [
        "out_date_covid19_emergency_first",
        "first_matching_event_ec_snomed_before(covid_emergency, feasibilityend_date).arrival_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L86",
        "unknown",
        86
      ],
      [
        "out_date_covid19_hes_first",
        "first_matching_event_apc_before(covid_codes_incl_clin_diag, feasibilityend_date).admission_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L83",
        "unknown",
        83
      ],
      [
        "out_date_death_covid",
        "case(when(tmp_out_bin_death_covid).then(ons_deaths.date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L81",
        "date",
        81
      ],
      [
        "out_date_fatigue_first",
        "first_matching_event_clinical_snomed_before(post_viral_fatigue_snomed_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L94",
        "unknown",
        94
      ],
      [
        "out_date_long_covid_first",
        "first_matching_event_clinical_snomed_before(long_covid_diagnostic_snomed_clinical + long_covid_referral_snomed_clinical + long_covid_assessment_snomed_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L92",
        "unknown",
        92
      ],
      [
        "out_date_long_fatigue",
        "minimum_of(dataset.out_date_long_covid_first, dataset.out_date_fatigue_first)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L96",
        "unknown",
        96
      ],
      [
        "out_date_severe_covid",
        "minimum_of(dataset.out_date_death_covid, dataset.out_date_covid19_hes_first, dataset.out_date_covid19_emergency_first)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L89",
        "unknown",
        89
      ],
      [
        "qa_date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L65",
        "DatePatientSeries",
        65
      ],
      [
        "qa_num_birth_year",
        "patients.date_of_birth",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L63",
        "DatePatientSeries",
        63
      ],
      [
        "tmp_cov_count_otherdm",
        "count_matching_event_clinical_ctv3_before(diabetes_other_ctv3_clinical, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L194",
        "unknown",
        194
      ],
      [
        "tmp_cov_count_poccdm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L204",
        "unknown",
        204
      ],
      [
        "tmp_cov_count_t1dm",
        "dataset.tmp_cov_count_t1dm_ctv3 + dataset.tmp_cov_count_t1dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L176",
        "numeric",
        176
      ],
      [
        "tmp_cov_count_t1dm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L174",
        "unknown",
        174
      ],
      [
        "tmp_cov_count_t1dm_hes",
        "count_matching_event_apc_before(diabetes_type1_icd10, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L175",
        "unknown",
        175
      ],
      [
        "tmp_cov_count_t2dm",
        "dataset.tmp_cov_count_t2dm_ctv3 + dataset.tmp_cov_count_t2dm_hes",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L188",
        "numeric",
        188
      ],
      [
        "tmp_cov_count_t2dm_ctv3",
        "count_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L186",
        "unknown",
        186
      ],
      [
        "tmp_cov_count_t2dm_hes",
        "count_matching_event_apc_before(diabetes_type2_icd10, feasibilityend_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L187",
        "unknown",
        187
      ],
      [
        "tmp_cov_date_antidiabetic_drugs_snomed",
        "first_matching_med_dmd_before(antidiabetic_drugs_snomed_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L229",
        "unknown",
        229
      ],
      [
        "tmp_cov_date_diabetes_medication",
        "minimum_of(dataset.tmp_cov_date_insulin_snomed, dataset.tmp_cov_date_antidiabetic_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L233",
        "unknown",
        233
      ],
      [
        "tmp_cov_date_first_diabetes_diag",
        "minimum_of(dataset.cov_date_t2dm, dataset.cov_date_t1dm, dataset.cov_date_otherdm, dataset.cov_date_gestationaldm, dataset.tmp_cov_date_poccdm, dataset.tmp_cov_date_diabetes_medication, dataset.tmp_cov_date_nonmetform_drugs_snomed)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L236",
        "unknown",
        236
      ],
      [
        "tmp_cov_date_insulin_snomed",
        "first_matching_med_dmd_before(insulin_snomed_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L228",
        "unknown",
        228
      ],
      [
        "tmp_cov_date_max_hba1c",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(feasibilityend_date)).where(clinical_events.numeric_value == dataset.tmp_cov_num_max_hba1c_mmol_mol).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L216",
        "date",
        216
      ],
      [
        "tmp_cov_date_nonmetform_drugs_snomed",
        "first_matching_med_dmd_before(non_metformin_dmd, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L230",
        "unknown",
        230
      ],
      [
        "tmp_cov_date_poccdm",
        "first_matching_event_clinical_ctv3_before(diabetes_diagnostic_ctv3_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L202",
        "unknown",
        202
      ],
      [
        "tmp_cov_date_t1dm_ctv3",
        "first_matching_event_clinical_ctv3_before(diabetes_type1_ctv3_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L168",
        "unknown",
        168
      ],
      [
        "tmp_cov_date_t2dm_ctv3",
        "first_matching_event_clinical_ctv3_before(diabetes_type2_ctv3_clinical, feasibilityend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L180",
        "unknown",
        180
      ],
      [
        "tmp_cov_num_max_hba1c_mmol_mol",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hba1c_snomed)).where(clinical_events.date.is_on_or_before(feasibilityend_date)).numeric_value.maximum_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_feasibility.py#L209",
        "unknown",
        209
      ]
    ],
    "analysis/superseded/dataset_definition_landmark.py": [
      [
        "cov_bin_all_stroke",
        "last_matching_event_clinical_snomed_before(stroke_isch_snomed_clinical + stroke_sah_hs_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(stroke_isch_icd10 + stroke_sah_hs_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L245",
        "BoolPatientSeries",
        245
      ],
      [
        "cov_bin_ami",
        "last_matching_event_clinical_snomed_before(ami_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(ami_prior_icd10 + ami_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L239",
        "BoolPatientSeries",
        239
      ],
      [
        "cov_bin_angina",
        "last_matching_event_clinical_snomed_before(angina_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(angina_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L269",
        "BoolPatientSeries",
        269
      ],
      [
        "cov_bin_cancer",
        "last_matching_event_clinical_snomed_before(cancer_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(cancer_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L281",
        "BoolPatientSeries",
        281
      ],
      [
        "cov_bin_carehome_status",
        "case(when(tmp_care_home_code).then(True), when(tmp_care_home_tpp1).then(True), when(tmp_care_home_tpp2).then(True), when(tmp_care_home_tpp3).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L211",
        "BoolPatientSeries",
        211
      ],
      [
        "cov_bin_chronic_kidney_disease",
        "last_matching_event_clinical_snomed_before(ckd_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(ckd_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L311",
        "BoolPatientSeries",
        311
      ],
      [
        "cov_bin_copd",
        "last_matching_event_clinical_snomed_before(copd_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(copd_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L299",
        "BoolPatientSeries",
        299
      ],
      [
        "cov_bin_dementia",
        "last_matching_event_clinical_snomed_before(dementia_snomed_clinical + dementia_vascular_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(dementia_icd10 + dementia_vascular_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L275",
        "BoolPatientSeries",
        275
      ],
      [
        "cov_bin_depression",
        "last_matching_event_clinical_snomed_before(depression_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(depression_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L293",
        "BoolPatientSeries",
        293
      ],
      [
        "cov_bin_diabetescomp",
        "last_matching_event_clinical_snomed_before(diabetescomp_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(diabetescomp_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L337",
        "BoolPatientSeries",
        337
      ],
      [
        "cov_bin_healthcare_worker",
        "occupation_on_covid_vaccine_record.where(occupation_on_covid_vaccine_record.is_healthcare_worker == True).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L372",
        "BoolPatientSeries",
        372
      ],
      [
        "cov_bin_hf",
        "last_matching_event_clinical_snomed_before(hf_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(hf_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L263",
        "BoolPatientSeries",
        263
      ],
      [
        "cov_bin_hypertension",
        "last_matching_event_clinical_snomed_before(hypertension_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(hypertension_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L287",
        "BoolPatientSeries",
        287
      ],
      [
        "cov_bin_liver_disease",
        "last_matching_event_clinical_snomed_before(liver_disease_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(liver_disease_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L305",
        "BoolPatientSeries",
        305
      ],
      [
        "cov_bin_obesity",
        "last_matching_event_clinical_snomed_before(bmi_obesity_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(bmi_obesity_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L233",
        "BoolPatientSeries",
        233
      ],
      [
        "cov_bin_other_arterial_embolism",
        "last_matching_event_clinical_snomed_before(other_arterial_embolism_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(other_arterial_embolism_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L251",
        "BoolPatientSeries",
        251
      ],
      [
        "cov_bin_pcos",
        "last_matching_event_clinical_snomed_before(pcos_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(pcos_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L317",
        "BoolPatientSeries",
        317
      ],
      [
        "cov_bin_prediabetes",
        "tmp_cov_bin_prediabetes | tmp_cov_bin_predm_hba1c_mmol_mol",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L334",
        "BoolPatientSeries",
        334
      ],
      [
        "cov_bin_vte",
        "last_matching_event_clinical_snomed_before(portal_vein_thrombosis_snomed_clinical + dvt_dvt_snomed_clinical + dvt_icvt_snomed_clinical + dvt_pregnancy_snomed_clinical + other_dvt_snomed_clinical + pe_snomed_clinical, pandemicstart_date).exists_for_patient() | last_matching_event_apc_before(portal_vein_thrombosis_icd10 + dvt_dvt_icd10 + dvt_icvt_icd10 + dvt_pregnancy_icd10 + other_dvt_icd10 + icvt_pregnancy_icd10 + pe_icd10, pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L257",
        "BoolPatientSeries",
        257
      ],
      [
        "cov_cat_bmi_groups",
        "case(when(dataset.cov_num_bmi < 18.5).then('Underweight'), when((dataset.cov_num_bmi >= 18.5) & (dataset.cov_num_bmi < 25.0)).then('Healthy weight (18.5-24.9)'), when((dataset.cov_num_bmi >= 25.0) & (dataset.cov_num_bmi < 30.0)).then('Overweight (25-29.9)'), when((dataset.cov_num_bmi >= 30.0) & (dataset.cov_num_bmi < 70.0)).then('Obese (>30)'), otherwise='missing')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L354",
        "StrPatientSeries",
        354
      ],
      [
        "cov_cat_deprivation_5",
        "case(when((imd_rounded >= 0) & (imd_rounded < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd_rounded < int(32844 * 2 / 5)).then('2'), when(imd_rounded < int(32844 * 3 / 5)).then('3'), when(imd_rounded < int(32844 * 4 / 5)).then('4'), when(imd_rounded < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L171",
        "StrPatientSeries",
        171
      ],
      [
        "cov_cat_region",
        "registered.practice_nuts1_region_name",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L183",
        "StrPatientSeries",
        183
      ],
      [
        "cov_cat_region_mid2018",
        "registered_mid2018.practice_nuts1_region_name",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L184",
        "StrPatientSeries",
        184
      ],
      [
        "cov_cat_rural_urban",
        "addresses.for_patient_on(pandemicstart_date).rural_urban_classification",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L187",
        "IntPatientSeries",
        187
      ],
      [
        "cov_cat_rural_urban_mid2018",
        "addresses.for_patient_on(mid2018_date).rural_urban_classification",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L188",
        "IntPatientSeries",
        188
      ],
      [
        "cov_cat_sex",
        "patients.sex",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L164",
        "StrPatientSeries",
        164
      ],
      [
        "cov_cat_smoking_status",
        "case(when(tmp_most_recent_smoking_cat == 'S').then('S'), when(tmp_most_recent_smoking_cat == 'E').then('E'), when((tmp_most_recent_smoking_cat == 'N') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'N').then('N'), when((tmp_most_recent_smoking_cat == 'M') & (tmp_ever_smoked == True)).then('E'), when(tmp_most_recent_smoking_cat == 'M').then('M'), otherwise='M')",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L193",
        "StrPatientSeries",
        193
      ],
      [
        "cov_cat_stp",
        "registered.practice_stp",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L185",
        "StrPatientSeries",
        185
      ],
      [
        "cov_cat_stp_mid2018",
        "registered_mid2018.practice_stp",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L186",
        "StrPatientSeries",
        186
      ],
      [
        "cov_date_agi_last",
        "last_matching_med_dmd_before(agi_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L229",
        "DatePatientSeries",
        229
      ],
      [
        "cov_date_dpp4_last",
        "last_matching_med_dmd_before(dpp4_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L221",
        "DatePatientSeries",
        221
      ],
      [
        "cov_date_glp1_last",
        "last_matching_med_dmd_before(glp1_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L227",
        "DatePatientSeries",
        227
      ],
      [
        "cov_date_insulin_last",
        "last_matching_med_dmd_before(insulin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L230",
        "DatePatientSeries",
        230
      ],
      [
        "cov_date_megli_last",
        "last_matching_med_dmd_before(meglitinides_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L228",
        "DatePatientSeries",
        228
      ],
      [
        "cov_date_sglt2_last",
        "last_matching_med_dmd_before(sglt2_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L225",
        "DatePatientSeries",
        225
      ],
      [
        "cov_date_sulfo_last",
        "last_matching_med_dmd_before(sulfonylurea_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L220",
        "DatePatientSeries",
        220
      ],
      [
        "cov_date_tzd_last",
        "last_matching_med_dmd_before(tzd_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L223",
        "DatePatientSeries",
        223
      ],
      [
        "cov_num_age",
        "patients.age_on(pandemicstart_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L167",
        "IntPatientSeries",
        167
      ],
      [
        "cov_num_bmi",
        "bmi_measurement.numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L353",
        "FloatPatientSeries",
        353
      ],
      [
        "cov_num_hba1c_mmol_mol",
        "last_matching_event_clinical_snomed_between(hba1c_snomed, pandemicstart_date - days(2 * 366), pandemicstart_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L363",
        "FloatPatientSeries",
        363
      ],
      [
        "elig_date_ckd_45_first",
        "minimum_of(first_matching_event_clinical_snomed_before(ckd_snomed_clinical_45, pandemicstart_date).date, first_matching_event_apc_before(ckd_stage4_icd10 + ckd_stage5_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L116",
        "DatePatientSeries",
        116
      ],
      [
        "elig_date_ckd_45_last",
        "maximum_of(last_matching_event_clinical_snomed_before(ckd_snomed_clinical_45, pandemicstart_date).date, last_matching_event_apc_before(ckd_stage4_icd10 + ckd_stage5_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L112",
        "DatePatientSeries",
        112
      ],
      [
        "elig_date_liver_cirrhosis_first",
        "minimum_of(first_matching_event_clinical_snomed_before(advanced_decompensated_cirrhosis_snomed_clinical + ascitic_drainage_snomed_clinical, pandemicstart_date).date, first_matching_event_apc_before(advanced_decompensated_cirrhosis_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L126",
        "DatePatientSeries",
        126
      ],
      [
        "elig_date_liver_cirrhosis_last",
        "maximum_of(last_matching_event_clinical_snomed_before(advanced_decompensated_cirrhosis_snomed_clinical + ascitic_drainage_snomed_clinical, pandemicstart_date).date, last_matching_event_apc_before(advanced_decompensated_cirrhosis_icd10, pandemicstart_date).admission_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L122",
        "DatePatientSeries",
        122
      ],
      [
        "elig_date_metfin_allergy_first",
        "first_matching_event_clinical_snomed_before(metformin_allergy_snomed_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L109",
        "DatePatientSeries",
        109
      ],
      [
        "elig_date_metfin_allergy_last",
        "last_matching_event_clinical_snomed_before(metformin_allergy_snomed_clinical, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L108",
        "DatePatientSeries",
        108
      ],
      [
        "elig_date_metfin_interaction_first",
        "first_matching_med_dmd_before(metformin_interaction_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L133",
        "DatePatientSeries",
        133
      ],
      [
        "elig_date_metfin_interaction_last",
        "last_matching_med_dmd_before(metformin_interaction_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L132",
        "DatePatientSeries",
        132
      ],
      [
        "exp_date_agi_first",
        "first_matching_med_dmd_before(agi_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L155",
        "DatePatientSeries",
        155
      ],
      [
        "exp_date_dpp4_first",
        "first_matching_med_dmd_before(dpp4_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L147",
        "DatePatientSeries",
        147
      ],
      [
        "exp_date_dpp4_mono_first",
        "first_matching_med_dmd_before(dpp4_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L148",
        "DatePatientSeries",
        148
      ],
      [
        "exp_date_glp1_first",
        "first_matching_med_dmd_before(glp1_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L153",
        "DatePatientSeries",
        153
      ],
      [
        "exp_date_insulin_first",
        "first_matching_med_dmd_before(insulin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L156",
        "DatePatientSeries",
        156
      ],
      [
        "exp_date_megli_first",
        "first_matching_med_dmd_before(meglitinides_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L154",
        "DatePatientSeries",
        154
      ],
      [
        "exp_date_metfin_first",
        "first_matching_med_dmd_before(metformin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L142",
        "DatePatientSeries",
        142
      ],
      [
        "exp_date_metfin_last",
        "last_matching_med_dmd_before(metformin_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L139",
        "DatePatientSeries",
        139
      ],
      [
        "exp_date_metfin_mono_first",
        "first_matching_med_dmd_before(metformin_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L143",
        "DatePatientSeries",
        143
      ],
      [
        "exp_date_metfin_mono_last",
        "last_matching_med_dmd_before(metformin_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L140",
        "DatePatientSeries",
        140
      ],
      [
        "exp_date_sglt2_first",
        "first_matching_med_dmd_before(sglt2_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L151",
        "DatePatientSeries",
        151
      ],
      [
        "exp_date_sglt2_mono_first",
        "first_matching_med_dmd_before(sglt2_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L152",
        "DatePatientSeries",
        152
      ],
      [
        "exp_date_sulfo_first",
        "first_matching_med_dmd_before(sulfonylurea_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L146",
        "DatePatientSeries",
        146
      ],
      [
        "exp_date_tzd_first",
        "first_matching_med_dmd_before(tzd_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L149",
        "DatePatientSeries",
        149
      ],
      [
        "exp_date_tzd_mono_first",
        "first_matching_med_dmd_before(tzd_mono_dmd, pandemicstart_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L150",
        "DatePatientSeries",
        150
      ],
      [
        "out_date_agi_first",
        "first_matching_med_dmd_between(agi_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L396",
        "DatePatientSeries",
        396
      ],
      [
        "out_date_covid19",
        "minimum_of(tmp_covid19_primary_care_date, tmp_covid19_sgss_date, dataset.out_date_covid19_hosp)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L431",
        "DatePatientSeries",
        431
      ],
      [
        "out_date_covid19_death",
        "case(when(tmp_out_bin_death_covid).then(ons_deaths.date))",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L435",
        "DatePatientSeries",
        435
      ],
      [
        "out_date_covid19_emergency",
        "first_matching_event_ec_snomed_between(covid_emergency, pandemicstart_date, studyend_date).arrival_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L416",
        "DatePatientSeries",
        416
      ],
      [
        "out_date_covid19_hes",
        "first_matching_event_apc_between(covid_codes_incl_clin_diag, pandemicstart_date, studyend_date, only_prim_diagnoses=True).admission_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L414",
        "DatePatientSeries",
        414
      ],
      [
        "out_date_covid19_hosp",
        "minimum_of(dataset.out_date_covid19_hes, dataset.out_date_covid19_emergency)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L418",
        "DatePatientSeries",
        418
      ],
      [
        "out_date_covid19_severe",
        "minimum_of(dataset.out_date_covid19_death, dataset.out_date_covid19_hosp)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L437",
        "DatePatientSeries",
        437
      ],
      [
        "out_date_dereg_mid2018",
        "registered_mid2018.end_date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L403",
        "DatePatientSeries",
        403
      ],
      [
        "out_date_dpp4_first",
        "first_matching_med_dmd_between(dpp4_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L388",
        "DatePatientSeries",
        388
      ],
      [
        "out_date_glp1_first",
        "first_matching_med_dmd_between(glp1_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L394",
        "DatePatientSeries",
        394
      ],
      [
        "out_date_insulin_first",
        "first_matching_med_dmd_between(insulin_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L397",
        "DatePatientSeries",
        397
      ],
      [
        "out_date_megli_first",
        "first_matching_med_dmd_between(meglitinides_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L395",
        "DatePatientSeries",
        395
      ],
      [
        "out_date_metfin_first",
        "first_matching_med_dmd_between(metformin_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L383",
        "DatePatientSeries",
        383
      ],
      [
        "out_date_metfin_mono_first",
        "first_matching_med_dmd_between(metformin_mono_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L384",
        "DatePatientSeries",
        384
      ],
      [
        "out_date_sglt2_first",
        "first_matching_med_dmd_between(sglt2_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L392",
        "DatePatientSeries",
        392
      ],
      [
        "out_date_sulfo_first",
        "first_matching_med_dmd_between(sulfonylurea_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L387",
        "DatePatientSeries",
        387
      ],
      [
        "out_date_tzd_first",
        "first_matching_med_dmd_between(tzd_dmd, pandemicstart_date, studyend_date).date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L390",
        "DatePatientSeries",
        390
      ],
      [
        "qa_bin_cocp",
        "medications.where(medications.dmd_code.is_in(cocp_dmd)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L76",
        "BoolPatientSeries",
        76
      ],
      [
        "qa_bin_hrt",
        "medications.where(medications.dmd_code.is_in(hrt_dmd)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L79",
        "BoolPatientSeries",
        79
      ],
      [
        "qa_bin_is_female_or_male",
        "patients.sex.is_in(['female', 'male'])",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L61",
        "BoolPatientSeries",
        61
      ],
      [
        "qa_bin_known_imd",
        "addresses.for_patient_on(pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L65",
        "BoolPatientSeries",
        65
      ],
      [
        "qa_bin_pregnancy",
        "clinical_events.where(clinical_events.snomedct_code.is_in(pregnancy_snomed_clinical)).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L73",
        "BoolPatientSeries",
        73
      ],
      [
        "qa_bin_prostate_cancer",
        "case(when(prostate_cancer_snomed).then(True), when(prostate_cancer_hes).then(True), when(prostate_cancer_death).then(True), otherwise=False)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L91",
        "BoolPatientSeries",
        91
      ],
      [
        "qa_bin_was_adult",
        "(patients.age_on(pandemicstart_date) >= 18) & (patients.age_on(pandemicstart_date) <= 110)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L62",
        "BoolPatientSeries",
        62
      ],
      [
        "qa_bin_was_alive",
        "patients.is_alive_on(pandemicstart_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L63",
        "BoolPatientSeries",
        63
      ],
      [
        "qa_bin_was_alive_mid2018",
        "patients.is_alive_on(mid2018_date)",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L64",
        "BoolPatientSeries",
        64
      ],
      [
        "qa_bin_was_registered",
        "practice_registrations.spanning(pandemicstart_date - days(366), pandemicstart_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L66",
        "BoolPatientSeries",
        66
      ],
      [
        "qa_bin_was_registered_mid2018",
        "practice_registrations.spanning(mid2018_date - days(366), mid2018_date).exists_for_patient()",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L67",
        "BoolPatientSeries",
        67
      ],
      [
        "qa_date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L70",
        "DatePatientSeries",
        70
      ],
      [
        "tmp_cov_num_cholesterol",
        "last_matching_event_clinical_snomed_between(cholesterol_snomed, pandemicstart_date - days(2 * 366), pandemicstart_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L366",
        "FloatPatientSeries",
        366
      ],
      [
        "tmp_cov_num_hdl_cholesterol",
        "last_matching_event_clinical_snomed_between(hdl_cholesterol_snomed, pandemicstart_date - days(2 * 366), pandemicstart_date).numeric_value",
        "https://github.com/opensafely/metformin_covid/blob/58e4fcb57c7d60c45df16b8bfb01c0aeda8f776a/analysis/superseded/dataset_definition_landmark.py#L369",
        "FloatPatientSeries",
        369
      ]
    ]
  },
  "open-pathology": {
    "analysis/dataset_definition.py": [
      [
        "numerator",
        "numerator",
        "https://github.com/opensafely/open-pathology/blob/2d8a3006542d7a9e288daff8b84900bdb87af637/analysis/dataset_definition.py#L214",
        "BoolPatientSeries",
        214
      ]
    ]
  },
  "open-pathology-sdr": {
    "analysis/dataset_definition.py": [
      [
        "has_test_value",
        "codelist_events.where(has_test_value).count_for_patient()",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/dataset_definition.py#L40",
        "IntPatientSeries",
        40
      ],
      [
        "has_zero_value",
        "codelist_events.where(has_zero_value).count_for_patient()",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/dataset_definition.py#L41",
        "IntPatientSeries",
        41
      ]
    ],
    "analysis/proxy_null_analysis/value_dataset_definition.py": [
      [
        "codelist_event_count",
        "codelist_events.count_for_patient()",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/proxy_null_analysis/value_dataset_definition.py#L32",
        "IntPatientSeries",
        32
      ],
      [
        "codelist_event_exists",
        "codelist_events.exists_for_patient()",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/proxy_null_analysis/value_dataset_definition.py#L33",
        "BoolPatientSeries",
        33
      ],
      [
        "lower_bound",
        "codelist_events.sort_by(codelist_events.date).first_for_patient().lower_bound",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/proxy_null_analysis/value_dataset_definition.py#L36",
        "FloatPatientSeries",
        36
      ],
      [
        "numeric_value",
        "codelist_events.sort_by(codelist_events.date).first_for_patient().numeric_value",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/proxy_null_analysis/value_dataset_definition.py#L34",
        "FloatPatientSeries",
        34
      ],
      [
        "upper_bound",
        "codelist_events.sort_by(codelist_events.date).first_for_patient().upper_bound",
        "https://github.com/opensafely/open-pathology-sdr/blob/e1b54ba7a78e735da350b71a170b30c5d1fa38b6/analysis/proxy_null_analysis/value_dataset_definition.py#L35",
        "FloatPatientSeries",
        35
      ]
    ]
  },
  "opioids-data-curation": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/opioids-data-curation/blob/7078e61ca8962ffcac8073f24786c063cb9e9ae6/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "paxlovid-test": {
    "analysis/dataset_definition.py": [
      [
        "august",
        "paxlovid_prescriptions_between('2023-08-01', '2023-08-31')",
        "https://github.com/opensafely/paxlovid-test/blob/79a6ae7067a59084f45ad12f12ee685993e3eb8b/analysis/dataset_definition.py#L24",
        "IntPatientSeries",
        24
      ],
      [
        "july",
        "paxlovid_prescriptions_between('2023-07-01', '2023-07-31')",
        "https://github.com/opensafely/paxlovid-test/blob/79a6ae7067a59084f45ad12f12ee685993e3eb8b/analysis/dataset_definition.py#L23",
        "IntPatientSeries",
        23
      ],
      [
        "june",
        "paxlovid_prescriptions_between('2023-06-01', '2023-06-30')",
        "https://github.com/opensafely/paxlovid-test/blob/79a6ae7067a59084f45ad12f12ee685993e3eb8b/analysis/dataset_definition.py#L22",
        "IntPatientSeries",
        22
      ],
      [
        "may",
        "paxlovid_prescriptions_between('2023-05-01', '2023-05-31')",
        "https://github.com/opensafely/paxlovid-test/blob/79a6ae7067a59084f45ad12f12ee685993e3eb8b/analysis/dataset_definition.py#L21",
        "IntPatientSeries",
        21
      ]
    ]
  },
  "pharmacy-first": {
    "analysis/dataset_definition_tables.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L45",
        "IntPatientSeries",
        45
      ],
      [
        "age_band",
        "get_age_band(patients, index_date)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L46",
        "StrPatientSeries",
        46
      ],
      [
        "ethnicity",
        "get_latest_ethnicity(index_date, clinical_events, codelists.ethnicity_group16_codelist, ethnicity_from_sus, grouping=16)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L49",
        "StrPatientSeries",
        49
      ],
      [
        "has_pf_consultation",
        "pf_consultation_events.exists_for_patient()",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L36",
        "BoolPatientSeries",
        36
      ],
      [
        "imd",
        "get_imd(addresses, index_date)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L48",
        "StrPatientSeries",
        48
      ],
      [
        "impetigo_numerator",
        "has_event(selected_pf_id_events, codelists.impetigo_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L81",
        "BoolPatientSeries",
        81
      ],
      [
        "insectbite_numerator",
        "has_event(selected_pf_id_events, codelists.insectbite_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L65",
        "BoolPatientSeries",
        65
      ],
      [
        "otitismedia_numerator",
        "has_event(selected_pf_id_events, codelists.otitismedia_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L69",
        "BoolPatientSeries",
        69
      ],
      [
        "region",
        "registration.practice_nuts1_region_name",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L47",
        "StrPatientSeries",
        47
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L44",
        "StrPatientSeries",
        44
      ],
      [
        "shingles_numerator",
        "has_event(selected_pf_id_events, codelists.shingles_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L77",
        "BoolPatientSeries",
        77
      ],
      [
        "sinusitis_numerator",
        "has_event(selected_pf_id_events, codelists.sinusitis_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L61",
        "BoolPatientSeries",
        61
      ],
      [
        "sorethroat_numerator",
        "has_event(selected_pf_id_events, codelists.sorethroat_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L73",
        "BoolPatientSeries",
        73
      ],
      [
        "uti_numerator",
        "has_event(selected_pf_id_events, codelists.uti_code)",
        "https://github.com/opensafely/pharmacy-first/blob/a40c829cde27c458ae1dba5165b428fcec569ae6/analysis/dataset_definition_tables.py#L57",
        "BoolPatientSeries",
        57
      ]
    ]
  },
  "pifu-data-exploration": {
    "analysis/dataset_definition_explore.py": [
      [
        "any_opa",
        "first_opa.exists_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L66",
        "BoolPatientSeries",
        66
      ],
      [
        "attendance_status",
        "first_opa.attendance_status",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L69",
        "StrPatientSeries",
        69
      ],
      [
        "consultation_medium_used",
        "first_opa.consultation_medium_used",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L70",
        "StrPatientSeries",
        70
      ],
      [
        "count_all",
        "total_opa.count_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L40",
        "IntPatientSeries",
        40
      ],
      [
        "count_all_attended",
        "attended_opa.count_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L41",
        "IntPatientSeries",
        41
      ],
      [
        "count_rheum",
        "rheum_opa.count_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L42",
        "IntPatientSeries",
        42
      ],
      [
        "count_rheum_attended",
        "rheum_attended_opa.count_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L43",
        "IntPatientSeries",
        43
      ],
      [
        "count_same_day",
        "total_opa_date.count_episodes_for_patient(days(0))",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L35",
        "IntPatientSeries",
        35
      ],
      [
        "count_same_day_attended",
        "attended_opa_date.count_episodes_for_patient(days(0))",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L36",
        "IntPatientSeries",
        36
      ],
      [
        "count_same_day_rheum",
        "rheum_opa_date.count_episodes_for_patient(days(0))",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L37",
        "IntPatientSeries",
        37
      ],
      [
        "count_same_day_rheum_attended",
        "rheum_attended_opa_date.count_episodes_for_patient(days(0))",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L38",
        "IntPatientSeries",
        38
      ],
      [
        "first_attendance",
        "first_opa.first_attendance",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L71",
        "StrPatientSeries",
        71
      ],
      [
        "outcome_of_attendance",
        "first_opa.outcome_of_attendance",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L67",
        "StrPatientSeries",
        67
      ],
      [
        "pfu",
        "first_pfu.exists_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L72",
        "BoolPatientSeries",
        72
      ],
      [
        "rheum_any_opa",
        "first_rheum_opa.exists_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L74",
        "BoolPatientSeries",
        74
      ],
      [
        "rheum_attendance_status",
        "first_rheum_opa.attendance_status",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L77",
        "StrPatientSeries",
        77
      ],
      [
        "rheum_consultation_medium_used",
        "first_rheum_opa.consultation_medium_used",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L78",
        "StrPatientSeries",
        78
      ],
      [
        "rheum_first_attendance",
        "first_rheum_opa.first_attendance",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L79",
        "StrPatientSeries",
        79
      ],
      [
        "rheum_outcome_of_attendance",
        "first_rheum_opa.outcome_of_attendance",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L75",
        "StrPatientSeries",
        75
      ],
      [
        "rheum_pfu",
        "first_rheum_pfu.exists_for_patient()",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L80",
        "BoolPatientSeries",
        80
      ],
      [
        "rheum_rrr_date",
        "first_rheum_opa.referral_request_received_date",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L86",
        "DatePatientSeries",
        86
      ],
      [
        "rheum_rrr_year",
        "dataset.rheum_rrr_date.year",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L87",
        "IntPatientSeries",
        87
      ],
      [
        "rheum_treatment_function_code",
        "first_rheum_opa.treatment_function_code",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L76",
        "StrPatientSeries",
        76
      ],
      [
        "rrr_date",
        "first_opa.referral_request_received_date",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L83",
        "DatePatientSeries",
        83
      ],
      [
        "rrr_year",
        "dataset.rrr_date.year",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L84",
        "IntPatientSeries",
        84
      ],
      [
        "treatment_function_code",
        "first_opa.treatment_function_code",
        "https://github.com/opensafely/pifu-data-exploration/blob/52481d5366590c38b29b458f625f7db017fac6f6/analysis/dataset_definition_explore.py#L68",
        "StrPatientSeries",
        68
      ]
    ]
  },
  "polypharmacy-deprescribing-dementia": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L27",
        "IntPatientSeries",
        27
      ],
      [
        "ethnicity",
        "ethnicity_from_sus.code",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L48",
        "StrPatientSeries",
        48
      ],
      [
        "imd",
        "addresses.for_patient_on(index_date).imd_rounded",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L46",
        "IntPatientSeries",
        46
      ],
      [
        "latest_alzheimers_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(alzheimers_codelist)).where(clinical_events.date.is_on_or_before(end_date)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L34",
        "CodePatientSeries",
        34
      ],
      [
        "latest_dementia_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(dementia_codelist)).where(clinical_events.date.is_on_or_before(end_date)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L28",
        "CodePatientSeries",
        28
      ],
      [
        "latest_vascular_dementia_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(vascular_dementia_codelist)).where(clinical_events.date.is_on_or_before(end_date)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L39",
        "CodePatientSeries",
        39
      ],
      [
        "region",
        "practice_registrations.for_patient_on(index_date).practice_nuts1_region_name",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L47",
        "StrPatientSeries",
        47
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/polypharmacy-deprescribing-dementia/blob/f07420b95420ea6d87d327b1dbe63eaa58746ee7/analysis/dataset_definition.py#L26",
        "StrPatientSeries",
        26
      ]
    ]
  },
  "post-covid-cvd": {
    "analysis/dataset_definition/dataset_definition_dates.py": [
      [
        "end_prevax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date, dataset.vax_date_covid_1, dataset.vax_date_eligible, all_eligible)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L69",
        "DatePatientSeries",
        69
      ],
      [
        "end_prevax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "end_unvax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date, omicron_date, dataset.vax_date_covid_1)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L127",
        "DatePatientSeries",
        127
      ],
      [
        "end_unvax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L135",
        "DatePatientSeries",
        135
      ],
      [
        "end_vax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date, omicron_date)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L99",
        "DatePatientSeries",
        99
      ],
      [
        "end_vax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "index_prevax",
        "minimum_of(date.fromisoformat(pandemic_start), date.fromisoformat(pandemic_start))",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "index_unvax",
        "maximum_of(dataset.vax_date_eligible + days(84), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L114",
        "DatePatientSeries",
        114
      ],
      [
        "index_vax",
        "maximum_of(dataset.vax_date_covid_2 + days(14), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-cvd/blob/319569889629f5d5476754851e0762a0ff1500cd/analysis/dataset_definition/dataset_definition_dates.py#L86",
        "DatePatientSeries",
        86
      ]
    ]
  },
  "post-covid-cvd-methods": {
    "analysis/dataset_definition/dataset_definition_dates.py": [
      [
        "end_prevax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date, dataset.vax_date_covid_1, dataset.vax_date_eligible, all_eligible)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L69",
        "DatePatientSeries",
        69
      ],
      [
        "end_prevax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "end_unvax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date, omicron_date, dataset.vax_date_covid_1)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L127",
        "DatePatientSeries",
        127
      ],
      [
        "end_unvax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L135",
        "DatePatientSeries",
        135
      ],
      [
        "end_vax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date, omicron_date)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L99",
        "DatePatientSeries",
        99
      ],
      [
        "end_vax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date)",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "index_prevax",
        "minimum_of(date.fromisoformat(pandemic_start), date.fromisoformat(pandemic_start))",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "index_unvax",
        "maximum_of(dataset.vax_date_eligible + days(84), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L114",
        "DatePatientSeries",
        114
      ],
      [
        "index_vax",
        "maximum_of(dataset.vax_date_covid_2 + days(14), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-cvd-methods/blob/e4c2ab76a765af3ad20aae3d11b6f1a6f7446ee3/analysis/dataset_definition/dataset_definition_dates.py#L86",
        "DatePatientSeries",
        86
      ]
    ]
  },
  "post-covid-neurodegenerative": {
    "analysis/dataset_definition/dataset_definition_dates.py": [
      [
        "end_prevax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date, dataset.vax_date_covid_1, dataset.vax_date_eligible, all_eligible)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L69",
        "DatePatientSeries",
        69
      ],
      [
        "end_prevax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "end_unvax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date, omicron_date, dataset.vax_date_covid_1)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L127",
        "DatePatientSeries",
        127
      ],
      [
        "end_unvax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L135",
        "DatePatientSeries",
        135
      ],
      [
        "end_vax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date, omicron_date)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L99",
        "DatePatientSeries",
        99
      ],
      [
        "end_vax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date)",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "index_prevax",
        "minimum_of(date.fromisoformat(pandemic_start), date.fromisoformat(pandemic_start))",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "index_unvax",
        "maximum_of(dataset.vax_date_eligible + days(84), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L114",
        "DatePatientSeries",
        114
      ],
      [
        "index_vax",
        "maximum_of(dataset.vax_date_covid_2 + days(14), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-neurodegenerative/blob/4339d23ecc5a52511f76fda4fda7041ea946180a/analysis/dataset_definition/dataset_definition_dates.py#L86",
        "DatePatientSeries",
        86
      ]
    ]
  },
  "post-covid-renal": {
    "analysis/dataset_definition/dataset_definition_dates.py": [
      [
        "end_prevax_exposure",
        "minimum_of(dataset.cens_date_death, dataset.vax_date_covid_1, dataset.vax_date_eligible, all_eligible)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L58",
        "DatePatientSeries",
        58
      ],
      [
        "end_prevax_outcome",
        "minimum_of(dataset.cens_date_death, lcd_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L65",
        "DatePatientSeries",
        65
      ],
      [
        "end_unvax_exposure",
        "minimum_of(dataset.cens_date_death, omicron_date, dataset.vax_date_covid_1)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L94",
        "DatePatientSeries",
        94
      ],
      [
        "end_unvax_outcome",
        "minimum_of(dataset.cens_date_death, lcd_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L100",
        "DatePatientSeries",
        100
      ],
      [
        "end_vax_exposure",
        "minimum_of(dataset.cens_date_death, omicron_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L77",
        "DatePatientSeries",
        77
      ],
      [
        "end_vax_outcome",
        "minimum_of(dataset.cens_date_death, lcd_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L82",
        "DatePatientSeries",
        82
      ],
      [
        "index_prevax",
        "minimum_of(pandemic_start, pandemic_start)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L56",
        "StrPatientSeries",
        56
      ],
      [
        "index_unvax",
        "maximum_of(dataset.vax_date_eligible + days(84), delta_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L89",
        "DatePatientSeries",
        89
      ],
      [
        "index_vax",
        "maximum_of(dataset.vax_date_covid_2 + days(14), delta_date)",
        "https://github.com/opensafely/post-covid-renal/blob/762c573da42482a4dea5f23958a46459f33e848c/analysis/dataset_definition/dataset_definition_dates.py#L72",
        "DatePatientSeries",
        72
      ]
    ]
  },
  "post-covid-respiratory": {
    "analysis/dataset_definition/dataset_definition_dates.py": [
      [
        "end_prevax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date, dataset.vax_date_covid_1, dataset.vax_date_eligible, all_eligible)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L69",
        "DatePatientSeries",
        69
      ],
      [
        "end_prevax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_prevax, lcd_date)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "end_unvax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date, omicron_date, dataset.vax_date_covid_1)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L127",
        "DatePatientSeries",
        127
      ],
      [
        "end_unvax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_unvax, lcd_date)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L135",
        "DatePatientSeries",
        135
      ],
      [
        "end_vax_exposure",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date, omicron_date)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L99",
        "DatePatientSeries",
        99
      ],
      [
        "end_vax_outcome",
        "minimum_of(dataset.cens_date_death, cens_date_dereg_vax, lcd_date)",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L106",
        "DatePatientSeries",
        106
      ],
      [
        "index_prevax",
        "minimum_of(date.fromisoformat(pandemic_start), date.fromisoformat(pandemic_start))",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "index_unvax",
        "maximum_of(dataset.vax_date_eligible + days(84), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L114",
        "DatePatientSeries",
        114
      ],
      [
        "index_vax",
        "maximum_of(dataset.vax_date_covid_2 + days(14), date.fromisoformat(delta_date))",
        "https://github.com/opensafely/post-covid-respiratory/blob/1ac9f401639f0d15b602b8820651a260dc7463a1/analysis/dataset_definition/dataset_definition_dates.py#L86",
        "DatePatientSeries",
        86
      ]
    ]
  },
  "post-covid-vax-autoimmune": {
    "analysis/dataset_definition.py": [
      [
        "antiphos",
        "clinical_events.where(clinical_events.snomedct_code.is_in(as_code_snomed)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L363",
        "DatePatientSeries",
        363
      ],
      [
        "antiphos_hist",
        "clinical_events.where(clinical_events.snomedct_code.is_in(as_code_snomed) & clinical_events.date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L621",
        "BoolPatientSeries",
        621
      ],
      [
        "apla_anaem",
        "minimum_of(apa_primary_date, apa_secondary_date1, apa_secondary_date2)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L484",
        "DatePatientSeries",
        484
      ],
      [
        "aplast_anaem_hist",
        "clinical_events.where((clinical_events.snomedct_code.is_in(apa_code_snomed) | clinical_events.ctv3_code.is_in(apa_code_ctv)) & clinical_events.date.is_before(start_date)).exists_for_patient() | apcs.where((apcs.primary_diagnosis.is_in(apa_code_icd) | apcs.secondary_diagnosis.is_in(apa_code_icd)) & apcs.admission_date.is_before(start_date)).exists_for_patient() | opa_diag.where((opa_diag.primary_diagnosis_code.is_in(apa_code_icd) | opa_diag.secondary_diagnosis_code_1.is_in(apa_code_icd)) & opa_diag.appointment_date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L727",
        "BoolPatientSeries",
        727
      ],
      [
        "carehome_resident",
        "addresses.for_patient_on(start_date).care_home_is_potential_match | addresses.for_patient_on(start_date).care_home_requires_nursing | addresses.for_patient_on(start_date).care_home_does_not_require_nursing",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L127",
        "BoolPatientSeries",
        127
      ],
      [
        "composite_ai_outcome",
        "minimum_of(dataset.grp1_outcome, dataset.grp2_outcome, dataset.grp3_outcome, dataset.grp4_outcome, dataset.grp5_outcome, dataset.grp6_outcome, dataset.grp7_outcome, dataset.grp8_outcome)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L524",
        "DatePatientSeries",
        524
      ],
      [
        "composite_ai_outcome_hist",
        "dataset.grp1_outcome_hist | dataset.grp2_outcome_hist | dataset.grp3_outcome_hist | dataset.grp4_outcome_hist | dataset.grp5_outcome_hist | dataset.grp6_outcome_hist | dataset.grp7_outcome_hist | dataset.grp8_outcome_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L780",
        "BoolPatientSeries",
        780
      ],
      [
        "consultation_rate",
        "appointments.where(appointments.status.is_in(['Arrived', 'In Progress', 'Finished', 'Visit', 'Waiting', 'Patient Walked Out']) & appointments.start_date.is_on_or_between(start_date - days(365), start_date)).count_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L99",
        "IntPatientSeries",
        99
      ],
      [
        "covid19_date",
        "minimum_of(covid19_primarycare_date, covid19_secondarycare_date1, covid19_secondarycare_date2)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L259",
        "DatePatientSeries",
        259
      ],
      [
        "date_deregistered",
        "practice_registrations.sort_by(practice_registrations.end_date).last_for_patient().end_date",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L67",
        "DatePatientSeries",
        67
      ],
      [
        "date_registered",
        "practice_registrations.sort_by(practice_registrations.start_date).last_for_patient().start_date",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L66",
        "DatePatientSeries",
        66
      ],
      [
        "death_date",
        "ons_deaths.date",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L73",
        "DatePatientSeries",
        73
      ],
      [
        "diabetes",
        "clinical_events.where(clinical_events.ctv3_code.is_in(diabetes_type1_snomed_clinical + diabetes_type2_snomed_clinical + diabetes_diagnostic_snomed_clinical + diabetes_other_snomed_clinical + diabetes_gestational_snomed_clinical) & clinical_events.date.is_before(start_date)).exists_for_patient() | medications.where((medications.dmd_code.is_in(insulin_snomed_clinical) | medications.dmd_code.is_in(antidiabetic_drugs_snomed_clinical) | medications.dmd_code.is_in(non_metformin_dmd)) & medications.date.is_before(start_date)).exists_for_patient() | apcs.where((apcs.primary_diagnosis.is_in(diabetes_type1_icd10) | apcs.primary_diagnosis.is_in(diabetes_type2_icd10) | apcs.secondary_diagnosis.is_in(diabetes_type1_icd10) | apcs.secondary_diagnosis.is_in(diabetes_type2_icd10)) & apcs.admission_date.is_before(start_date)).exists_for_patient() | opa_diag.where((opa_diag.primary_diagnosis_code.is_in(diabetes_type1_icd10) | opa_diag.primary_diagnosis_code.is_in(diabetes_type2_icd10) | opa_diag.secondary_diagnosis_code_1.is_in(diabetes_type1_icd10) | opa_diag.secondary_diagnosis_code_1.is_in(diabetes_type2_icd10)) & opa_diag.appointment_date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L197",
        "BoolPatientSeries",
        197
      ],
      [
        "dob",
        "patients.date_of_birth",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L70",
        "DatePatientSeries",
        70
      ],
      [
        "ethnicity",
        "clinical_events.where(clinical_events.ctv3_code.is_in(opensafely_ethnicity_codes_6)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(opensafely_ethnicity_codes_6)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L79",
        "StrPatientSeries",
        79
      ],
      [
        "grp1_outcome",
        "minimum_of(dataset.rheu_arth, dataset.undiff_eia, dataset.psor_arth, dataset.axial_arth)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L341",
        "DatePatientSeries",
        341
      ],
      [
        "grp1_outcome_hist",
        "dataset.rheu_arth_hist | dataset.undiff_eia_hist | dataset.psor_arth_hist | dataset.axial_arth_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L598",
        "BoolPatientSeries",
        598
      ],
      [
        "grp2_outcome",
        "minimum_of(dataset.sle, dataset.sjogren, dataset.sys_scler, dataset.infl_myos, dataset.mctd, dataset.antiphos)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L368",
        "DatePatientSeries",
        368
      ],
      [
        "grp2_outcome_hist",
        "dataset.sle_hist | dataset.sjogren_hist | dataset.sys_scle_hist | dataset.infl_myo_hist | dataset.mctd_hist | dataset.antiphos_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L629",
        "BoolPatientSeries",
        629
      ],
      [
        "grp3_outcome",
        "minimum_of(dataset.psoriasis, dataset.hydra_supp)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L383",
        "DatePatientSeries",
        383
      ],
      [
        "grp3_outcome_hist",
        "dataset.psoriasis_hist | dataset.hydra_supp_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L645",
        "BoolPatientSeries",
        645
      ],
      [
        "grp4_outcome",
        "minimum_of(dataset.crohn, dataset.ulc_col, dataset.celiac, dataset.ibd)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L417",
        "DatePatientSeries",
        417
      ],
      [
        "grp4_outcome_hist",
        "dataset.crohn_hist | dataset.ulc_col_hist | dataset.celiac_hist | dataset.ibd_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L679",
        "BoolPatientSeries",
        679
      ],
      [
        "grp5_outcome",
        "minimum_of(dataset.addison, dataset.grave, dataset.hashimoto)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L435",
        "DatePatientSeries",
        435
      ],
      [
        "grp5_outcome_hist",
        "dataset.addison_hist | dataset.grave_hist | dataset.hashimoto_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L695",
        "BoolPatientSeries",
        695
      ],
      [
        "grp6_outcome",
        "minimum_of(dataset.anca, dataset.gca, dataset.iga_vasc, dataset.poly_rheu)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L454",
        "DatePatientSeries",
        454
      ],
      [
        "grp6_outcome_hist",
        "dataset.anca_hist | dataset.gca_hist | dataset.iga_vasc_hist | dataset.pmr_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L714",
        "BoolPatientSeries",
        714
      ],
      [
        "grp7_outcome",
        "minimum_of(dataset.immu_thromb, dataset.pern_anaem, dataset.apla_anaem, dataset.auto_haem_anaem)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L492",
        "DatePatientSeries",
        492
      ],
      [
        "grp7_outcome_hist",
        "dataset.imm_thromb_hist | dataset.pern_anaem_hist | dataset.aplast_anaem_hist | dataset.auto_haem_anaem_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L749",
        "BoolPatientSeries",
        749
      ],
      [
        "grp8_outcome",
        "minimum_of(dataset.gui_bar, dataset.multi_scler, dataset.myas_grav, dataset.long_myel, dataset.cis)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L517",
        "DatePatientSeries",
        517
      ],
      [
        "grp8_outcome_hist",
        "dataset.guil_bar_hist | dataset.mult_scler_hist | dataset.myas_grav_hist | dataset.long_myel_hist | dataset.clin_isol_hist",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L772",
        "BoolPatientSeries",
        772
      ],
      [
        "healthcare_worker",
        "occupation_on_covid_vaccine_record.where(occupation_on_covid_vaccine_record.is_healthcare_worker == True).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L122",
        "BoolPatientSeries",
        122
      ],
      [
        "hypertension",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hypertension_snomed_clinical) & clinical_events.date.is_before(start_date)).exists_for_patient() | medications.where(medications.dmd_code.is_in(hypertension_drugs_dmd) & medications.date.is_before(start_date)).exists_for_patient() | apcs.where((apcs.primary_diagnosis.is_in(hypertension_icd10) | apcs.secondary_diagnosis.is_in(hypertension_icd10)) & apcs.admission_date.is_before(start_date)).exists_for_patient() | opa_diag.where((opa_diag.primary_diagnosis_code.is_in(hypertension_icd10) | opa_diag.secondary_diagnosis_code_1.is_in(hypertension_icd10)) & opa_diag.appointment_date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L175",
        "BoolPatientSeries",
        175
      ],
      [
        "ibd",
        "minimum_of(ibd_primary_date, ibd_secondary_date1, ibd_secondary_date2)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L412",
        "DatePatientSeries",
        412
      ],
      [
        "ibd_hist",
        "clinical_events.where((clinical_events.snomedct_code.is_in(ibd_code_snomed) | clinical_events.ctv3_code.is_in(ibd_code_ctv3)) & clinical_events.date.is_before(start_date)).exists_for_patient() | apcs.where((apcs.primary_diagnosis.is_in(ibd_code_icd) | apcs.secondary_diagnosis.is_in(ibd_code_icd)) & apcs.admission_date.is_before(start_date)).exists_for_patient() | opa_diag.where((opa_diag.primary_diagnosis_code.is_in(ibd_code_icd) | opa_diag.secondary_diagnosis_code_1.is_in(ibd_code_icd)) & opa_diag.appointment_date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L660",
        "BoolPatientSeries",
        660
      ],
      [
        "imd_decile",
        "imd_decile",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L90",
        "StrPatientSeries",
        90
      ],
      [
        "region",
        "region",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L96",
        "StrPatientSeries",
        96
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L76",
        "StrPatientSeries",
        76
      ],
      [
        "smoking_status",
        "clinical_events.where(clinical_events.ctv3_code.is_in(smoking_clear)).where(clinical_events.date.is_before(start_date)).sort_by(clinical_events.date).last_for_patient().ctv3_code.to_category(smoking_clear)",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L111",
        "StrPatientSeries",
        111
      ],
      [
        "undiff_eia",
        "clinical_events.where(clinical_events.snomedct_code.is_in(undiff_eia_code_snomed)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L330",
        "DatePatientSeries",
        330
      ],
      [
        "undiff_eia_hist",
        "clinical_events.where(clinical_events.snomedct_code.is_in(undiff_eia_code_snomed) & clinical_events.date.is_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/post-covid-vax-autoimmune/blob/5756bdf68a189c6f20c89726f69c9d34d017e040/analysis/dataset_definition.py#L585",
        "BoolPatientSeries",
        585
      ]
    ]
  },
  "post-infection-outcomes": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/post-infection-outcomes/blob/a1d03050c09f3ccb3e309150409585d2b3323575/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "prophy_effects_Sotro_Molnup": {
    "analysis/dataset_definition.py": [
      [
        "age_sstart",
        "patients.age_on('2021-12-16')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1008",
        "IntPatientSeries",
        1008
      ],
      [
        "age_sstart_group",
        "case(when(dataset.age_sstart < 30).then('18-29'), when(dataset.age_sstart < 40).then('30-39'), when(dataset.age_sstart < 50).then('40-49'), when(dataset.age_sstart < 60).then('50-59'), when(dataset.age_sstart < 70).then('60-69'), when(dataset.age_sstart < 80).then('70-79'), when(dataset.age_sstart < 90).then('80-89'), when(dataset.age_sstart >= 90).then('90+'), otherwise='unknown')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1009",
        "StrPatientSeries",
        1009
      ],
      [
        "age_treated",
        "patients.age_on(treat_date)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1022",
        "IntPatientSeries",
        1022
      ],
      [
        "age_treated_group",
        "case(when(dataset.age_treated < 30).then('18-29'), when(dataset.age_treated < 40).then('30-39'), when(dataset.age_treated < 50).then('40-49'), when(dataset.age_treated < 60).then('50-59'), when(dataset.age_treated < 70).then('60-69'), when(dataset.age_treated < 80).then('70-79'), when(dataset.age_treated < 90).then('80-89'), when(dataset.age_treated >= 90).then('90+'), otherwise='unknown')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1023",
        "StrPatientSeries",
        1023
      ],
      [
        "allcause_death_60d_12m",
        "case(when(dataset.was_allcause_death_60d_12m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L324",
        "IntPatientSeries",
        324
      ],
      [
        "allcause_death_60d_24m",
        "case(when(dataset.was_allcause_death_60d_24m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L334",
        "IntPatientSeries",
        334
      ],
      [
        "allcause_death_60d_6m",
        "case(when(dataset.was_allcause_death_60d_6m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L314",
        "IntPatientSeries",
        314
      ],
      [
        "allcause_death_under30d",
        "case(when(dataset.was_allcause_death_under30d).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L377",
        "IntPatientSeries",
        377
      ],
      [
        "allcause_death_under60d",
        "case(when(dataset.was_allcause_death_under60d).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L369",
        "IntPatientSeries",
        369
      ],
      [
        "bmi",
        "bmi_record.numeric_value",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1139",
        "FloatPatientSeries",
        1139
      ],
      [
        "bmi_date",
        "bmi_record.date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1140",
        "DatePatientSeries",
        1140
      ],
      [
        "cancer_opensafely_snomed",
        "c_events_bf6m.where(c_events_bf6m.snomedct_code.is_in(non_haematological_cancer_opensafely_snomed_codes) | c_events_bf6m.snomedct_code.is_in(lung_cancer_opensafely_snomed_codes) | c_events_bf6m.snomedct_code.is_in(chemotherapy_radiotherapy_opensafely_snomed_codes)).sort_by(c_events_bf6m.date).last_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L858",
        "DatePatientSeries",
        858
      ],
      [
        "cancer_opensafely_snomed_ever",
        "c_events_bf_treat.where(c_events_bf_treat.snomedct_code.is_in(non_haematological_cancer_opensafely_snomed_codes_new) | c_events_bf_treat.snomedct_code.is_in(lung_cancer_opensafely_snomed_codes) | c_events_bf_treat.snomedct_code.is_in(chemotherapy_radiotherapy_opensafely_snomed_codes)).sort_by(c_events_bf_treat.date).last_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L870",
        "DatePatientSeries",
        870
      ],
      [
        "cancer_opensafely_snomed_new",
        "c_events_bf6m.where(c_events_bf6m.snomedct_code.is_in(non_haematological_cancer_opensafely_snomed_codes_new) | c_events_bf6m.snomedct_code.is_in(lung_cancer_opensafely_snomed_codes) | c_events_bf6m.snomedct_code.is_in(chemotherapy_radiotherapy_opensafely_snomed_codes)).sort_by(c_events_bf6m.date).last_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L864",
        "DatePatientSeries",
        864
      ],
      [
        "care_home_primis",
        "carehome",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1097",
        "BoolPatientSeries",
        1097
      ],
      [
        "ccare_covid60d6m_date",
        "apcs.where(apcs.primary_diagnosis.is_in(covid_icd10_codes) & apcs.admission_date.is_after(treat_date + days(60)) & apcs.admission_date.is_on_or_before(treat_date + days(60) + months(6)) & apcs.patient_classification.is_in(['1']) & apcs.admission_method.is_in(['21', '22', '23', '24', '25', '2A', '2B', '2C', '2D', '28']) & (apcs.days_in_critical_care > 0)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L244",
        "DatePatientSeries",
        244
      ],
      [
        "ccare_covid_first_af_treat_alldiag_date",
        "apcs_admis_af_treat_alldiag_firstdate(codelist=covid_icd10_codes, where=apcs.admission_method.is_in(['21', '22', '23', '24', '25', '2A', '2B', '2C', '2D', '28']) & (apcs.days_in_critical_care > 0))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L997",
        "DatePatientSeries",
        997
      ],
      [
        "covid_death_60d_12m",
        "case(when(dataset.was_covid_death_60d_12m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L352",
        "IntPatientSeries",
        352
      ],
      [
        "covid_death_60d_24m",
        "case(when(dataset.was_covid_death_60d_24m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L361",
        "IntPatientSeries",
        361
      ],
      [
        "covid_death_60d_6m",
        "case(when(dataset.was_covid_death_60d_6m).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L343",
        "IntPatientSeries",
        343
      ],
      [
        "covid_vacc1_date",
        "covid_vacc.first_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1154",
        "DatePatientSeries",
        1154
      ],
      [
        "covid_vacc2_date",
        "covid_vacc.where(covid_vacc.date.is_after(dataset.covid_vacc1_date + days(19))).sort_by(covid_vacc.date).first_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1156",
        "DatePatientSeries",
        1156
      ],
      [
        "covid_vacc3_date",
        "covid_vacc.where(covid_vacc.date.is_after(dataset.covid_vacc2_date + days(56))).sort_by(covid_vacc.date).first_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1159",
        "DatePatientSeries",
        1159
      ],
      [
        "covid_vacc4_date",
        "covid_vacc.where(covid_vacc.date.is_after(dataset.covid_vacc3_date + days(56))).sort_by(covid_vacc.date).first_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1162",
        "DatePatientSeries",
        1162
      ],
      [
        "covid_vacc_last_date",
        "covid_vacc.last_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1165",
        "DatePatientSeries",
        1165
      ],
      [
        "date_of_first_admis_af_treat",
        "apcs.where(apcs.admission_date.is_after(treat_date)).sort_by(apcs.admission_date).first_for_patient().admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L145",
        "DatePatientSeries",
        145
      ],
      [
        "death_cause_covid",
        "cause_of_death_matches(covid_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L306",
        "BoolPatientSeries",
        306
      ],
      [
        "dereg_date",
        "regd_end.end_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1124",
        "DatePatientSeries",
        1124
      ],
      [
        "dereg_date1",
        "de_reg.end_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1130",
        "DatePatientSeries",
        1130
      ],
      [
        "dialysis",
        "case(when(dataset.had_dialysis).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L615",
        "IntPatientSeries",
        615
      ],
      [
        "dialysis_ctv3",
        "had_c_event_ctv3snome_lastdate(dialysis_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L562",
        "DatePatientSeries",
        562
      ],
      [
        "dialysis_icd10",
        "had_apcs_diag_icd10_lastdate(dialysis_icd10_codelist)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L563",
        "DatePatientSeries",
        563
      ],
      [
        "dialysis_procedure",
        "apcs_proc_bf_treat_lastdate(codelist=dialysis_opcs4_codelist)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L611",
        "DatePatientSeries",
        611
      ],
      [
        "dob",
        "patients.date_of_birth",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1004",
        "DatePatientSeries",
        1004
      ],
      [
        "dod",
        "patients.date_of_death",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1005",
        "DatePatientSeries",
        1005
      ],
      [
        "drug",
        "case(when(dataset.first_covid_treat_interve.is_in(['Sotrovimab'])).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L84",
        "IntPatientSeries",
        84
      ],
      [
        "end_date_12mon",
        "dataset.treat_date + days(60) + months(12)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L92",
        "DatePatientSeries",
        92
      ],
      [
        "end_date_24mon",
        "dataset.treat_date + days(60) + months(24)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L93",
        "DatePatientSeries",
        93
      ],
      [
        "end_date_6mon",
        "dataset.treat_date + days(60) + months(6)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L89",
        "DatePatientSeries",
        89
      ],
      [
        "ethnicity",
        "case(when((latest_ethnicity_group == '1') | latest_ethnicity_group.is_null() & ethnicity_sus.is_in(['A', 'B', 'C'])).then('White'), when((latest_ethnicity_group == '2') | latest_ethnicity_group.is_null() & ethnicity_sus.is_in(['D', 'E', 'F', 'G'])).then('Mixed'), when((latest_ethnicity_group == '3') | latest_ethnicity_group.is_null() & ethnicity_sus.is_in(['H', 'J', 'K', 'L'])).then('Asian or Asian British'), when((latest_ethnicity_group == '4') | latest_ethnicity_group.is_null() & ethnicity_sus.is_in(['M', 'N', 'P'])).then('Black or Black British'), when((latest_ethnicity_group == '5') | latest_ethnicity_group.is_null() & ethnicity_sus.is_in(['R', 'S'])).then('Chinese or Other Ethnic Groups'), otherwise='unknown')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1054",
        "StrPatientSeries",
        1054
      ],
      [
        "first_covid_treat_interve",
        "had_covid_m_s_treat_df.intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L82",
        "StrPatientSeries",
        82
      ],
      [
        "first_covid_treat_status",
        "had_covid_m_s_treat_df.current_status",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L83",
        "StrPatientSeries",
        83
      ],
      [
        "first_molnupiravir_date",
        "first_molnupiravir.treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L134",
        "DatePatientSeries",
        134
      ],
      [
        "first_molnupiravir_interve",
        "first_molnupiravir.intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L136",
        "StrPatientSeries",
        136
      ],
      [
        "first_molnupiravir_status",
        "first_molnupiravir.current_status",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L135",
        "StrPatientSeries",
        135
      ],
      [
        "first_sotrovimab_date",
        "first_sotrovimab.treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L140",
        "DatePatientSeries",
        140
      ],
      [
        "first_sotrovimab_interve",
        "first_sotrovimab.intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L142",
        "StrPatientSeries",
        142
      ],
      [
        "first_sotrovimab_status",
        "first_sotrovimab.current_status",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L141",
        "StrPatientSeries",
        141
      ],
      [
        "had_autism",
        "had_c_event_snome_exist(codelist=autism_nhsd_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1195",
        "BoolPatientSeries",
        1195
      ],
      [
        "had_ccare_covid60d12m",
        "ccare_60d_12m_covid_pdiag",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L234",
        "BoolPatientSeries",
        234
      ],
      [
        "had_ccare_covid60d24m",
        "ccare_60d_24m_covid_pdiag",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L240",
        "BoolPatientSeries",
        240
      ],
      [
        "had_ccare_covid60d6m",
        "ccare_af60d_covid_pdiag",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L229",
        "BoolPatientSeries",
        229
      ],
      [
        "had_ccare_covid_bf30d",
        "ccare_bf30d_covid_pdiag",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L214",
        "BoolPatientSeries",
        214
      ],
      [
        "had_ccare_covid_bf60d",
        "ccare_bf60d_covid_pdiag",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L222",
        "BoolPatientSeries",
        222
      ],
      [
        "had_chronic_cardiac_disease",
        "had_c_event_snome_exist(codelist=chronic_cardiac_dis_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1190",
        "BoolPatientSeries",
        1190
      ],
      [
        "had_chronic_respiratory_disease",
        "had_c_event_snome_exist(codelist=chronic_respiratory_dis_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1193",
        "BoolPatientSeries",
        1193
      ],
      [
        "had_dementia",
        "dataset.had_dementia_poten & (dataset.age_treated > 39)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1206",
        "BoolPatientSeries",
        1206
      ],
      [
        "had_dementia_poten",
        "had_c_event_snome_exist(codelist=dementia_nhsd_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1204",
        "BoolPatientSeries",
        1204
      ],
      [
        "had_diabetes",
        "had_c_event_snome_exist(codelist=diabetes_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1186",
        "BoolPatientSeries",
        1186
      ],
      [
        "had_dialysis",
        "(dataset.dialysis_ctv3 <= treat_date) | (dataset.dialysis_icd10 <= treat_date) | (dataset.dialysis_procedure <= treat_date)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L614",
        "BoolPatientSeries",
        614
      ],
      [
        "had_first_covid_treat",
        "had_first_covid_treat",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L81",
        "BoolPatientSeries",
        81
      ],
      [
        "had_haema_disease",
        "dataset.haematological_disease_nhsd <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L831",
        "BoolPatientSeries",
        831
      ],
      [
        "had_haema_disease_ever",
        "dataset.haematological_disease_nhsd_ever <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L836",
        "BoolPatientSeries",
        836
      ],
      [
        "had_housebound",
        "(dataset.housebound_lastdate > dataset.no_longer_housebound_lastdate) & (dataset.housebound_lastdate > dataset.moved_into_care_home_lastdate)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1223",
        "BoolPatientSeries",
        1223
      ],
      [
        "had_housebound_poten",
        "had_c_event_snome_exist(codelist=housebound_opensafely_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1211",
        "BoolPatientSeries",
        1211
      ],
      [
        "had_hypertension",
        "had_c_event_snome_exist(codelist=hypertension_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1188",
        "BoolPatientSeries",
        1188
      ],
      [
        "had_imid",
        "(dataset.oral_steroid_drugs_nhsd < dataset.immunosuppresant_drugs_nhsd) & (dataset.oral_steroid_drugs_nhsd <= treat_date) & (dataset.oral_steroid_drug_nhsd_3m_count >= 2) & (dataset.oral_steroid_drug_nhsd_12m_count >= 4) | (dataset.oral_steroid_drugs_nhsd > dataset.immunosuppresant_drugs_nhsd) & (dataset.immunosuppresant_drugs_nhsd <= treat_date)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L520",
        "BoolPatientSeries",
        520
      ],
      [
        "had_imid_ever",
        "(dataset.immunosuppresant_drugs_nhsd_ever <= treat_date) & (dataset.immunosuppresant_drugs_nhsd_ever > treat_date - days(365)) | (dataset.oral_steroid_drugs_nhsd_ever <= treat_date) & (dataset.oral_steroid_drugs_nhsd_ever > treat_date - days(365))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L524",
        "BoolPatientSeries",
        524
      ],
      [
        "had_immunosupression",
        "dataset.immunosupression_nhsd <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L847",
        "BoolPatientSeries",
        847
      ],
      [
        "had_immunosupression_new",
        "dataset.immunosupression_nhsd_new <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L852",
        "BoolPatientSeries",
        852
      ],
      [
        "had_kidney_transplant",
        "(dataset.kidney_transplant_ctv3 <= treat_date) | (dataset.kidney_transplant_icd10 <= treat_date) | (dataset.kidney_transplant_procedure <= treat_date)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L627",
        "BoolPatientSeries",
        627
      ],
      [
        "had_learning_disability",
        "had_c_event_snome_exist(codelist=wider_ld_primis_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1198",
        "BoolPatientSeries",
        1198
      ],
      [
        "had_moved_into_care_home",
        "had_c_event_snome_exist(codelist=care_home_primis_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1219",
        "BoolPatientSeries",
        1219
      ],
      [
        "had_no_longer_housebound",
        "had_c_event_snome_exist(codelist=no_longer_housebound_opensafely_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1215",
        "BoolPatientSeries",
        1215
      ],
      [
        "had_serious_mental_illness",
        "had_c_event_snome_exist(codelist=serious_mental_illness_nhsd_snomed_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1201",
        "BoolPatientSeries",
        1201
      ],
      [
        "had_solid_cancer",
        "dataset.cancer_opensafely_snomed <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L876",
        "BoolPatientSeries",
        876
      ],
      [
        "had_solid_cancer_ever",
        "dataset.cancer_opensafely_snomed_ever <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L886",
        "BoolPatientSeries",
        886
      ],
      [
        "had_solid_cancer_new",
        "dataset.cancer_opensafely_snomed_new <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L881",
        "BoolPatientSeries",
        881
      ],
      [
        "had_solid_organ_transplant",
        "dataset.solid_organ_transplant_nhsd <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L743",
        "BoolPatientSeries",
        743
      ],
      [
        "had_solid_organ_transplant_new",
        "dataset.solid_organ_transplant_nhsd_new <= treat_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L749",
        "BoolPatientSeries",
        749
      ],
      [
        "haema_disease",
        "case(when(dataset.had_haema_disease).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L832",
        "IntPatientSeries",
        832
      ],
      [
        "haema_disease_ever",
        "case(when(dataset.had_haema_disease_ever).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L837",
        "IntPatientSeries",
        837
      ],
      [
        "haematological_disease_nhsd",
        "minimum_of(dataset.haematopoietic_stem_cell_snomed, dataset.haematopoietic_stem_cell_icd10, dataset.haematopoietic_stem_cell_opcs4, dataset.haematological_malignancies_snomed, dataset.haematological_malignancies_icd10, dataset.sickle_cell_disease_nhsd_snomed, dataset.sickle_cell_disease_nhsd_icd10)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L813",
        "DatePatientSeries",
        813
      ],
      [
        "haematological_disease_nhsd_ever",
        "minimum_of(dataset.haematopoietic_stem_cell_snomed_ever, dataset.haematopoietic_stem_cell_icd10_ever, dataset.haematopoietic_stem_cell_opcs4_ever, dataset.haematological_malignancies_snomed_ever, dataset.haematological_malignancies_icd10_ever, dataset.sickle_cell_disease_nhsd_snomed, dataset.sickle_cell_disease_nhsd_icd10)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L822",
        "DatePatientSeries",
        822
      ],
      [
        "haematological_malignancies_icd10",
        "had_apcs_diag_icd10_lastdate(dt=apcs_diags_bf24m, codelist=haematological_malignancies_nhsd_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L784",
        "DatePatientSeries",
        784
      ],
      [
        "haematological_malignancies_icd10_ever",
        "had_apcs_diag_icd10_lastdate(codelist=haematological_malignancies_nhsd_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L809",
        "DatePatientSeries",
        809
      ],
      [
        "haematological_malignancies_snomed",
        "had_c_event_ctv3snome_lastdate(dt=c_events_bf24m, codelist=haematological_malignancies_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L780",
        "DatePatientSeries",
        780
      ],
      [
        "haematological_malignancies_snomed_ever",
        "had_c_event_ctv3snome_lastdate(codelist=haematological_malignancies_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L805",
        "DatePatientSeries",
        805
      ],
      [
        "haematopoietic_stem_cell_icd10",
        "had_apcs_diag_icd10_lastdate(dt=apcs_diags_bf12m, codelist=haematopoietic_stem_cell_transplant_nhsd_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L763",
        "DatePatientSeries",
        763
      ],
      [
        "haematopoietic_stem_cell_icd10_ever",
        "had_apcs_diag_icd10_lastdate(codelist=haematopoietic_stem_cell_transplant_nhsd_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L797",
        "DatePatientSeries",
        797
      ],
      [
        "haematopoietic_stem_cell_opcs4",
        "apcs_proc_12m_bf_treat_af01Feb20_lastdate(codelist=haematopoietic_stem_cell_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L776",
        "DatePatientSeries",
        776
      ],
      [
        "haematopoietic_stem_cell_opcs4_ever",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=haematopoietic_stem_cell_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L801",
        "DatePatientSeries",
        801
      ],
      [
        "haematopoietic_stem_cell_snomed",
        "had_c_event_ctv3snome_lastdate(dt=c_events_bf12m, codelist=haematopoietic_stem_cell_transplant_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L758",
        "DatePatientSeries",
        758
      ],
      [
        "haematopoietic_stem_cell_snomed_ever",
        "had_c_event_ctv3snome_lastdate(codelist=haematopoietic_stem_cell_transplant_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L794",
        "DatePatientSeries",
        794
      ],
      [
        "highrisk_codelist",
        "case(when(dataset.is_codelist_highrisk >= 1).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L909",
        "IntPatientSeries",
        909
      ],
      [
        "highrisk_codelist_ever",
        "case(when(dataset.is_codelist_highrisk_ever >= 1).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L915",
        "IntPatientSeries",
        915
      ],
      [
        "hosp_60daf_treat_alldiag_date",
        "apcs_admis_60daf_treat_alldiag_firstdate(codelist=covid_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L992",
        "DatePatientSeries",
        992
      ],
      [
        "hosp_af_treat_alldiag_date",
        "apcs_admis_af_treat_alldiag_firstdate(codelist=covid_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L987",
        "DatePatientSeries",
        987
      ],
      [
        "hosp_allcause60d12m_classfic",
        "hosp_allcause_af60d_12mon_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L284",
        "StrPatientSeries",
        284
      ],
      [
        "hosp_allcause60d12m_date",
        "hosp_allcause_af60d_12mon_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L283",
        "DatePatientSeries",
        283
      ],
      [
        "hosp_allcause60d12m_pdiag",
        "hosp_allcause_af60d_12mon_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L285",
        "CodePatientSeries",
        285
      ],
      [
        "hosp_allcause60d24m_classfic",
        "hosp_allcause_af60d_24mon_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L290",
        "StrPatientSeries",
        290
      ],
      [
        "hosp_allcause60d24m_date",
        "hosp_allcause_af60d_24mon_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L289",
        "DatePatientSeries",
        289
      ],
      [
        "hosp_allcause60d24m_pdiag",
        "hosp_allcause_af60d_24mon_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L291",
        "CodePatientSeries",
        291
      ],
      [
        "hosp_allcause60d6m_classfic",
        "hosp_allcause_af60d_6mon_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L278",
        "StrPatientSeries",
        278
      ],
      [
        "hosp_allcause60d6m_date",
        "hosp_allcause_af60d_6mon_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L277",
        "DatePatientSeries",
        277
      ],
      [
        "hosp_allcause60d6m_pdiag",
        "hosp_allcause_af60d_6mon_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L279",
        "CodePatientSeries",
        279
      ],
      [
        "hosp_covid60d12m_classfic",
        "hosp_60d_12m_covid_pdiag_1stdate_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L232",
        "StrPatientSeries",
        232
      ],
      [
        "hosp_covid60d12m_date",
        "hosp_60d_12m_covid_pdiag_1stdate_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L231",
        "DatePatientSeries",
        231
      ],
      [
        "hosp_covid60d12m_pdiag",
        "hosp_60d_12m_covid_pdiag_1stdate_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L233",
        "CodePatientSeries",
        233
      ],
      [
        "hosp_covid60d24m_classfic",
        "hosp_60d_24m_covid_pdiag_1stdate_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L238",
        "StrPatientSeries",
        238
      ],
      [
        "hosp_covid60d24m_date",
        "hosp_60d_24m_covid_pdiag_1stdate_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L237",
        "DatePatientSeries",
        237
      ],
      [
        "hosp_covid60d24m_pdiag",
        "hosp_60d_24m_covid_pdiag_1stdate_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L239",
        "CodePatientSeries",
        239
      ],
      [
        "hosp_covid60d6m_classfic",
        "hosp_af60d_covid_pdiag_1stdate_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L227",
        "StrPatientSeries",
        227
      ],
      [
        "hosp_covid60d6m_date",
        "hosp_af60d_covid_pdiag_1stdate_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L226",
        "DatePatientSeries",
        226
      ],
      [
        "hosp_covid60d6m_pdiag",
        "hosp_af60d_covid_pdiag_1stdate_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L228",
        "CodePatientSeries",
        228
      ],
      [
        "hosp_covid_bf30d_classfic",
        "hosp_bf30d_covid_pdiag_1stdate_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L212",
        "StrPatientSeries",
        212
      ],
      [
        "hosp_covid_bf30d_date",
        "hosp_bf30d_covid_pdiag_1stdate_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L211",
        "DatePatientSeries",
        211
      ],
      [
        "hosp_covid_bf30d_pdiag",
        "hosp_bf30d_covid_pdiag_1stdate_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L213",
        "CodePatientSeries",
        213
      ],
      [
        "hosp_covid_bf60d_classfic",
        "hosp_bf60d_covid_pdiag_1stdate_df.patient_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L220",
        "StrPatientSeries",
        220
      ],
      [
        "hosp_covid_bf60d_date",
        "hosp_bf60d_covid_pdiag_1stdate_df.admission_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L219",
        "DatePatientSeries",
        219
      ],
      [
        "hosp_covid_bf60d_pdiag",
        "hosp_bf60d_covid_pdiag_1stdate_df.primary_diagnosis",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L221",
        "CodePatientSeries",
        221
      ],
      [
        "hospitalise_disc_allcause",
        "apcs.where(apcs.discharge_date.is_on_or_before(hosp_allcause60d6m_date)).sort_by(apcs.discharge_date).first_for_patient().discharge_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L299",
        "DatePatientSeries",
        299
      ],
      [
        "hospitalise_disc_covid",
        "apcs.where(apcs.discharge_date.is_on_or_before(hosp_covid60d6m_date)).sort_by(apcs.discharge_date).first_for_patient().discharge_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L295",
        "DatePatientSeries",
        295
      ],
      [
        "housebound_lastdate",
        "had_c_event_ctv3snome_lastdate(codelist=housebound_opensafely_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1212",
        "DatePatientSeries",
        1212
      ],
      [
        "if_old_covid_treat",
        "had_covid_treat_df0.sort_by(had_covid_treat_df0.treatment_start_date).where(had_covid_treat_df0.treatment_start_date.is_before(treat_date)).exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L95",
        "BoolPatientSeries",
        95
      ],
      [
        "imd",
        "case(when((imd0 >= 0) & (imd0 < int(32844 * 1 / 5))).then('1 (most deprived)'), when(imd0 < int(32844 * 2 / 5)).then('2'), when(imd0 < int(32844 * 3 / 5)).then('3'), when(imd0 < int(32844 * 4 / 5)).then('4'), when(imd0 < int(32844 * 5 / 5)).then('5 (least deprived)'), otherwise='unknown')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1101",
        "StrPatientSeries",
        1101
      ],
      [
        "imd1",
        "addresses.for_patient_on(treat_date).imd_rounded",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1111",
        "IntPatientSeries",
        1111
      ],
      [
        "imid",
        "case(when(dataset.had_imid).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L527",
        "IntPatientSeries",
        527
      ],
      [
        "imid_ever",
        "case(when(dataset.had_imid_ever).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L531",
        "IntPatientSeries",
        531
      ],
      [
        "immunosuppresant_drugs_nhsd",
        "had_meds_lastdate(codelist1=immunosuppresant_drugs_dmd_codes, codelist2=immunosuppresant_drugs_snomed_codes, dt=pcmeds_bf_6m)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L492",
        "DatePatientSeries",
        492
      ],
      [
        "immunosuppresant_drugs_nhsd_ever",
        "had_meds_lastdate(codelist1=immunosuppresant_drugs_dmd_codes, codelist2=immunosuppresant_drugs_snomed_codes, dt=pcmeds_bf_treat)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L509",
        "DatePatientSeries",
        509
      ],
      [
        "immunosupression",
        "case(when(dataset.had_immunosupression).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L848",
        "IntPatientSeries",
        848
      ],
      [
        "immunosupression_new",
        "case(when(dataset.had_immunosupression_new).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L853",
        "IntPatientSeries",
        853
      ],
      [
        "immunosupression_nhsd",
        "had_c_event_ctv3snome_lastdate(codelist=immunosupression_nhsd_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L843",
        "DatePatientSeries",
        843
      ],
      [
        "immunosupression_nhsd_new",
        "had_c_event_ctv3snome_lastdate(codelist=immunosupression_nhsd_codes_new, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L845",
        "DatePatientSeries",
        845
      ],
      [
        "is_codelist_highrisk",
        "dataset.imid + dataset.dialysis + dataset.kidney_transplant + dataset.solid_organ_transplant_new + dataset.haema_disease + dataset.immunosupression_new + dataset.solid_cancer_new",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L906",
        "IntPatientSeries",
        906
      ],
      [
        "is_codelist_highrisk_ever",
        "dataset.imid_ever + dataset.dialysis + dataset.kidney_transplant + dataset.solid_organ_transplant_new + dataset.haema_disease_ever + dataset.immunosupression_new + dataset.solid_cancer_ever",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L912",
        "IntPatientSeries",
        912
      ],
      [
        "is_molnu_pt12m_censored",
        "dataset.molnu_pt12m_censored_exist & dataset.first_covid_treat_interve.is_in(['Molnupiravir'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L426",
        "BoolPatientSeries",
        426
      ],
      [
        "is_molnu_pt24m_censored",
        "dataset.molnu_pt24m_censored_exist & dataset.first_covid_treat_interve.is_in(['Molnupiravir'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L449",
        "BoolPatientSeries",
        449
      ],
      [
        "is_molnu_pt6m_censored",
        "dataset.molnu_pt6m_censored_exist & dataset.first_covid_treat_interve.is_in(['Molnupiravir'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L409",
        "BoolPatientSeries",
        409
      ],
      [
        "is_pregdel",
        "c_events_bf_treat.where(c_events_bf_treat.snomedct_code.is_in(pregdel_primis_codes) & c_events_bf_treat.date.is_on_or_before(treat_date) & c_events_bf_treat.date.is_on_or_between(dataset.preg_36wks_date + days(1), treat_date - days(1))).sort_by(c_events_bf_treat.date).last_for_patient().exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L930",
        "BoolPatientSeries",
        930
      ],
      [
        "is_sotro_pt12m_censored",
        "dataset.sotro_pt12m_censored_exist & dataset.first_covid_treat_interve.is_in(['Sotrovimab'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L427",
        "BoolPatientSeries",
        427
      ],
      [
        "is_sotro_pt24m_censored",
        "dataset.sotro_pt24m_censored_exist & dataset.first_covid_treat_interve.is_in(['Sotrovimab'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L450",
        "BoolPatientSeries",
        450
      ],
      [
        "is_sotro_pt6m_censored",
        "dataset.sotro_pt6m_censored_exist & dataset.first_covid_treat_interve.is_in(['Sotrovimab'])",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L410",
        "BoolPatientSeries",
        410
      ],
      [
        "kidney_transplant",
        "case(when(dataset.had_kidney_transplant).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L629",
        "IntPatientSeries",
        629
      ],
      [
        "kidney_transplant_ctv3",
        "had_c_event_ctv3snome_lastdate(codelist=kidney_transplant_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L620",
        "DatePatientSeries",
        620
      ],
      [
        "kidney_transplant_icd10",
        "had_apcs_diag_icd10_lastdate(codelist=kidney_tx_icd10_codelist)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L621",
        "DatePatientSeries",
        621
      ],
      [
        "kidney_transplant_procedure",
        "apcs_proc_bf_treat_lastdate(codelist=kidney_tx_opcs4_codelist)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L624",
        "DatePatientSeries",
        624
      ],
      [
        "latest_ethnicity_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(ethnicity_codelist_with_categories)).where(clinical_events.date.is_on_or_before(dod_ons)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1039",
        "CodePatientSeries",
        1039
      ],
      [
        "molnu_pt12m_censored",
        "case(when(dataset.is_molnu_pt12m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L429",
        "IntPatientSeries",
        429
      ],
      [
        "molnu_pt12m_censored_date",
        "had_covid_treat12m_excpt_molnu_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L420",
        "DatePatientSeries",
        420
      ],
      [
        "molnu_pt12m_censored_drug",
        "had_covid_treat12m_excpt_molnu_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L422",
        "StrPatientSeries",
        422
      ],
      [
        "molnu_pt12m_censored_exist",
        "had_covid_treat12m_excpt_molnu_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L424",
        "BoolPatientSeries",
        424
      ],
      [
        "molnu_pt24m_censored",
        "case(when(dataset.is_molnu_pt24m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L452",
        "IntPatientSeries",
        452
      ],
      [
        "molnu_pt24m_censored_date",
        "had_covid_treat24m_excpt_molnu_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L443",
        "DatePatientSeries",
        443
      ],
      [
        "molnu_pt24m_censored_drug",
        "had_covid_treat24m_excpt_molnu_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L445",
        "StrPatientSeries",
        445
      ],
      [
        "molnu_pt24m_censored_exist",
        "had_covid_treat24m_excpt_molnu_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L447",
        "BoolPatientSeries",
        447
      ],
      [
        "molnu_pt6m_censored",
        "case(when(dataset.is_molnu_pt6m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L412",
        "IntPatientSeries",
        412
      ],
      [
        "molnu_pt6m_censored_date",
        "had_covid_treat6m_excpt_molnu_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L403",
        "DatePatientSeries",
        403
      ],
      [
        "molnu_pt6m_censored_drug",
        "had_covid_treat6m_excpt_molnu_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L405",
        "StrPatientSeries",
        405
      ],
      [
        "molnu_pt6m_censored_exist",
        "had_covid_treat6m_excpt_molnu_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L407",
        "BoolPatientSeries",
        407
      ],
      [
        "moved_into_care_home_lastdate",
        "had_c_event_ctv3snome_lastdate(codelist=care_home_primis_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1220",
        "DatePatientSeries",
        1220
      ],
      [
        "no_longer_housebound_lastdate",
        "had_c_event_ctv3snome_lastdate(codelist=no_longer_housebound_opensafely_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1216",
        "DatePatientSeries",
        1216
      ],
      [
        "old_covid_treat",
        "case(when(dataset.if_old_covid_treat).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L100",
        "IntPatientSeries",
        100
      ],
      [
        "ons_dead_date",
        "ons_deaths.date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L304",
        "DatePatientSeries",
        304
      ],
      [
        "oral_steroid_drug_nhsd_12m_count",
        "had_meds_count(codelist1=oral_steroid_drugs_dmd_codes, codelist2=oral_steroid_drugs_snomed_codes, dt=pcmeds_bf_12m)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L500",
        "IntPatientSeries",
        500
      ],
      [
        "oral_steroid_drug_nhsd_3m_count",
        "had_meds_count(codelist1=oral_steroid_drugs_dmd_codes, codelist2=oral_steroid_drugs_snomed_codes, dt=pcmeds_bf_3m)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L496",
        "IntPatientSeries",
        496
      ],
      [
        "oral_steroid_drugs_nhsd",
        "had_meds_lastdate(codelist1=oral_steroid_drugs_dmd_codes, codelist2=oral_steroid_drugs_snomed_codes, dt=pcmeds_bf_12m)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L504",
        "DatePatientSeries",
        504
      ],
      [
        "oral_steroid_drugs_nhsd_check",
        "(dataset.oral_steroid_drugs_nhsd <= treat_date) & (dataset.oral_steroid_drug_nhsd_3m_count >= 2) & (dataset.oral_steroid_drug_nhsd_12m_count >= 4)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L508",
        "BoolPatientSeries",
        508
      ],
      [
        "oral_steroid_drugs_nhsd_ever",
        "had_meds_lastdate(codelist1=oral_steroid_drugs_dmd_codes, codelist2=oral_steroid_drugs_snomed_codes, dt=pcmeds_bf_treat)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L513",
        "DatePatientSeries",
        513
      ],
      [
        "preg_36wks_date",
        "c_events_bf_treat.where(c_events_bf_treat.snomedct_code.is_in(pregnancy_primis_codes) & c_events_bf_treat.date.is_on_or_before(treat_date) & c_events_bf_treat.date.is_on_or_between(treat_date - days(252), treat_date - days(1))).sort_by(c_events_bf_treat.date).last_for_patient().date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L921",
        "DatePatientSeries",
        921
      ],
      [
        "pregnancy",
        "case(when((patients.age_on(dataset.preg_36wks_date) <= 50) & patients.sex.is_in(['female']) & ~dataset.is_pregdel).then('preg'), otherwise='Not preg')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L945",
        "StrPatientSeries",
        945
      ],
      [
        "region",
        "regd.practice_nuts1_region_name",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1117",
        "StrPatientSeries",
        1117
      ],
      [
        "risk_cohort",
        "therapeutics_df.risk_cohort",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L904",
        "StrPatientSeries",
        904
      ],
      [
        "rural_urban",
        "addresses.for_patient_on(treat_date).rural_urban_classification",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1136",
        "IntPatientSeries",
        1136
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1006",
        "StrPatientSeries",
        1006
      ],
      [
        "sickle_cell_disease_nhsd_icd10",
        "had_apcs_diag_icd10_lastdate(codelist=sickle_cell_disease_nhsd_icd10_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L791",
        "DatePatientSeries",
        791
      ],
      [
        "sickle_cell_disease_nhsd_snomed",
        "had_c_event_ctv3snome_lastdate(codelist=sickle_cell_disease_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L788",
        "DatePatientSeries",
        788
      ],
      [
        "solid_cancer",
        "case(when(dataset.had_solid_cancer).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L877",
        "IntPatientSeries",
        877
      ],
      [
        "solid_cancer_ever",
        "case(when(dataset.had_solid_cancer_ever).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L887",
        "IntPatientSeries",
        887
      ],
      [
        "solid_cancer_new",
        "case(when(dataset.had_solid_cancer_new).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L882",
        "IntPatientSeries",
        882
      ],
      [
        "solid_organ_nhsd_snomed_new",
        "had_c_event_ctv3snome_lastdate(codelist=solid_organ_transplant_nhsd_snomed_codes_new, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L639",
        "DatePatientSeries",
        639
      ],
      [
        "solid_organ_transplant",
        "case(when(dataset.had_solid_organ_transplant).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L745",
        "IntPatientSeries",
        745
      ],
      [
        "solid_organ_transplant_new",
        "case(when(dataset.had_solid_organ_transplant_new).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L751",
        "IntPatientSeries",
        751
      ],
      [
        "solid_organ_transplant_nhsd",
        "minimum_of(dataset.solid_organ_transplant_nhsd_snomed, dataset.solid_organ_transplant_nhsd_opcs4, dataset.transplant_thymus_opcs4_2, dataset.transplant_conjunctiva_opcs4_2, dataset.transplant_stomach_opcs4_2, dataset.transplant_ileum_1_opcs4_2, dataset.transplant_ileum_2_opcs4_2)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L731",
        "DatePatientSeries",
        731
      ],
      [
        "solid_organ_transplant_nhsd_new",
        "minimum_of(dataset.solid_organ_nhsd_snomed_new, dataset.solid_organ_transplant_nhsd_opcs4, dataset.transplant_thymus_opcs4_2, dataset.transplant_conjunctiva_opcs4_2, dataset.transplant_stomach_opcs4_2, dataset.transplant_ileum_1_opcs4_2, dataset.transplant_ileum_2_opcs4_2)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L737",
        "DatePatientSeries",
        737
      ],
      [
        "solid_organ_transplant_nhsd_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=solid_organ_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L642",
        "DatePatientSeries",
        642
      ],
      [
        "solid_organ_transplant_nhsd_snomed",
        "had_c_event_ctv3snome_lastdate(codelist=solid_organ_transplant_nhsd_snomed_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L637",
        "DatePatientSeries",
        637
      ],
      [
        "solid_organ_transplant_snomed",
        "had_c_event_ctv3snome_lastdate(codelist=solid_organ_transplant_codes, code_type='snomedct')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L634",
        "DatePatientSeries",
        634
      ],
      [
        "sotro_pt12m_censored",
        "case(when(dataset.is_sotro_pt12m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L433",
        "IntPatientSeries",
        433
      ],
      [
        "sotro_pt12m_censored_date",
        "had_covid_treat12m_excpt_sotro_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L421",
        "DatePatientSeries",
        421
      ],
      [
        "sotro_pt12m_censored_drug",
        "had_covid_treat12m_excpt_sotro_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L423",
        "StrPatientSeries",
        423
      ],
      [
        "sotro_pt12m_censored_exist",
        "had_covid_treat12m_excpt_sotro_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L425",
        "BoolPatientSeries",
        425
      ],
      [
        "sotro_pt24m_censored",
        "case(when(dataset.is_sotro_pt24m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L456",
        "IntPatientSeries",
        456
      ],
      [
        "sotro_pt24m_censored_date",
        "had_covid_treat24m_excpt_sotro_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L444",
        "DatePatientSeries",
        444
      ],
      [
        "sotro_pt24m_censored_drug",
        "had_covid_treat24m_excpt_sotro_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L446",
        "StrPatientSeries",
        446
      ],
      [
        "sotro_pt24m_censored_exist",
        "had_covid_treat24m_excpt_sotro_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L448",
        "BoolPatientSeries",
        448
      ],
      [
        "sotro_pt6m_censored",
        "case(when(dataset.is_sotro_pt6m_censored).then(1), otherwise=0)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L416",
        "IntPatientSeries",
        416
      ],
      [
        "sotro_pt6m_censored_date",
        "had_covid_treat6m_excpt_sotro_df.first_for_patient().treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L404",
        "DatePatientSeries",
        404
      ],
      [
        "sotro_pt6m_censored_drug",
        "had_covid_treat6m_excpt_sotro_df.first_for_patient().intervention",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L406",
        "StrPatientSeries",
        406
      ],
      [
        "sotro_pt6m_censored_exist",
        "had_covid_treat6m_excpt_sotro_df.exists_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L408",
        "BoolPatientSeries",
        408
      ],
      [
        "start_date_60d",
        "dataset.treat_date + days(60)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L90",
        "DatePatientSeries",
        90
      ],
      [
        "stp",
        "regd.practice_stp",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1119",
        "StrPatientSeries",
        1119
      ],
      [
        "total_covid_vacc",
        "covid_vacc.count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1152",
        "IntPatientSeries",
        1152
      ],
      [
        "total_covid_vacc_cat",
        "case(when(dataset.total_covid_vacc == 1).then('One vaccination'), when(dataset.total_covid_vacc == 2).then('Two vaccinations'), when(dataset.total_covid_vacc >= 3).then('Three or more vaccinations'), otherwise='unvaccinated')",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1167",
        "StrPatientSeries",
        1167
      ],
      [
        "transplant_all_y_codes_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=replacement_of_organ_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L643",
        "DatePatientSeries",
        643
      ],
      [
        "transplant_all_y_codes_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=replacement_of_organ_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L647",
        "IntPatientSeries",
        647
      ],
      [
        "transplant_conjunctiva_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=conjunctiva_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L665",
        "DatePatientSeries",
        665
      ],
      [
        "transplant_conjunctiva_opcs4_2",
        "proc_bf_treat_af01Feb20_lastdate(dt=transplant_conjunctiva_y_code_opcs4_df, codelist=conjunctiva_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L718",
        "DatePatientSeries",
        718
      ],
      [
        "transplant_conjunctiva_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=conjunctiva_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L666",
        "IntPatientSeries",
        666
      ],
      [
        "transplant_conjunctiva_y_code_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=conjunctiva_y_codes_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L660",
        "DatePatientSeries",
        660
      ],
      [
        "transplant_conjunctiva_y_code_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=conjunctiva_y_codes_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L661",
        "IntPatientSeries",
        661
      ],
      [
        "transplant_ileum_1_Y_codes_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=ileum_1_y_codes_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L676",
        "DatePatientSeries",
        676
      ],
      [
        "transplant_ileum_1_Y_codes_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=ileum_1_y_codes_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L677",
        "IntPatientSeries",
        677
      ],
      [
        "transplant_ileum_1_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=ileum_1_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L681",
        "DatePatientSeries",
        681
      ],
      [
        "transplant_ileum_1_opcs4_2",
        "proc_bf_treat_af01Feb20_lastdate(dt=transplant_ileum_1_Y_codes_opcs4_df, codelist=ileum_1_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L724",
        "DatePatientSeries",
        724
      ],
      [
        "transplant_ileum_1_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=ileum_1_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L682",
        "IntPatientSeries",
        682
      ],
      [
        "transplant_ileum_2_Y_codes_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=ileum_2_y_codes_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L685",
        "DatePatientSeries",
        685
      ],
      [
        "transplant_ileum_2_Y_codes_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=ileum_2_y_codes_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L686",
        "IntPatientSeries",
        686
      ],
      [
        "transplant_ileum_2_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=ileum_2_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L691",
        "DatePatientSeries",
        691
      ],
      [
        "transplant_ileum_2_opcs4_2",
        "proc_bf_treat_af01Feb20_lastdate(dt=transplant_ileum_2_Y_codes_opcs4_df, codelist=ileum_2_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L727",
        "DatePatientSeries",
        727
      ],
      [
        "transplant_ileum_2_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=ileum_2_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L692",
        "IntPatientSeries",
        692
      ],
      [
        "transplant_stomach_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=stomach_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L671",
        "DatePatientSeries",
        671
      ],
      [
        "transplant_stomach_opcs4_2",
        "proc_bf_treat_af01Feb20_lastdate(dt=transplant_all_y_codes_opcs4_df, codelist=stomach_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L721",
        "DatePatientSeries",
        721
      ],
      [
        "transplant_stomach_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=stomach_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L672",
        "IntPatientSeries",
        672
      ],
      [
        "transplant_thymus_opcs4",
        "apcs_proc_bf_treat_af01Feb20_lastdate(codelist=thymus_gland_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L654",
        "DatePatientSeries",
        654
      ],
      [
        "transplant_thymus_opcs4_2",
        "proc_bf_treat_af01Feb20_lastdate(dt=transplant_all_y_codes_opcs4_df, codelist=thymus_gland_transplant_nhsd_opcs4_codes)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L714",
        "DatePatientSeries",
        714
      ],
      [
        "transplant_thymus_opcs4_a",
        "dataset.transplant_thymus_opcs4.is_on_or_between(dataset.transplant_all_y_codes_opcs4, dataset.transplant_all_y_codes_opcs4)",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L657",
        "BoolPatientSeries",
        657
      ],
      [
        "transplant_thymus_opcs4_count",
        "apcs_proc_bf_treat_af01Feb20_df(codelist=thymus_gland_transplant_nhsd_opcs4_codes).count_for_patient()",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L655",
        "IntPatientSeries",
        655
      ],
      [
        "treat_date",
        "had_covid_m_s_treat_df.treatment_start_date",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L80",
        "DatePatientSeries",
        80
      ],
      [
        "underly_deathcause_code",
        "ons_deaths.underlying_cause_of_death",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L305",
        "CodePatientSeries",
        305
      ],
      [
        "was_allcause_death_60d_12m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(12))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L319",
        "BoolPatientSeries",
        319
      ],
      [
        "was_allcause_death_60d_24m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(24))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L329",
        "BoolPatientSeries",
        329
      ],
      [
        "was_allcause_death_60d_6m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(6))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L309",
        "BoolPatientSeries",
        309
      ],
      [
        "was_allcause_death_under30d",
        "ons_deaths.date.is_after(treat_date) & ons_deaths.date.is_on_or_before(treat_date + days(30))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L374",
        "BoolPatientSeries",
        374
      ],
      [
        "was_allcause_death_under60d",
        "ons_deaths.date.is_after(treat_date) & ons_deaths.date.is_on_or_before(treat_date + days(60))",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L366",
        "BoolPatientSeries",
        366
      ],
      [
        "was_covid_death_60d_12m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(12)) & dataset.death_cause_covid",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L348",
        "BoolPatientSeries",
        348
      ],
      [
        "was_covid_death_60d_24m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(24)) & dataset.death_cause_covid",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L357",
        "BoolPatientSeries",
        357
      ],
      [
        "was_covid_death_60d_6m",
        "ons_deaths.date.is_after(treat_date + days(60)) & ons_deaths.date.is_on_or_before(treat_date + days(60) + months(6)) & dataset.death_cause_covid",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L339",
        "BoolPatientSeries",
        339
      ],
      [
        "was_registered_treated",
        "was_registered_treated",
        "https://github.com/opensafely/prophy_effects_Sotro_Molnup/blob/bf991811a0514dfde66815c4a723e8d4a6c65654/analysis/dataset_definition.py#L1115",
        "BoolPatientSeries",
        1115
      ]
    ]
  },
  "qof": {
    "analysis/dep_reg_dataset.py": [
      [
        "depr_dat",
        "last_matching_event(prior_events, dep_codelist).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dep_reg_dataset.py#L57",
        "DatePatientSeries",
        57
      ],
      [
        "depres_dat",
        "last_matching_event(prior_events, depres_codelist).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dep_reg_dataset.py#L61",
        "DatePatientSeries",
        61
      ],
      [
        "pat_age",
        "patients.age_on(qs_start_date)",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dep_reg_dataset.py#L52",
        "IntPatientSeries",
        52
      ]
    ],
    "analysis/dm_reg_dataset.py": [
      [
        "dm_reg_r1",
        "(dataset.dmres_dat < dataset.dmlat_dat) | dataset.dmlat_dat.is_not_null() & dataset.dmres_dat.is_null()",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dm_reg_dataset.py#L75",
        "BoolPatientSeries",
        75
      ],
      [
        "dm_reg_r2",
        "dataset.pat_age < 17",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dm_reg_dataset.py#L81",
        "BoolPatientSeries",
        81
      ],
      [
        "dmlat_dat",
        "last_matching_event(prior_events, dm_cod).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dm_reg_dataset.py#L65",
        "DatePatientSeries",
        65
      ],
      [
        "dmres_dat",
        "last_matching_event(prior_events, dm_res_cod).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dm_reg_dataset.py#L70",
        "DatePatientSeries",
        70
      ],
      [
        "pat_age",
        "patients.age_on(index_date)",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/dm_reg_dataset.py#L61",
        "IntPatientSeries",
        61
      ]
    ],
    "analysis/hyp_reg_dataset.py": [
      [
        "hyp_reg_r1",
        "dataset.hyplat_dat.is_not_null() & dataset.hypres_dat.is_null() | (dataset.hyplat_dat > dataset.hypres_dat)",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/hyp_reg_dataset.py#L60",
        "BoolPatientSeries",
        60
      ],
      [
        "hyplat_dat",
        "last_matching_event(prior_events, hyp_cod).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/hyp_reg_dataset.py#L49",
        "DatePatientSeries",
        49
      ],
      [
        "hypres_dat",
        "last_matching_event(prior_events, hypres_cod).date",
        "https://github.com/opensafely/qof/blob/9d00aa15f04b294f88728518b7e6185a1a59b0cb/analysis/hyp_reg_dataset.py#L53",
        "DatePatientSeries",
        53
      ]
    ]
  },
  "research-template": {
    "analysis/dataset_definition.py": [
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/research-template/blob/fc4b32db25b41fca0b35b5c646fadb430300ba9c/analysis/dataset_definition.py#L14",
        "StrPatientSeries",
        14
      ]
    ]
  },
  "reusable-variables": {
    "analysis/PRIMIS/dataset_definition.py": [
      [
        "asplenia",
        "has_prior_event(spln_cov, index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L34",
        "BoolPatientSeries",
        34
      ],
      [
        "chd",
        "has_prior_event(chd_cov, index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L32",
        "BoolPatientSeries",
        32
      ],
      [
        "ckd",
        "has_ckd(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L28",
        "BoolPatientSeries",
        28
      ],
      [
        "cld",
        "has_prior_event(cld, index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L31",
        "BoolPatientSeries",
        31
      ],
      [
        "cns",
        "has_prior_event(cns_cov, index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L33",
        "BoolPatientSeries",
        33
      ],
      [
        "crd",
        "has_crd(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L29",
        "BoolPatientSeries",
        29
      ],
      [
        "diabetes",
        "has_diabetes(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L30",
        "BoolPatientSeries",
        30
      ],
      [
        "immunosuppressed",
        "is_immunosuppressed(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L27",
        "BoolPatientSeries",
        27
      ],
      [
        "learndis",
        "has_prior_event(learndis, index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L35",
        "BoolPatientSeries",
        35
      ],
      [
        "primis_atrisk",
        "primis_atrisk(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L41",
        "BoolPatientSeries",
        41
      ],
      [
        "severe_obesity",
        "has_severe_obesity(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L37",
        "BoolPatientSeries",
        37
      ],
      [
        "smi",
        "has_smi(index_date)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/PRIMIS/dataset_definition.py#L36",
        "BoolPatientSeries",
        36
      ]
    ],
    "analysis/ethnicity/dataset_definition.py": [
      [
        "ethnicity16",
        "ethnicity.snomedct_code.to_category(codelists.ethnicity16)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/ethnicity/dataset_definition.py#L51",
        "StrPatientSeries",
        51
      ],
      [
        "ethnicity5",
        "ethnicity.snomedct_code.to_category(codelists.ethnicity5)",
        "https://github.com/opensafely/reusable-variables/blob/dd18d9c3889c8424852912c769935c919471a9d9/analysis/ethnicity/dataset_definition.py#L48",
        "StrPatientSeries",
        48
      ]
    ]
  },
  "test-age-distribution": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "age",
        "https://github.com/opensafely/test-age-distribution/blob/d267c6d9841da2791a1a44e7384bd5ccfc832b92/analysis/dataset_definition.py#L13",
        "IntPatientSeries",
        13
      ]
    ]
  },
  "tocilizumab_and_sarilumab": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "age",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L55",
        "IntPatientSeries",
        55
      ],
      [
        "all_hosp_admission",
        "apcs.where(apcs.admission_date.is_on_or_before(start_date)).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L74",
        "DatePatientSeries",
        74
      ],
      [
        "all_hosp_admission2",
        "apcs.where(apcs.discharge_date.is_on_or_after(start_date)).sort_by(apcs.discharge_date).first_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L82",
        "DatePatientSeries",
        82
      ],
      [
        "all_hosp_discharge",
        "apcs.where(apcs.admission_date.is_on_or_before(start_date)).sort_by(apcs.admission_date).last_for_patient().discharge_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L70",
        "DatePatientSeries",
        70
      ],
      [
        "all_hosp_discharge2",
        "apcs.where(apcs.discharge_date.is_on_or_after(start_date)).sort_by(apcs.discharge_date).first_for_patient().discharge_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L78",
        "DatePatientSeries",
        78
      ],
      [
        "bmi",
        "clinical_events.where(clinical_events.ctv3_code == CTV3Code('22K..')).where(clinical_events.date.is_on_or_before(start_date)).where(clinical_events.date >= patients.date_of_birth + days(int(365.25 * 18))).sort_by(clinical_events.date).last_for_patient().numeric_value",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L347",
        "FloatPatientSeries",
        347
      ],
      [
        "bmi_date",
        "clinical_events.where(clinical_events.ctv3_code == CTV3Code('22K..')).where(clinical_events.date.is_on_or_before(start_date)).where(clinical_events.date >= patients.date_of_birth + days(int(365.25 * 18))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L354",
        "DatePatientSeries",
        354
      ],
      [
        "cancer_opensafely_snomed_ever",
        "clinical_events.where(clinical_events.snomedct_code.is_in(solid_cancer_codes)).where(clinical_events.date.is_on_or_before(start_date)).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L120",
        "DatePatientSeries",
        120
      ],
      [
        "chronic_cardiac_disease",
        "clinical_events.where(clinical_events.snomedct_code.is_in(chronic_cardiac_dis_codes)).where(clinical_events.date.is_on_or_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L368",
        "BoolPatientSeries",
        368
      ],
      [
        "chronic_respiratory_disease",
        "clinical_events.where(clinical_events.snomedct_code.is_in(chronic_respiratory_dis_codes)).where(clinical_events.date.is_on_or_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L376",
        "BoolPatientSeries",
        376
      ],
      [
        "ckd3_icd10",
        "apcs.where(apcs.all_diagnoses.contains('N183')).where(apcs.admission_date.is_on_or_before(start_date)).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L296",
        "DatePatientSeries",
        296
      ],
      [
        "ckd4_icd10",
        "apcs.where(apcs.all_diagnoses.contains('N184')).where(apcs.admission_date.is_on_or_before(start_date)).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L302",
        "DatePatientSeries",
        302
      ],
      [
        "ckd5_icd10",
        "apcs.where(apcs.all_diagnoses.contains('N185')).where(apcs.admission_date.is_on_or_before(start_date)).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L308",
        "DatePatientSeries",
        308
      ],
      [
        "ckd_primis_stage",
        "clinical_events.where(clinical_events.snomedct_code.is_in(primis_ckd_stage)).where(clinical_events.date.is_on_or_before(start_date)).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L292",
        "DatePatientSeries",
        292
      ],
      [
        "ckd_stage_5_nhsd",
        "minimum_of(ckd_stage_5_nhsd_snomed, ckd_stage_5_nhsd_icd10)",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L285",
        "DatePatientSeries",
        285
      ],
      [
        "ckd_stages_3_5",
        "clinical_events.where(clinical_events.snomedct_code.is_in(chronic_kidney_disease_stages_3_5_codes)).where(clinical_events.date.is_on_or_before(start_date)).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L288",
        "DatePatientSeries",
        288
      ],
      [
        "covid_primary_care_date",
        "clinical_events.where(clinical_events.ctv3_code.is_in(covid_primary_code)).where(clinical_events.date.is_on_or_between('2020-01-01', start_date)).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L395",
        "DatePatientSeries",
        395
      ],
      [
        "covid_primary_care_date00",
        "clinical_events.where(clinical_events.ctv3_code.is_in(covid_primary_code)).where(clinical_events.date.is_on_or_between('2020-01-01', start_date - days(90))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L400",
        "DatePatientSeries",
        400
      ],
      [
        "covid_test_positive_date",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.specimen_taken_date.is_on_or_before(start_date)).where(sgss_covid_all_tests.is_positive).sort_by(sgss_covid_all_tests.specimen_taken_date).last_for_patient().specimen_taken_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L382",
        "DatePatientSeries",
        382
      ],
      [
        "covid_test_positive_date00",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.specimen_taken_date.is_on_or_before(dataset.covid_test_positive_date - days(90))).where(sgss_covid_all_tests.is_positive).sort_by(sgss_covid_all_tests.specimen_taken_date).last_for_patient().specimen_taken_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L388",
        "DatePatientSeries",
        388
      ],
      [
        "covid_vaccination_count",
        "vaccinations.where(vaccinations.target_disease.is_in(['SARS-2 CORONAVIRUS'])).where(vaccinations.date.is_on_or_before(start_date)).count_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L330",
        "IntPatientSeries",
        330
      ],
      [
        "death_date",
        "ons_deaths.date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L59",
        "DatePatientSeries",
        59
      ],
      [
        "death_with_covid_yes",
        "ons_deaths.cause_of_death_is_in(covid_icd10_codes)",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L60",
        "BoolPatientSeries",
        60
      ],
      [
        "dereg_date",
        "practice_registrations.where(practice_registrations.end_date.is_on_or_after(start_date)).sort_by(practice_registrations.end_date).first_for_patient().end_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L62",
        "DatePatientSeries",
        62
      ],
      [
        "diabetes",
        "clinical_events.where(clinical_events.snomedct_code.is_in(diabetes_codes)).where(clinical_events.date.is_on_or_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L363",
        "BoolPatientSeries",
        363
      ],
      [
        "ethnicity",
        "case(when((ethnicity_snomed == '1') | ethnicity_snomed.is_null() & ethnicity_sus.is_in(['A', 'B', 'C'])).then('White'), when((ethnicity_snomed == '2') | ethnicity_snomed.is_null() & ethnicity_sus.is_in(['D', 'E', 'F', 'G'])).then('Mixed'), when((ethnicity_snomed == '3') | ethnicity_snomed.is_null() & ethnicity_sus.is_in(['H', 'J', 'K', 'L'])).then('South Asian'), when((ethnicity_snomed == '4') | ethnicity_snomed.is_null() & ethnicity_sus.is_in(['M', 'N', 'P'])).then('Black'), when((ethnicity_snomed == '5') | ethnicity_snomed.is_null() & ethnicity_sus.is_in(['R', 'S'])).then('Other'), otherwise='Missing')",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L98",
        "StrPatientSeries",
        98
      ],
      [
        "haematological_disease_nhsd_ever",
        "minimum_of(haematopoietic_stem_cell_snomed, haematopoietic_stem_cell_icd10, haematopoietic_stem_cell_opcs4, haematological_malignancies_snomed, haematological_malignancies_icd10, sickle_cell_disease_nhsd_snomed, sickle_cell_disease_nhsd_icd10)",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L162",
        "DatePatientSeries",
        162
      ],
      [
        "has_died",
        "has_died",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L56",
        "BoolPatientSeries",
        56
      ],
      [
        "hypertension",
        "clinical_events.where(clinical_events.snomedct_code.is_in(hypertension_codes)).where(clinical_events.date.is_on_or_before(start_date)).exists_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L372",
        "BoolPatientSeries",
        372
      ],
      [
        "imd_quintile",
        "addresses.for_patient_on(start_date).imd_quintile",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L107",
        "StrPatientSeries",
        107
      ],
      [
        "immunosuppresant_drugs_nhsd",
        "medications.where(medications.dmd_code.is_in(immunosuppresant_drugs_dmd_codes)).where(medications.date.is_on_or_between(start_date - days(180), start_date)).sort_by(medications.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L173",
        "DatePatientSeries",
        173
      ],
      [
        "immunosupression_nhsd_new",
        "clinical_events.where(clinical_events.snomedct_code.is_in(immunosupression_nhsd_codes_new)).where(clinical_events.date.is_on_or_before(start_date)).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L199",
        "DatePatientSeries",
        199
      ],
      [
        "last_vaccination_date",
        "vaccinations.where(vaccinations.target_disease.is_in(['SARS-2 CORONAVIRUS'])).where(vaccinations.date.is_on_or_before(start_date)).sort_by(vaccinations.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L336",
        "DatePatientSeries",
        336
      ],
      [
        "liver_disease_nhsd",
        "minimum_of(liver_disease_nhsd_snomed, liver_disease_nhsd_icd10)",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L326",
        "DatePatientSeries",
        326
      ],
      [
        "oral_steroid_drug_nhsd_12m_count",
        "medications.where(medications.dmd_code.is_in(oral_steroid_drugs_dmd_codes)).where(medications.date.is_on_or_between(start_date - days(365), start_date)).count_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L192",
        "IntPatientSeries",
        192
      ],
      [
        "oral_steroid_drug_nhsd_3m_count",
        "medications.where(medications.dmd_code.is_in(oral_steroid_drugs_dmd_codes)).where(medications.date.is_on_or_between(start_date - days(90), start_date)).count_for_patient()",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L187",
        "IntPatientSeries",
        187
      ],
      [
        "oral_steroid_drugs_nhsd",
        "medications.where(medications.dmd_code.is_in(oral_steroid_drugs_dmd_codes)).where(medications.date.is_on_or_between(start_date - days(365), start_date)).sort_by(medications.date).last_for_patient().date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L180",
        "DatePatientSeries",
        180
      ],
      [
        "out_date_dereg",
        "registered.end_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L67",
        "DatePatientSeries",
        67
      ],
      [
        "previous_drug",
        "covid_therapeutics.where(covid_therapeutics.treatment_start_date.is_before(start_date)).sort_by(covid_therapeutics.treatment_start_date).last_for_patient().treatment_start_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L408",
        "DatePatientSeries",
        408
      ],
      [
        "previous_drug00",
        "covid_therapeutics.where(covid_therapeutics.treatment_start_date.is_on_or_before(start_date - days(90))).sort_by(covid_therapeutics.treatment_start_date).last_for_patient().treatment_start_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L411",
        "DatePatientSeries",
        411
      ],
      [
        "previous_hosp",
        "apcs.where(apcs.all_diagnoses.contains_any_of(covid_icd10_codes)).where(apcs.admission_date.is_before(dataset.all_hosp_admission)).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L417",
        "DatePatientSeries",
        417
      ],
      [
        "previous_hosp00",
        "apcs.where(apcs.all_diagnoses.contains_any_of(covid_icd10_codes)).where(apcs.admission_date.is_before(start_date - days(90))).sort_by(apcs.admission_date).last_for_patient().admission_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L422",
        "DatePatientSeries",
        422
      ],
      [
        "region_covid_therapeutics",
        "covid_therapeutics.where(covid_therapeutics.treatment_start_date.is_on_or_after(start_date)).sort_by(covid_therapeutics.treatment_start_date).first_for_patient().region",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L113",
        "StrPatientSeries",
        113
      ],
      [
        "region_nhs",
        "practice_registrations.for_patient_on(start_date).practice_nuts1_region_name",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L110",
        "StrPatientSeries",
        110
      ],
      [
        "rural_urban",
        "addresses.for_patient_on(start_date).rural_urban_classification",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L111",
        "IntPatientSeries",
        111
      ],
      [
        "sarilumab_date",
        "sarilumab_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L53",
        "DatePatientSeries",
        53
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L88",
        "StrPatientSeries",
        88
      ],
      [
        "solid_organ_transplant_nhsd_new",
        "minimum_of(solid_organ_nhsd_snomed_new, solid_organ_transplant_nhsd_opcs4, transplant_thymus_opcs4, transplant_conjunctiva_opcs4, transplant_stomach_opcs4, transplant_ileum_1_opcs4, transplant_ileum_2_opcs4)",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L270",
        "DatePatientSeries",
        270
      ],
      [
        "start_date",
        "start_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L54",
        "DatePatientSeries",
        54
      ],
      [
        "stp",
        "practice_registrations.for_patient_on(start_date).practice_stp",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L109",
        "StrPatientSeries",
        109
      ],
      [
        "tocilizumab_date",
        "tocilizumab_date",
        "https://github.com/opensafely/tocilizumab_and_sarilumab/blob/20887d4c3da7e6737ef9c12b7c45f786e1dd615c/analysis/dataset_definition.py#L52",
        "DatePatientSeries",
        52
      ]
    ]
  },
  "uom_pregnancy_tx_pathways_166": {
    "analysis/dataset_definition_any_antenatal.py": [
      [
        "PN_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.postnatal_8wk_codes_reviewed)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first, dataset.delivery_code_date_first + days(84))).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L271",
        "boolean",
        271
      ],
      [
        "PN_code_any",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.postnatal_8wk_codes_reviewed)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first, dataset.delivery_code_date_first + days(365))).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L262",
        "boolean",
        262
      ],
      [
        "age",
        "age",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L68",
        "unknown",
        68
      ],
      [
        "age_cat",
        "case(when(age < 20).then('14-19'), when(age < 25).then('20-24'), when(age < 30).then('25-29'), when(age < 35).then('30-34'), when(age < 40).then('35-39'), when(age < 45).then('40-44'), when(age < 50).then('45-49'), otherwise='missing')",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L69",
        "unknown",
        69
      ],
      [
        "age_cat_delivery",
        "case(when(dataset.delivery_code_date_first.is_null()).then('No delivery'), when(age_delivery < 20).then('14-19'), when(age_delivery < 25).then('20-24'), when(age_delivery < 30).then('25-29'), when(age_delivery < 35).then('30-34'), when(age_delivery < 40).then('35-39'), when(age_delivery < 45).then('40-44'), when(age_delivery < 50).then('45-49'), otherwise='missing')",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L100",
        "unknown",
        100
      ],
      [
        "age_delivery",
        "age_delivery",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L99",
        "unknown",
        99
      ],
      [
        "antenatal_code_date_first",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.pregnancy_codes_any)).where(clinical_events.date.is_on_or_between(study_start, study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L29",
        "date",
        29
      ],
      [
        "antenatal_codes_any_total",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.antenatal_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L156",
        "unknown",
        156
      ],
      [
        "antenatal_num_multi",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.multips_date, study_end)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L386",
        "unknown",
        386
      ],
      [
        "antenatal_num_within_first_delivery",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.antenatal_codes)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(270), dataset.delivery_code_date_first)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L289",
        "unknown",
        289
      ],
      [
        "blightedovum_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.blighted_ovum)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L311",
        "unknown",
        311
      ],
      [
        "delivery_code_date_first",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L38",
        "date",
        38
      ],
      [
        "delivery_code_first",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, study_end)).sort_by(clinical_events.date).first_for_patient().snomedct_code",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L166",
        "date",
        166
      ],
      [
        "delivery_code_number",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(30), dataset.delivery_code_date_first + days(84))).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L176",
        "unknown",
        176
      ],
      [
        "ectopic_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.ectopic)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L320",
        "unknown",
        320
      ],
      [
        "edc_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.edc_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L450",
        "unknown",
        450
      ],
      [
        "edd_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.edd_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L442",
        "unknown",
        442
      ],
      [
        "ethnicity6",
        "case(when(ethnicity6 == '1').then('White'), when(ethnicity6 == '2').then('Mixed'), when(ethnicity6 == '3').then('South Asian'), when(ethnicity6 == '4').then('Black'), when(ethnicity6 == '5').then('Other'), when(ethnicity6 == '6').then('Not stated'), otherwise='Unknown')",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L123",
        "unknown",
        123
      ],
      [
        "fifth_delivery_end_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.fifth_delivery_start_date, dataset.fifth_delivery_start_date + days(84))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L244",
        "date",
        244
      ],
      [
        "fifth_delivery_positive_test",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.is_positive).where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(dataset.fifth_delivery_start_date - days(280), dataset.fifth_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L608",
        "boolean",
        608
      ],
      [
        "fifth_delivery_post_vaccine_rollout",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_end_date + days(280), study_end)).where(clinical_events.date.is_on_or_after(vaccine_programme_start)).sort_by(clinical_events.date).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L574",
        "boolean",
        574
      ],
      [
        "fifth_delivery_start_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_end_date + days(182), study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L238",
        "date",
        238
      ],
      [
        "fifth_delivery_vaccine_dose",
        "all_vacc.where(all_vacc.date.is_after(vaccine_programme_start)).where(all_vacc.date.is_on_or_between(dataset.fifth_delivery_start_date - days(280), dataset.fifth_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L534",
        "boolean",
        534
      ],
      [
        "first_delivery_end_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first, dataset.delivery_code_date_first + days(84))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L187",
        "date",
        187
      ],
      [
        "first_delivery_positive_test",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.is_positive).where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(dataset.delivery_code_date_first - days(280), dataset.delivery_code_date_first)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L584",
        "boolean",
        584
      ],
      [
        "first_delivery_post_vaccine_rollout",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, study_end)).where(clinical_events.date.is_on_or_after(vaccine_programme_start)).sort_by(clinical_events.date).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L543",
        "boolean",
        543
      ],
      [
        "first_delivery_vaccine_dose",
        "all_vacc.where(all_vacc.date.is_after(vaccine_programme_start)).where(all_vacc.date.is_on_or_between(dataset.delivery_code_date_first - days(280), dataset.delivery_code_date_first)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L510",
        "boolean",
        510
      ],
      [
        "fourth_delivery_end_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_start_date, dataset.fourth_delivery_start_date + days(84))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L230",
        "date",
        230
      ],
      [
        "fourth_delivery_positive_test",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.is_positive).where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(dataset.fourth_delivery_start_date - days(280), dataset.fourth_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L602",
        "boolean",
        602
      ],
      [
        "fourth_delivery_post_vaccine_rollout",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_end_date + days(280), study_end)).where(clinical_events.date.is_on_or_after(vaccine_programme_start)).sort_by(clinical_events.date).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L566",
        "boolean",
        566
      ],
      [
        "fourth_delivery_start_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_end_date + days(182), study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L224",
        "date",
        224
      ],
      [
        "fourth_delivery_vaccine_dose",
        "all_vacc.where(all_vacc.date.is_after(vaccine_programme_start)).where(all_vacc.date.is_on_or_between(dataset.fourth_delivery_start_date - days(280), dataset.fourth_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L528",
        "boolean",
        528
      ],
      [
        "hbp_all",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_all)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(270), dataset.delivery_code_date_first)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L473",
        "boolean",
        473
      ],
      [
        "hbp_any",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.any_hypertension_code)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(270), dataset.delivery_code_date_first)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L485",
        "boolean",
        485
      ],
      [
        "hbp_pregnancy",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(270), dataset.delivery_code_date_first)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L461",
        "boolean",
        461
      ],
      [
        "imd",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 5))).then('1 - most deprived'), when(imd < int(32844 * 2 / 5)).then('2'), when(imd < int(32844 * 3 / 5)).then('3'), when(imd < int(32844 * 4 / 5)).then('4'), when(imd <= int(32844 * 5 / 5)).then('5 - least deprived'), otherwise='unknown')",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L138",
        "unknown",
        138
      ],
      [
        "lmp_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.lmp_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L434",
        "unknown",
        434
      ],
      [
        "loss_any_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.loss_any_codes)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L356",
        "unknown",
        356
      ],
      [
        "miscarriage_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.miscarriage)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L329",
        "unknown",
        329
      ],
      [
        "molar_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.molar)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L338",
        "unknown",
        338
      ],
      [
        "multips_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L375",
        "date",
        375
      ],
      [
        "multips_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L365",
        "unknown",
        365
      ],
      [
        "num_subsequent_delivery_codes",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date > dataset.delivery_code_date_first + days(182)).date.count_distinct_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L254",
        "date",
        254
      ],
      [
        "outcome_HDP_fifth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.fifth_delivery_start_date - months(6), dataset.fifth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L855",
        "boolean",
        855
      ],
      [
        "outcome_HDP_first_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - months(6), dataset.first_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L806",
        "boolean",
        806
      ],
      [
        "outcome_HDP_fourth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_start_date - months(6), dataset.fourth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L842",
        "boolean",
        842
      ],
      [
        "outcome_HDP_second_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_start_date - months(6), dataset.second_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L818",
        "boolean",
        818
      ],
      [
        "outcome_HDP_third_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.hypertension_codes_preg)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_start_date - months(6), dataset.third_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L830",
        "boolean",
        830
      ],
      [
        "outcome_PE_fifth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.fifth_delivery_start_date - months(6), dataset.fifth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L730",
        "boolean",
        730
      ],
      [
        "outcome_PE_first_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - months(6), dataset.first_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L682",
        "boolean",
        682
      ],
      [
        "outcome_PE_fourth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_start_date - months(6), dataset.fourth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L718",
        "boolean",
        718
      ],
      [
        "outcome_PE_second_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_start_date - months(6), dataset.second_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L694",
        "boolean",
        694
      ],
      [
        "outcome_PE_third_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_start_date - months(6), dataset.third_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L706",
        "boolean",
        706
      ],
      [
        "outcome_multi_fifth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.fifth_delivery_start_date - months(6), dataset.fifth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L792",
        "boolean",
        792
      ],
      [
        "outcome_multi_first_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - months(6), dataset.first_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L743",
        "boolean",
        743
      ],
      [
        "outcome_multi_fourth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_start_date - months(6), dataset.fourth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L779",
        "boolean",
        779
      ],
      [
        "outcome_multi_second_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_start_date - months(6), dataset.second_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L755",
        "boolean",
        755
      ],
      [
        "outcome_multi_third_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.multi_pregnancy)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_start_date - months(6), dataset.third_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L767",
        "boolean",
        767
      ],
      [
        "outcome_stillbirth_fifth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.fifth_delivery_start_date - days(14), dataset.fifth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L668",
        "boolean",
        668
      ],
      [
        "outcome_stillbirth_first_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(14), dataset.first_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L620",
        "boolean",
        620
      ],
      [
        "outcome_stillbirth_fourth_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.fourth_delivery_start_date - days(14), dataset.fourth_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L656",
        "boolean",
        656
      ],
      [
        "outcome_stillbirth_second_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_start_date - days(14), dataset.second_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L632",
        "boolean",
        632
      ],
      [
        "outcome_stillbirth_third_del",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_start_date - days(14), dataset.third_delivery_end_date)).sort_by(clinical_events.date).first_for_patient().exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L644",
        "boolean",
        644
      ],
      [
        "postnatal_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.postnatal_8wk_codes_reviewed)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first - days(84), dataset.delivery_code_date_first)).sort_by(clinical_events.date).first_for_patient().snomedct_code",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L279",
        "date",
        279
      ],
      [
        "postterm_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.postterm_codes)).where(clinical_events.date.is_on_or_between(dataset.delivery_code_date_first, dataset.delivery_code_date_first + days(42))).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L297",
        "unknown",
        297
      ],
      [
        "preeclampsia_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.preeclampsia)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, study_end)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L395",
        "unknown",
        395
      ],
      [
        "pregnancy_codes_any_total",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.pregnancy_codes_any)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L148",
        "unknown",
        148
      ],
      [
        "region",
        "practice_registrations.for_patient_on(dataset.antenatal_code_date_first).practice_nuts1_region_name",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L134",
        "unknown",
        134
      ],
      [
        "second_delivery_end_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_start_date, dataset.second_delivery_start_date + days(84))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L202",
        "date",
        202
      ],
      [
        "second_delivery_positive_test",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.is_positive).where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(dataset.second_delivery_start_date - days(280), dataset.second_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L590",
        "boolean",
        590
      ],
      [
        "second_delivery_post_vaccine_rollout",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.first_delivery_end_date + days(280), study_end)).sort_by(clinical_events.date).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L551",
        "boolean",
        551
      ],
      [
        "second_delivery_start_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.first_delivery_end_date + days(182), study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L196",
        "date",
        196
      ],
      [
        "second_delivery_vaccine_dose",
        "all_vacc.where(all_vacc.date.is_after(vaccine_programme_start)).where(all_vacc.date.is_on_or_between(dataset.second_delivery_start_date - days(280), dataset.second_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L516",
        "boolean",
        516
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L112",
        "unknown",
        112
      ],
      [
        "stillbirth_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.stillbirth_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L347",
        "unknown",
        347
      ],
      [
        "third_delivery_end_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.third_delivery_start_date, dataset.third_delivery_start_date + days(84))).sort_by(clinical_events.date).last_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L216",
        "date",
        216
      ],
      [
        "third_delivery_positive_test",
        "sgss_covid_all_tests.where(sgss_covid_all_tests.is_positive).where(sgss_covid_all_tests.specimen_taken_date.is_on_or_between(dataset.third_delivery_start_date - days(280), dataset.third_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L596",
        "boolean",
        596
      ],
      [
        "third_delivery_post_vaccine_rollout",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_end_date + days(280), study_end)).where(clinical_events.date.is_on_or_after(vaccine_programme_start)).sort_by(clinical_events.date).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L558",
        "boolean",
        558
      ],
      [
        "third_delivery_start_date",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.delivery_codes_reviewed_3)).where(clinical_events.date.is_on_or_between(dataset.second_delivery_end_date + days(182), study_end)).sort_by(clinical_events.date).first_for_patient().date",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L210",
        "date",
        210
      ],
      [
        "third_delivery_vaccine_dose",
        "all_vacc.where(all_vacc.date.is_after(vaccine_programme_start)).where(all_vacc.date.is_on_or_between(dataset.third_delivery_start_date - days(280), dataset.third_delivery_start_date)).exists_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L522",
        "boolean",
        522
      ],
      [
        "top_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.tops)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L406",
        "unknown",
        406
      ],
      [
        "top_probable_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.tops_probable)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L414",
        "unknown",
        414
      ],
      [
        "tops_any_num",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.tops_any_codes)).where(clinical_events.date.is_on_or_between(dataset.antenatal_code_date_first, end_date)).count_for_patient()",
        "https://github.com/opensafely/uom_pregnancy_tx_pathways_166/blob/4d56ec6191304f660ce77a23db0c5c660f5d322a/analysis/dataset_definition_any_antenatal.py#L423",
        "unknown",
        423
      ]
    ]
  },
  "vaccinesWinterPressures": {
    "analysis/dataset_definition.py": [
      [
        "age",
        "patients.age_on(study_start_date)",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L202",
        "IntPatientSeries",
        202
      ],
      [
        "age_band",
        "case(when(age < 4).then('0-4'), when(age < 11).then('5-11'), when(age < 17).then('12-17'), when(age < 29).then('18-29'), when(age < 39).then('30-44'), when(age < 49).then('45-54'), when(age < 59).then('55-64'), when(age < 69).then('65-74'), when(age >= 70).then('70+'), otherwise='missing')",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L210",
        "StrPatientSeries",
        210
      ],
      [
        "cause_of_death",
        "ons_deaths.cause_of_death_01",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L305",
        "CodePatientSeries",
        305
      ],
      [
        "covid_los",
        "diff_dates_hours(dataset.covid_secondary_date, covid_secondary_discharge)",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L190",
        "IntPatientSeries",
        190
      ],
      [
        "covid_primary_date",
        "first_gp_event(codelists_em_jf.covid_primary_codelist).date",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L171",
        "DatePatientSeries",
        171
      ],
      [
        "covid_secondary_date",
        "hospitalisation_primary_secondary_diagnosis_matches(codelists_em_jf.covid_secondary_codelist).admission_date.minimum_for_patient()",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L177",
        "DatePatientSeries",
        177
      ],
      [
        "date_of_death",
        "ons_deaths.date",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L303",
        "DatePatientSeries",
        303
      ],
      [
        "ethnicity_code",
        "clinical_events.where(clinical_events.snomedct_code.is_in(ethnicity_codelist)).where(clinical_events.date.is_on_or_before(study_end_date)).sort_by(clinical_events.date).last_for_patient().snomedct_code",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L320",
        "CodePatientSeries",
        320
      ],
      [
        "ethnicity_group",
        "dataset.ethnicity_code.to_category(ethnicity_codelist)",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L326",
        "StrPatientSeries",
        326
      ],
      [
        "flu_los",
        "diff_dates_hours(dataset.flu_secondary_date, flu_secondary_discharge)",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L159",
        "IntPatientSeries",
        159
      ],
      [
        "flu_primary_date",
        "first_gp_event(codelists_em_jf.flu_primary_codelist).date",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L140",
        "DatePatientSeries",
        140
      ],
      [
        "flu_secondary_date",
        "hospitalisation_primary_secondary_diagnosis_matches(codelists_em_jf.flu_secondary_codelist).admission_date.minimum_for_patient()",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L146",
        "DatePatientSeries",
        146
      ],
      [
        "imd_decile",
        "patient_address.imd_decile",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L237",
        "StrPatientSeries",
        237
      ],
      [
        "imd_quintile",
        "patient_address.imd_quintile",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L236",
        "StrPatientSeries",
        236
      ],
      [
        "imd_rounded",
        "patient_address.imd_rounded",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L235",
        "IntPatientSeries",
        235
      ],
      [
        "msoa_code",
        "patient_address.msoa_code",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L239",
        "StrPatientSeries",
        239
      ],
      [
        "practice",
        "patient_registration.practice_pseudo_id",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L282",
        "IntPatientSeries",
        282
      ],
      [
        "region",
        "patient_registration.practice_nuts1_region_name",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L283",
        "StrPatientSeries",
        283
      ],
      [
        "rsv_los",
        "diff_dates_hours(dataset.rsv_secondary_date, rsv_secondary_discharge)",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L130",
        "IntPatientSeries",
        130
      ],
      [
        "rsv_primary_date",
        "first_gp_event(codelists_em_jf.rsv_primary_codelist).date",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L110",
        "DatePatientSeries",
        110
      ],
      [
        "rsv_secondary_date",
        "hospitalisation_primary_secondary_diagnosis_matches(codelists_em_jf.rsv_secondary_codelist).admission_date.minimum_for_patient()",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L117",
        "DatePatientSeries",
        117
      ],
      [
        "rural_urban",
        "patient_address.rural_urban_classification",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L238",
        "IntPatientSeries",
        238
      ],
      [
        "underlying_cause_of_death",
        "ons_deaths.underlying_cause_of_death",
        "https://github.com/opensafely/vaccinesWinterPressures/blob/724422e282ea640274dc1accb4e2f8936bfb9029/analysis/dataset_definition.py#L304",
        "CodePatientSeries",
        304
      ]
    ]
  },
  "waiting-list": {
    "analysis/dataset_definition_full.py": [
      [
        "age",
        "patients.age_on(dataset.rtt_start_date)",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L67",
        "IntPatientSeries",
        67
      ],
      [
        "count_organisation_id",
        "clockstops.pseudo_organisation_code_patient_pathway_identifier_issuer.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L33",
        "IntPatientSeries",
        33
      ],
      [
        "count_patient_id",
        "clockstops.pseudo_patient_pathway_identifier.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L32",
        "IntPatientSeries",
        32
      ],
      [
        "count_referral_id",
        "clockstops.pseudo_referral_identifier.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L34",
        "IntPatientSeries",
        34
      ],
      [
        "count_rtt_rows",
        "clockstops.count_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L30",
        "IntPatientSeries",
        30
      ],
      [
        "count_rtt_start_date",
        "clockstops.referral_to_treatment_period_start_date.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L31",
        "IntPatientSeries",
        31
      ],
      [
        "end_date",
        "minimum_of(reg_end_date, dod, dataset.rtt_end_date + days(182))",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L62",
        "DatePatientSeries",
        62
      ],
      [
        "rtt_end_date",
        "last_clockstops.referral_to_treatment_period_end_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L48",
        "DatePatientSeries",
        48
      ],
      [
        "rtt_start_date",
        "last_clockstops.referral_to_treatment_period_start_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L47",
        "DatePatientSeries",
        47
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_full.py#L68",
        "StrPatientSeries",
        68
      ]
    ],
    "analysis/dataset_definition_ortho.py": [
      [
        "after_admission",
        "apcs.where(apcs.admission_date.is_on_or_between(dataset.rtt_end_date + days(1), dataset.rtt_end_date + days(15))).exists_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L75",
        "BoolPatientSeries",
        75
      ],
      [
        "age",
        "patients.age_on(dataset.rtt_start_date)",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L233",
        "IntPatientSeries",
        233
      ],
      [
        "age_group",
        "case(when(dataset.age < 40).then('18-39'), when(dataset.age < 50).then('40-49'), when(dataset.age < 60).then('50-59'), when(dataset.age < 70).then('60-69'), when(dataset.age < 80).then('70-79'), when(dataset.age >= 80).then('80+'), otherwise='Missing')",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L234",
        "StrPatientSeries",
        234
      ],
      [
        "any_admission",
        "apcs.where(apcs.admission_date.is_on_or_between(dataset.rtt_end_date - days(15), dataset.rtt_end_date + days(15))).exists_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L63",
        "BoolPatientSeries",
        63
      ],
      [
        "before_admission",
        "apcs.where(apcs.admission_date.is_on_or_between(dataset.rtt_end_date - days(15), dataset.rtt_end_date - days(1))).exists_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L71",
        "BoolPatientSeries",
        71
      ],
      [
        "cancer",
        "clinical_events.where(clinical_events.snomedct_code.is_in(codelists.cancer_codes)).where(clinical_events.date.is_between_but_not_on(dataset.rtt_start_date - years(5), dataset.rtt_start_date)).exists_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L286",
        "BoolPatientSeries",
        286
      ],
      [
        "censor_before_rtt_end",
        "dataset.end_date < dataset.rtt_end_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L125",
        "BoolPatientSeries",
        125
      ],
      [
        "censor_before_study_end",
        "dataset.end_date < dataset.rtt_end_date + days(365)",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L128",
        "BoolPatientSeries",
        128
      ],
      [
        "count_organisation_id",
        "clockstops.pseudo_organisation_code_patient_pathway_identifier_issuer.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L37",
        "IntPatientSeries",
        37
      ],
      [
        "count_patient_id",
        "clockstops.pseudo_patient_pathway_identifier.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L36",
        "IntPatientSeries",
        36
      ],
      [
        "count_referral_id",
        "clockstops.pseudo_referral_identifier.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L38",
        "IntPatientSeries",
        38
      ],
      [
        "count_rtt_rows",
        "clockstops.count_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L34",
        "IntPatientSeries",
        34
      ],
      [
        "count_rtt_start_date",
        "clockstops.referral_to_treatment_period_start_date.count_distinct_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L35",
        "IntPatientSeries",
        35
      ],
      [
        "dod",
        "patients.date_of_death",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L121",
        "DatePatientSeries",
        121
      ],
      [
        "end_date",
        "minimum_of(dataset.reg_end_date, dataset.dod, dataset.rtt_end_date + days(365))",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L122",
        "DatePatientSeries",
        122
      ],
      [
        "ethnicity6",
        "case(when(ethnicity6 == '1').then('White'), when(ethnicity6 == '2').then('Mixed'), when(ethnicity6 == '3').then('South Asian'), when(ethnicity6 == '4').then('Black'), when(ethnicity6 == '5').then('Other'), when(ethnicity6 == '6').then('Not stated'), otherwise='Unknown')",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L270",
        "StrPatientSeries",
        270
      ],
      [
        "first_opioid_date",
        "med_events.where(med_events.dmd_code.is_in(codelists.opioid_codes) & med_events.date.is_on_or_between(dataset.rtt_start_date - days(365), minimum_of(dataset.end_date, dataset.rtt_end_date + days(365)))).sort_by(med_events.date).first_for_patient().date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L222",
        "DatePatientSeries",
        222
      ],
      [
        "imd10",
        "case(when((imd >= 0) & (imd < int(32844 * 1 / 10))).then('1 (most deprived)'), when(imd < int(32844 * 2 / 10)).then('2'), when(imd < int(32844 * 3 / 10)).then('3'), when(imd < int(32844 * 4 / 10)).then('4'), when(imd < int(32844 * 5 / 10)).then('5'), when(imd < int(32844 * 6 / 10)).then('6'), when(imd < int(32844 * 7 / 10)).then('7'), when(imd < int(32844 * 8 / 10)).then('8'), when(imd < int(32844 * 9 / 10)).then('9'), when(imd >= int(32844 * 9 / 10)).then('10 (least deprived)'), otherwise='Unknown')",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L247",
        "StrPatientSeries",
        247
      ],
      [
        "num_weeks",
        "(dataset.rtt_end_date - dataset.rtt_start_date).weeks",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L54",
        "IntPatientSeries",
        54
      ],
      [
        "priority_type",
        "last_clockstops.priority_type_code",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L59",
        "StrPatientSeries",
        59
      ],
      [
        "reg_end_date",
        "registrations.end_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L120",
        "DatePatientSeries",
        120
      ],
      [
        "region",
        "practice_registrations.for_patient_on(dataset.rtt_start_date).practice_nuts1_region_name",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L280",
        "StrPatientSeries",
        280
      ],
      [
        "rtt_end_date",
        "last_clockstops.referral_to_treatment_period_end_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L52",
        "DatePatientSeries",
        52
      ],
      [
        "rtt_start_date",
        "last_clockstops.referral_to_treatment_period_start_date",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L51",
        "DatePatientSeries",
        51
      ],
      [
        "sameday_admission",
        "apcs.where(apcs.admission_date.is_on_or_between(dataset.rtt_end_date, dataset.rtt_end_date)).exists_for_patient()",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L67",
        "BoolPatientSeries",
        67
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L243",
        "StrPatientSeries",
        243
      ],
      [
        "treatment_function",
        "last_clockstops.activity_treatment_function_code",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L57",
        "StrPatientSeries",
        57
      ],
      [
        "wait_time",
        "(dataset.rtt_end_date - dataset.rtt_start_date).days",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L53",
        "IntPatientSeries",
        53
      ],
      [
        "waiting_list_type",
        "last_clockstops.waiting_list_type",
        "https://github.com/opensafely/waiting-list/blob/e06d40fb588c7a66fd51f8953b43f2f423822575/analysis/dataset_definition_ortho.py#L58",
        "StrPatientSeries",
        58
      ]
    ]
  },
  "winter-pressures-phase-II": {
    "analysis/dataset.py": [
      [
        "call_from_gp",
        "count_clinical_consultations('24671000000101', study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L140",
        "unknown",
        140
      ],
      [
        "call_from_patient",
        "count_clinical_consultations('25691000000103', study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L139",
        "unknown",
        139
      ],
      [
        "carehome",
        "addresses.for_patient_on(study_start_date).care_home_is_potential_match",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L85",
        "BoolPatientSeries",
        85
      ],
      [
        "comorbid_asthma",
        "check_resolved_condition(comorbid_dict['asthma'], comorbid_dict['asthma_res'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L116",
        "BoolPatientSeries",
        116
      ],
      [
        "comorbid_chronic_resp",
        "check_chronic_condition(comorbid_dict['chronic_resp'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L122",
        "unknown",
        122
      ],
      [
        "comorbid_copd",
        "check_resolved_condition(comorbid_dict['copd'], comorbid_dict['copd_res'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L115",
        "BoolPatientSeries",
        115
      ],
      [
        "comorbid_depres",
        "check_resolved_condition(comorbid_dict['depres'], comorbid_dict['depres_res'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L119",
        "unknown",
        119
      ],
      [
        "comorbid_dm",
        "check_resolved_condition(comorbid_dict['diabetes'], comorbid_dict['diabetes_res'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L117",
        "BoolPatientSeries",
        117
      ],
      [
        "comorbid_htn",
        "check_resolved_condition(comorbid_dict['htn'], comorbid_dict['htn_res'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L118",
        "BoolPatientSeries",
        118
      ],
      [
        "comorbid_immuno",
        "check_chronic_condition(comorbid_dict['immuno_sup'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L125",
        "unknown",
        125
      ],
      [
        "comorbid_mh",
        "check_chronic_condition(comorbid_dict['mental_health'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L123",
        "unknown",
        123
      ],
      [
        "comorbid_neuro",
        "check_chronic_condition(comorbid_dict['neuro'], study_start_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L124",
        "unknown",
        124
      ],
      [
        "emergency_care",
        "count_emergency_care_attendance(study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L142",
        "unknown",
        142
      ],
      [
        "ethnicity",
        "clinical_events.where(clinical_events.snomedct_code.is_in(ethnicity)).where(clinical_events.date.is_on_or_before(INTERVAL.start_date)).sort_by(clinical_events.date).last_for_patient().snomedct_code.to_category(ethnicity)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L64",
        "StrPatientSeries",
        64
      ],
      [
        "follow_up_app",
        "count_follow_up(study_start_date, seen_appts_in_interval)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L145",
        "unknown",
        145
      ],
      [
        "online_consult",
        "count_clinical_consultations(online_consult, study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L138",
        "unknown",
        138
      ],
      [
        "practice_id",
        "practice_registrations.for_patient_on(study_start_date).practice_pseudo_id",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L97",
        "IntPatientSeries",
        97
      ],
      [
        "region",
        "practice_registrations.for_patient_on(study_start_date).practice_nuts1_region_name",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L99",
        "StrPatientSeries",
        99
      ],
      [
        "rur_urb_class",
        "addresses.for_patient_on(study_start_date).rural_urban_classification",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L92",
        "IntPatientSeries",
        92
      ],
      [
        "secondary_referral",
        "count_secondary_referral(study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L155",
        "unknown",
        155
      ],
      [
        "seen_in_interval",
        "count_seen_in_interval(seen_appts_in_interval)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L134",
        "unknown",
        134
      ],
      [
        "start_in_interval",
        "count_start_in_interval(study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L135",
        "unknown",
        135
      ],
      [
        "tele_consult",
        "count_clinical_consultations('386472008', study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L141",
        "unknown",
        141
      ],
      [
        "vax_app",
        "count_vaccinations(study_start_date, study_end_date)",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L148",
        "unknown",
        148
      ],
      [
        "vax_app_covid",
        "count_vaccinations(study_start_date, study_end_date, ['SARS-2 CORONAVIRUS'])",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L150",
        "unknown",
        150
      ],
      [
        "vax_app_flu",
        "count_vaccinations(study_start_date, study_end_date, ['INFLUENZA'])",
        "https://github.com/opensafely/winter-pressures-phase-II/blob/e44bc03a67477ace5a1a80949491ab9e98e672bc/analysis/dataset.py#L149",
        "unknown",
        149
      ]
    ]
  },
  "winter_pressures_inequalities": {
    "analysis/dataset_definition_covid.py": [
      [
        "age",
        "age_at_start",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L76",
        "IntPatientSeries",
        76
      ],
      [
        "covid_admission_date",
        "minimum_of(dataset.covid_sc_date, dataset.covid_emergency_date)",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L90",
        "DatePatientSeries",
        90
      ],
      [
        "covid_emergency_date",
        "emergency_care_diagnosis_matches(codelists.covid_attendance).where(emergency_care_attendances.arrival_date.is_on_or_between(start_date, start_date + years(1))).arrival_date.minimum_for_patient()",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L85",
        "DatePatientSeries",
        85
      ],
      [
        "covid_sc_date",
        "hospitalisation_primary_secondary_diagnosis_matches(codelists.covid_secondary_codelist).where(hospital_events.admission_date.is_on_or_between(start_date, start_date + years(1))).admission_date.minimum_for_patient()",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L79",
        "DatePatientSeries",
        79
      ],
      [
        "has_covid_admission",
        "dataset.covid_sc_date.is_not_null() | dataset.covid_emergency_date.is_not_null()",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L89",
        "BoolPatientSeries",
        89
      ],
      [
        "sex",
        "patients.sex",
        "https://github.com/opensafely/winter_pressures_inequalities/blob/c47be5faeb51497155191497e11d9dbe9f14cae3/analysis/dataset_definition_covid.py#L75",
        "StrPatientSeries",
        75
      ]
    ]
  },
  "wp3_predicting_pressures": {
    "analysis/dataset_definition.py": [
      [
        "practice_id",
        "practice_id",
        "https://github.com/opensafely/wp3_predicting_pressures/blob/a72c6722c3b40515d4054285d5dfdebb526e2198/analysis/dataset_definition.py#L43",
        "IntPatientSeries",
        43
      ],
      [
        "practice_region",
        "practice_region",
        "https://github.com/opensafely/wp3_predicting_pressures/blob/a72c6722c3b40515d4054285d5dfdebb526e2198/analysis/dataset_definition.py#L46",
        "StrPatientSeries",
        46
      ]
    ]
  }
}
